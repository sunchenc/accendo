<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title> Accendo</title>
        <link href="<?php echo $this->baseUrl ?>/colorselector/lib/bootstrap-3.0.3/css/bootstrap.min.css" rel="stylesheet" />
        <link href="<?php echo $this->baseUrl ?>/colorselector/lib/bootstrap-colorselector-0.2.0/css/bootstrap-colorselector.css" rel="stylesheet" />
        <link rel="stylesheet" type="text/css" href="<?php echo $this->baseUrl ?>/colorselector/css/docs.css" />
        <link rel="stylesheet" type="text/css" href="<?php echo $this->baseUrl ?>/colorselector/css/prettify.css" />
        <link rel="stylesheet" type="text/css" media="screen" href="<?php echo $this->baseUrl ?>/styles/layout.css" />
        <link rel="stylesheet" type="text/css" media="screen" href="<?php echo $this->baseUrl ?>/styles/datepicker.css" />
        <link rel="stylesheet" rev="stylesheet" type="text/css" media="screen, projection" href="<?php echo $this->baseUrl ?>/styles/pagenav.css" />
        <link rel="stylesheet" type="text/css" media="screen" href="<?php echo $this->baseUrl ?>/styles/navigation.css" />
        <link rel="stylesheet" href="<?php echo $this->baseUrl ?>/styles/jquery.megamenu.css" type="text/css" media="screen" />
        
        <!-- color scripts -->
        <script type="text/javascript" language="Javascript" src="<?php echo $this->baseUrl ?>/colorselector/lib/jquery-1.10.2/jquery-1.10.2.min.js"></script>       
        <script type="text/javascript" language="Javascript" src="<?php echo $this->baseUrl ?>/colorselector/lib/bootstrap-3.0.3/js/bootstrap.min.js"></script>
        
        <!-- end of color scripts -->
        <!--
        <script type="text/javascript" language="Javascript" src="<?php echo $this->baseUrl ?>/scripts/jquery.js"></script>
        -->
        <script type="text/javascript" language="Javascript" src="<?php echo $this->baseUrl ?>/scripts/jshelper.js"></script>
        <!--Add drop down for mid section-->
        <!--
        <script src="<?php echo $this->baseUrl ?>/scripts/jquery-1.4.2.min.js" type="text/javascript"></script>
        -->
        <script src="<?php echo $this->baseUrl ?>/scripts/jquery.megamenu.js" type="text/javascript"></script>
        <!--Add drop down for mid section-->
        <script type="text/javascript" language="JavaScript" src="<?php echo $this->baseUrl ?>/scripts/validation.js"></script>

        <script type="text/javascript" language="Javascript" src="<?php echo $this->baseUrl ?>/colorselector/lib/bootstrap-colorselector-0.2.0/js/bootstrap-colorselector.js"></script>
        <script type="text/javascript" language="Javascript" src="<?php echo $this->baseUrl ?>/colorselector/lib/google-code-prettify/prettify.js"></script>
        
         <link rel="stylesheet" type="text/css" media="screen" href="<?php echo $this->baseUrl ?>/styles/jquery-ui.css" />
        <link rel="stylesheet" type="text/css" media="screen" href="<?php echo $this->baseUrl ?>/styles/jquery.multiselect.css" />

        <!--<script type="text/javascript" language="Javascript" src="<?php echo $this->baseUrl ?>/scripts/jquery-1.8.js"></script>-->
        <!--<script type="text/javascript" language="Javascript" src="<?php echo $this->baseUrl ?>/scripts/jquery-ui.min.js"></script>-->
        <script type="text/javascript" language="Javascript" src="<?php echo $this->baseUrl ?>/scripts/jquery-ui.js"></script>
        <script type="text/javascript" language="Javascript" src="<?php echo $this->baseUrl ?>/scripts/jquery.multiselect.js"></script>
        <script type="text/javascript" language="javascript" >
            var id = 0;
            var id3 = 0;
            var billerId = 0;
            var interactionlogId=0;
            var patientlogId =0;
            var paymentId = 0;
            var paymentIdReal = 0;
            var eobTableLines = 0;
            var role = "<?php echo $this->role ?>";
            //用于控制已被删除的static data 的显示（颜色为浅色，且排列在最后）
            function addHiddenOption(id,value){

		if( $("#"+id+" option[value="+value+"]").css("display") == 'none' ){  
			//alert('aaaaaaa');
			var value = $("#"+id+" option[value="+value+"]").val();
			var text = $("#"+id+" option[value="+value+"]").text();
			$("#"+id+" option[value="+value+"]").remove();
			$("#"+id+" option:last").after("<option style=\"color: lightgrey;\" value="+value+">"+text+"</option>");
		}  
			$("#"+id).val(value);
            }
            $(document).ready(function()
            {
                  $('#patientcor').multiselect();
                /*
                $(function() {
                    window.prettyPrint && prettyPrint();
                    $('#colorselector_1').colorselector();
                });
                */
                
                 $.post("<?php echo $this->baseUrl ?>/biller/claims/timeout/",
                function(data)
                {
                    if(data!='no'&&data!=null) {
                        var a=document.getElementById("relogin");
                        a.click(); 
                    }
                }
            );
                
                //                add by Pandazhao 
//                if the role is guset, the user can only read;
//                 var role = "<?php echo $this->role ?>";
                if(role=='guest'){
                    var inputList = document.getElementsByTagName("input");
//                    var selectList = document.getElementsByTagName("select");
//                    var textList = document.getElementsByTagName("textarea");
//                    for(var i=0;i<textList.length;i++){
//                        textList[i].disabled = "true";
//                    }
                    for(var i = 0;i<inputList.length;i++){
//                        if(inputList[i].type=='checkbox'||inputList[i].type=='radio'||inputList[i].type=='button')
//                            inputList[i].disabled="true";
                        if(inputList[i].type=='submit'&&(inputList[i].value=='Finish Claim'||inputList[i].value=='Save Claim')){
                            inputList[i].disabled="true";
                            inputList[i].style.background="url(<?php echo $this->baseUrl ?>/images/tab_bg_2.png)";
                        } 
                        
                    }
//                    for(var i = 0;i<selectList.length;i++){
//                        selectList[i].disabled="true";
//                    }
                }
                
                $('#claim_status').val('');
                
                var document_dir_avaiable=( "<?php echo $this->document_dir_avaiable ?>"==1);
                if(document_dir_avaiable)
                    $("#upload").removeAttr("disabled");
                else
                    $("#upload").attr("disabled","disabled");
                var newclaimflag=( "<?php echo $this->new_claim_flag ?>"==1);
                
                if(newclaimflag){
                    $("#saveclaim").attr("disabled",true);
                    $("#saveclaim").css("background","url('<?php echo $this->baseUrl ?>/images/tab_bg_3.png')");
                }
                else{
                    
                    $("#saveclaim").removeAttr("disabled");
//                    $("#total_charge").attr("disabled",true);
//                    $("#amount_paid").attr("disabled",true);
//                    $("#balance_due").attr("disabled",true);
//                     $("#expected_payment").attr("disabled",true);
                     
                    $("#total_charge").attr("readonly","readonly");
                    $("#amount_paid").attr("readonly","readonly");
                     $("#balance_due").attr("readonly","readonly");
                      $("#expected_payment").attr("readonly","readonly");
                                        
                    var textObjtotal_charge= document.getElementById("total_charge") ;
                    textObjtotal_charge.style.background="#EBEBEB";
                    
                    var amount_paid= document.getElementById("amount_paid") ;
                    amount_paid.style.background="#EBEBEB";
                    
                    var balance_due= document.getElementById("balance_due") ;
                    balance_due.style.background="#EBEBEB";
                    
                    var expected_payment= document.getElementById("expected_payment") ;
                    expected_payment.style.background="#EBEBEB";
                        
                }
                /*
                var th_title_custom_data = document.getElementById("th_title_custom_data");       
                th_title_custom_data.style.display = "";
                 */
               // alert("1 claiminput...");                
                $.get("<?php echo $this->baseUrl ?>/biller/claims/claiminput/",
                function(data)
                {
                   //alert("2 claiminput...");   
                    var myjson='';
                    eval("myjson=" + data + ";");
                    $("#id").val(myjson.id);
                      if(myjson.first_claim_flag == 1)
                    {
                        if(myjson.alert_patient_alert_info!= null && myjson.alert_patient_alert_info != "")
                        {
                            alert(myjson.alert_patient_name +":  "+myjson.alert_patient_alert_info);
                        }
                    }
                    //alert('myjson.insurance_name = ' + myjson.insurance_name);
                    if(myjson.insurance_name != null && myjson.insurance_name != '')
                        $("#insurance_name").val(myjson.insurance_name);
                    if(myjson.payer_type != null && myjson.payer_type != '')
                        $("#payer_type").val(myjson.payer_type);
                                        
                    if(myjson.logs_together != null &&　myjson.logs_together != '' ){
                        var m=0;
                        var n =0;
                        for(var i = 0;i<myjson.logs_together.length;i++){ 
                            if(myjson.logs_together[i]['type']=='patient'){
                                addtable6();
                              
                                var patient_date_and_time = myjson. logs_together[i].date_and_time;
                                var patient_date_and_time_show = patient_date_and_time.toString().slice(0,-3);
                                $("#patient_date_and_time_"+(m+1)+"").val(patient_date_and_time_show);
                                $("#patient_date_and_time_real_"+(m+1)+"").val(myjson. logs_together[i].date_and_time);
                                $("#patient_log_"+(m+1)+"").val(myjson. logs_together[i].log);
                                
                                $("#patient_date_and_time_"+(m+1)+"").attr('readonly','readonly');
                                var patient_date_and_time= document.getElementById("patient_date_and_time_"+(m+1)+"") ;
                                patient_date_and_time.style.background="#AAAAAA";
                                $("#patient_date_and_time_real_"+(m+1)+"").attr('readonly','readonly');
                                var patient_date_and_time_real= document.getElementById("patient_date_and_time_real_"+(m+1)+"") ;
                                patient_date_and_time_real.style.background="#AAAAAA";
                                $("#patient_log_"+(m+1)+"").attr('readonly','readonly');
                                var patient_log= document.getElementById("patient_log_"+(m+1)+"") ;
                                patient_log.style.background="#AAAAAA";   
                                
                                m++;
                            }else{
                                addtable5();
                                var date_and_time = myjson. logs_together[i].date_and_time;
                                var date_and_time_show = date_and_time.toString().slice(0,-3);
                                $("#date_and_time_"+(n+1)+"").val(date_and_time_show);
                                $("#date_and_time_real_"+(n+1)+"").val(myjson. logs_together[i].date_and_time);
                                $("#log_"+(n+1)+"").val(myjson. logs_together[i].log);
                                if(myjson.logs_together[i]['notsave']!=1&&!newclaimflag){
                                $("#date_and_time_"+(n+1)+"").attr('readonly','readonly');
                                var date_and_time= document.getElementById("date_and_time_"+(n+1)+"") ;
                                date_and_time.style.background="#EBEBEB";
                                
                                $("#date_and_time_real_"+(n+1)+"").attr('readonly','readonly');
                                var date_and_time_real= document.getElementById("date_and_time_real_"+(n+1)+"") ;
                                date_and_time_real.style.background="#EBEBEB";
                                
                                 $("#log_"+(n+1)+"").attr('readonly','readonly');
                                var log= document.getElementById("log_"+(n+1)+"") ;
                                log.style.background="#EBEBEB";
                                }
                                if(role=='guest'){
                                    $("#date_and_time_"+(n+1)+"").attr('disabled','disabled');
                                    $("#log_"+(n+1)+"").attr('disabled','disabled');
                                }
                                n++;
                            }
                        }
                    }else{
                        addtable5();
                        if(role=='guest'){
                                $("#date_and_time_1").attr('disabled','disabled');
                                $("#log_1").attr('disabled','disabled');
                            }
                    }                    
                    
                    if(myjson.assigned_user_id!=null){
                        $("#assigned_user_id").val(myjson.assigned_user_id);
                        var elem = document.getElementById("assigned_user_id");
                        var value = elem.options[elem.selectedIndex].text;
                        $("#last_assigned_user_id").val(value);
                    }
                    if(myjson.amount_paid!=null){
                        $("#amount_paid").val(myjson.amount_paid);
                        $("#amount_paid_bk").val(myjson.amount_paid);
                        $("#last_amount_paid").val(myjson.amount_paid);
                    }
                    if(myjson.total_charge!=null){
                        $("#total_charge").val(myjson.total_charge);
                        $("#last_total_charge").val(myjson.total_charge);
                    }
                    if(myjson.balance_due!=null){
                        $("#balance_due").val(myjson.balance_due);
                        $("#balance_due_bk").val(myjson.balance_due);
                        $("#last_balance_due").val(myjson.balance_due);
                    }
                    if(myjson.expected_payment!=null){
                        $("#expected_payment").val(myjson.expected_payment);
                        $("#last_expected_payment").val(myjson.expected_payment);
                    }
                    if(myjson.date_billed!=null){
                        $("#date_billed").val(myjson.date_billed);
                        $("#last_date_billed").val(myjson.date_billed);
                    }
                    if(myjson.date_last_billed!=null){
                        $("#date_last_billed").val(myjson.date_last_billed);
                        $("#last_date_last_billed").val(myjson.date_last_billed);
                    }
                    /**********Date secondary billed By<Yu Lang>**************/
                    if(myjson.date_secondary_insurance_billed!=null){
                        $("#date_secondary_insurance_billed").val(myjson.date_secondary_insurance_billed);
                        $("#last_date_secondary_insurance_billed").val(myjson.date_secondary_insurance_billed);
                    }
                    if(myjson.date_closed!=null){
                        $("#date_closed").val(myjson.date_closed);
                        $("#last_date_closed").val(myjson.date_closed);
                    }
                    if(myjson.date_creation!=null){
                        $("#date_creation").val(myjson.date_creation);
                        $("#last_date_creation").val(myjson.date_creation);
                    }
                    if(myjson.amount_insurance_payment_issued!=null){
                        $("#amount_insurance_payment_issued").val(myjson.amount_insurance_payment_issued);
                        $("#last_amount_insurance_payment_issued").val(myjson.amount_insurance_payment_issued);
                    }
                    if(myjson.amount_insurance_payment_received!=null)
                        $("#amount_insurance_payment_received").val(myjson.amount_insurance_payment_received);
                    if(myjson.date_insurance_payment_issued!=null){
                        $("#date_insurance_payment_issued").val(myjson.date_insurance_payment_issued);
                        $("#last_date_insurance_payment_issued").val(myjson.date_insurance_payment_issued);
                    }
                    if(myjson.date_insurance_payment_received!=null)
                        $("#date_insurance_payment_received").val(myjson.date_insurance_payment_received);
                    if(myjson.EOB_co_insurance!=null){
                        $("#EOB_co_insurance").val(myjson.EOB_co_insurance);
                        $("#last_EOB_co_insurance").val(myjson.EOB_co_insurance);
                    }
                    
                    if(myjson.EOB_deductable!=null){
                        $("#EOB_deductable").val(myjson.EOB_deductable);
                        $("#last_EOB_deductable").val(myjson.EOB_deductable);
                    }
                                        
                    /*<!------------------Add Reduction prompt  By <Yu Lang>--------------------->*/
                    if(myjson.EOB_reduction!=null)
                    {       
                        $("#EOB_reduction").val(myjson.EOB_reduction);
                        $("#last_EOB_reduction").val(myjson.EOB_reduction);
                    }
                    if(myjson.EOB_other_reduction!=null)
                    {
                        $("#EOB_other_reduction").val(myjson.EOB_other_reduction);
                        $("#last_EOB_other_reduction").val(myjson.EOB_other_reduction);
                    }
                    
                    if(myjson.exclude_deductible!= null){
                        $("#exclude_deductible").val(myjson.exclude_deductible);                        
                    }                    
                    
                    if(myjson.exclude_coinsurance!= null){
                        
                        $("#exclude_coinsurance").val(myjson.exclude_coinsurance);                        
                    }                    
                    
                    if(myjson.exclude_reduction!= null)
                    {       
                        $("#exclude_reduction").val(myjson.exclude_reduction);                        
                    }
                    
                    if(myjson.exclude_otherreduction!=null)
                    {
                        $("#exclude_otherreduction").val(myjson.exclude_otherreduction);                        
                    }
                    
                    /*<!------------------Add Reduction prompt  By <Yu Lang>--------------------->*/
                   
                    if(myjson.EOB_allowed_amount!=null){
                        $("#EOB_allowed_amount").val(myjson.EOB_allowed_amount);
                        $("#last_EOB_allowed_amount").val(myjson.EOB_allowed_amount);
                    }
                    if(myjson.EOB_not_allowed_amount!=null){
                        $("#EOB_not_allowed_amount").val(myjson.EOB_not_allowed_amount);
                        $("#last_EOB_not_allowed_amount").val(myjson.EOB_not_allowed_amount);
                    }
                    if(myjson.EOB_adjustment_reason!=null){
                        $("#EOB_adjustment_reason").val(myjson.EOB_adjustment_reason);
                        $("#last_EOB_adjustment_reason").val(myjson.EOB_adjustment_reason);
                    }
                    if(myjson.benefit_OOP!=null){
                        $("#benefit_OOP").val(myjson.benefit_OOP);
                        $("#last_benefit_OOP").val(myjson.benefit_OOP);
                    }
                    if(myjson.benefit_deductible!=null){
                        $("#benefit_deductible").val(myjson.benefit_deductible);
                        $("#last_benefit_deductible").val(myjson.benefit_deductible);
                    }
                    if(myjson.benefit_OOP_remaining!=null){
                        $("#benefit_OOP_remaining").val(myjson.benefit_OOP_remaining);
                        $("#last_benefit_OOP_remaining").val(myjson.benefit_OOP_remaining);
                    }
                    if(myjson.benefit_co_insurance!=null){
                        $("#benefit_co_insurance").val(myjson.benefit_co_insurance);
                        $("#last_benefit_co_insurance").val(myjson.benefit_co_insurance);
                    }
                    if(myjson.benefit_date_taken!=null){
                        $("#benefit_date_taken").val(myjson.benefit_date_taken);
                        $("#last_benefit_date_taken").val(myjson.benefit_date_taken);
                    }
                    if(myjson.amount_initial_offer!=null){
                        $("#amount_initial_offer").val(myjson.amount_initial_offer);
                        $("#last_amount_initial_offer").val(myjson.amount_initial_offer);
                    }
                    if(myjson.date_initial_offer!=null){
                        $("#date_initial_offer").val(myjson.date_initial_offer);
                        $("#last_date_initial_offer").val(myjson.date_initial_offer);
                    }
                    
                    if(myjson.claim_status!=null){
                        //$("#claim_status").val(myjson.claim_status);
                        // $("#facility_id").val(myjson.facility_id);
                        addHiddenOption('claim_status',myjson.claim_status);
                        $("#last_status").val(myjson.claim_status);
                    }
                    if(myjson.statement_status!=null){
                        //$("#statement_status").val(myjson.statement_status);
                        addHiddenOption('statement_status',myjson.statement_status);
                        $("#last_statement_status").val(myjson.statement_status);
                        //alert('0- #last_statement_status = ' + $("#last_statement_status").val());
                    }
                    if(myjson.bill_status!=null){
                        //$("#bill_status").val(myjson.bill_status);
                        addHiddenOption('bill_status',myjson.bill_status);
                        $("#last_bill_status").val(myjson.bill_status);
                    }
                      //pc part
                       if(myjson.patientcorrespondence!=null){
//                           alert('aaaaaaa');
//                        alert(myjson.patientcorrespondence);
                        $("#patientcor").val(myjson.patientcorrespondence);
                        $("#patientcor").multiselect("refresh");
                    }
                    if(myjson.color_code!=null){
                        //alert('color get is ' + myjson.color_code);
                        $("#colorselector_1").val(myjson.color_code);
                        //$('#colorselector_1').colorselector();
                        $("#last_colorselector_1").val(myjson.colorselector_1);
                        //alert('color set to ' + $("#colorselector_1").val());
                    }
                    if(myjson.followup_id!=null)
                        $("#followup_id").val(myjson.followup_id);
//                    var temp = 8;
//                    if(myjson.date_and_time_8!=null&&myjson.date_and_time_8!=''){
//                        $("#date_and_time_"+temp.toString()).val(myjson.date_and_time_8);
//                        $("#hidden_date_and_time_"+temp.toString()).val(myjson.hidden_date_and_time_8);
//                    }
//                    if(myjson.log_8!=null&&myjson.log_8!=''){
//                        $("#log_"+temp.toString()).val(myjson.log_8);
//                        temp--;
//                    }
//                    if(myjson.date_and_time_7!=null&&myjson.date_and_time_7!='') {
//                        $("#date_and_time_"+temp.toString()).val(myjson.date_and_time_7);
//                        $("#hidden_date_and_time_"+temp.toString()).val(myjson.hidden_date_and_time_7);
//                    }
//                    if(myjson.log_7!=null&&myjson.log_7!=''){
//                        $("#log_"+temp.toString()).val(myjson.log_7);
//                        temp--;
//                    }
//                    if(myjson.date_and_time_6!=null&&myjson.date_and_time_6!='') {
//                        $("#date_and_time_"+temp.toString()).val(myjson.date_and_time_6);
//                        $("#hidden_date_and_time_"+temp.toString()).val(myjson.hidden_date_and_time_6);
//                    }
//                    if(myjson.log_6!=null&&myjson.log_6!=''){
//                        $("#log_"+temp.toString()).val(myjson.log_6);
//                        temp--;
//                    }
//                    if(myjson.date_and_time_5!=null&&myjson.date_and_time_5!='') {
//                        $("#date_and_time_"+temp.toString()).val(myjson.date_and_time_5);
//                        $("#hidden_date_and_time_"+temp.toString()).val(myjson.hidden_date_and_time_5);
//                    }
//                    if(myjson.log_5!=null&&myjson.log_5!=''){
//                        $("#log_"+temp.toString()).val(myjson.log_5);
//                        temp--;
//                    }
//                    if(myjson.date_and_time_4!=null&&myjson.date_and_time_4!='') {
//                        $("#date_and_time_"+temp.toString()).val(myjson.date_and_time_4);
//                        $("#hidden_date_and_time_"+temp.toString()).val(myjson.hidden_date_and_time_4);
//                    }
//                    if(myjson.log_4!=null&&myjson.log_4!=''){
//                        $("#log_"+temp.toString()).val(myjson.log_4);
//                        temp--;
//                    }
//                    if(myjson.date_and_time_3!=null&&myjson.date_and_time_3!='') {
//                        $("#date_and_time_"+temp.toString()).val(myjson.date_and_time_3);
//                        $("#hidden_date_and_time_"+temp.toString()).val(myjson.hidden_date_and_time_3);
//                    }
//                    if(myjson.log_3!=null&&myjson.log_3!=''){
//                        $("#log_"+temp.toString()).val(myjson.log_3);
//                        temp--;
//                    }
//                    if(myjson.date_and_time_2!=null&&myjson.date_and_time_2!='') {
//                        $("#date_and_time_"+temp.toString()).val(myjson.date_and_time_2);
//                        $("#hidden_date_and_time_"+temp.toString()).val(myjson.hidden_date_and_time_2);
//                }
//                    if(myjson.log_2!=null&&myjson.log_2!=''){
//                        $("#log_"+temp.toString()).val(myjson.log_2);
//                        temp--;
//                    }
//                    if(myjson.date_and_time_1!=null&&myjson.date_and_time_1!='') {
//                        $("#date_and_time_"+temp.toString()).val(myjson.date_and_time_1);
//                        $("#hidden_date_and_time_"+temp.toString()).val(myjson.hidden_date_and_time_1);
//                    }
//                    if(myjson.log_1!=null&&myjson.log_1!=''){
//                        $("#log_"+temp.toString()).val(myjson.log_1);
//                        temp--;
//                    }
                    if(myjson.date_of_next_followup!=null){
                        $("#date_of_next_followup").val(myjson.date_of_next_followup);
                        $("#last_date_of_next_followup").val(myjson.date_of_next_followup);
                    }
                    if(myjson.date_last_checked_with_attorney!=null)
                        $("#date_last_checked_with_attorney").val(myjson.date_last_checked_with_attorney);
                    if(myjson.delivery_date!=null)
                        $("#delivery_date").val(myjson.delivery_date);
                    if(myjson.notes!=null)
                        $("#notes").val(myjson.notes);
                    //                    if(myjson.who_number_and_ref_number_1!=null)
                    //                        $("#who_number_and_ref_number_1").val(myjson.who_number_and_ref_number_1);
                    //                    if(myjson.who_number_and_ref_number_2!=null)
                    //                        $("#who_number_and_ref_number_2").val(myjson.who_number_and_ref_number_2);
                    //                    if(myjson.who_number_and_ref_number_3!=null)
                    //                        $("#who_number_and_ref_number_3").val(myjson.who_number_and_ref_number_3);
                    //                    if(myjson.who_number_and_ref_number_4!=null)
                    //                        $("#who_number_and_ref_number_4").val(myjson.who_number_and_ref_number_4);
                    //                    if(myjson.who_number_and_ref_number_5!=null)
                    //                        $("#who_number_and_ref_number_5").val(myjson.who_number_and_ref_number_5);
                    //                    if(myjson.who_number_and_ref_number_6!=null)
                    //                        $("#who_number_and_ref_number_6").val(myjson.who_number_and_ref_number_6);
                    //                    if(myjson.who_number_and_ref_number_7!=null)
                    //                        $("#who_number_and_ref_number_7").val(myjson.who_number_and_ref_number_7);
                    //                    if(myjson.who_number_and_ref_number_8!=null)
                    //                        $("#who_number_and_ref_number_8").val(myjson.who_number_and_ref_number_8);
                    if(myjson.negotiated_payment_amount!=null){
                        $("#negotiated_payment_amount").val(myjson.negotiated_payment_amount);
                        $("#last_negotiated_payment_amount").val(myjson.negotiated_payment_amount);
                    }
                    if(myjson.date_negotiated_amount_reached!=null){
                        $("#date_negotiated_amount_reached").val(myjson.date_negotiated_amount_reached);
                        $("#last_date_negotiated_amount_reached").val(myjson.date_negotiated_amount_reached);
                    }
                    if(myjson.notes_insurance_payment!=null)
                        $("#notes_insurance_payment").val(myjson.notes_insurance_payment);
                    if(myjson.amount_insurance_payment_received_2!=null)
                        $("#amount_insurance_payment_received_2").val(myjson.amount_insurance_payment_received_2);
                    if(myjson.date_insurance_payment_received_2!=null)
                        $("#date_insurance_payment_received_2").val(myjson.date_insurance_payment_received_2);
                    if(myjson.notes_insurance_payment_2!=null)
                        $("#notes_insurance_payment_2").val(myjson.notes_insurance_payment_2);
                    if(myjson.amount_insurance_payment_received_3!=null)
                        $("#amount_insurance_payment_received_3").val(myjson.amount_insurance_payment_received_3);
                    if(myjson.date_insurance_payment_received_3!=null)
                        $("#date_insurance_payment_received_3").val(myjson.date_insurance_payment_received_3);
                    if(myjson.notes_insurance_payment_3!=null)
                        $("#notes_insurance_payment_3").val(myjson.notes_insurance_payment_3);
                    if(myjson.amount_patient_payment_received!=null)
                        $("#amount_patient_payment_received").val(myjson.amount_patient_payment_received);
                    if(myjson.date_patient_payment_received!=null)
                        $("#date_patient_payment_received").val(myjson.date_patient_payment_received);
                    if(myjson.notes_patient_payment!=null)
                        $("#notes_patient_payment").val(myjson.notes_patient_payment);
                    if(myjson.amount_patient_payment_received_2!=null)
                        $("#amount_patient_payment_received_2").val(myjson.amount_patient_payment_received_2);
                    if(myjson.date_patient_payment_received_2!=null)
                        $("#date_patient_payment_received_2").val(myjson.date_patient_payment_received_2);
                    if(myjson.notes_patient_payment_2!=null)
                        $("#notes_patient_payment_2").val(myjson.notes_patient_payment_2);
                    if(myjson.amount_patient_payment_received_3!=null)
                        $("#amount_patient_payment_received_3").val(myjson.amount_patient_payment_received_3);
                    if(myjson.date_patient_payment_received_3!=null)
                        $("#date_patient_payment_received_3").val(myjson.date_patient_payment_received_3);
                    if(myjson.notes_patient_payment_3!=null)
                        $("#notes_patient_payment_3").val(myjson.notes_patient_payment_3);
                    if(myjson.amount_biller_adjustment!=null)
                        $("#amount_biller_adjustment").val(myjson.amount_biller_adjustment);
                    if(myjson.date_biller_adjustment!=null)
                        $("#date_biller_adjustment").val(myjson.date_biller_adjustment);
                    if(myjson.notes_biller_adjustment!=null)
                        $("#notes_biller_adjustment").val(myjson.notes_biller_adjustment);
                    if(myjson.amount_biller_adjustment_2!=null)
                        $("#amount_biller_adjustment_2").val(myjson.amount_biller_adjustment_2);
                    if(myjson.date_biller_adjustment_2!=null)
                        $("#date_biller_adjustment_2").val(myjson.date_biller_adjustment_2);
                    if(myjson.notes_biller_adjustment_2!=null)
                        $("#notes_biller_adjustment_2").val(myjson.notes_biller_adjustment_2);
                    if(myjson.amount_biller_adjustment_3!=null)
                        $("#amount_biller_adjustment_3").val(myjson.amount_biller_adjustment_3);
                    if(myjson.date_biller_adjustment_3!=null)
                        $("#date_biller_adjustment_3").val(myjson.date_biller_adjustment_3);
                    if(myjson.notes_biller_adjustment_3!=null)
                        $("#notes_biller_adjustment_3").val(myjson.notes_biller_adjustment_3);
                    if(myjson.mannual_flag==0){
                        //set bill status and statement status readonly
                        //$("#statement_status").attr("disabled","true");
                        var statement_status = document.getElementById("statement_status");
                        var parent = statement_status.parentNode;
                        var newInput = document.createElement("input");
                        newInput.value = $("#statement_status").find("option:selected").text();
                        newInput.readOnly = true;
                        newInput.style.backgroundColor = "#cccccc";
                        parent.appendChild(newInput);
                        $("#statement_status").css("display","none");
                        //$("#bill_status").attr("disabled","true");
                        var statement_status = document.getElementById("bill_status");
                        var parent = bill_status.parentNode;
                        var newInput = document.createElement("input");
                        newInput.value = $("#bill_status").find("option:selected").text();
                        newInput.readOnly = true;
                        newInput.style.backgroundColor = "#cccccc";
                        parent.appendChild(newInput);
                        $("#bill_status").css("display","none");
                    }
                    /************************Add 4 custom field By Yu Lang**************************/
                    if(myjson.payments !=null){
                        var payments_count = myjson.payments.length;
                        if(payments_count == 0){
                            addtable7("total","new");
                         
                        }
                        //alert(payments_count);
                        for(var i=0;i < payments_count;i++){
                            
                            addtable7(myjson.payments[i]['type'],"old");
                            if(myjson.payments[i]['type']=="EOB"){
                                var eob_count = $("#service_count").val();
                                //alert(eob_count);
                                for(var eob_i = 1; eob_i <= eob_count ; eob_i++){
                                    $("#service_"+(i+1)+"_"+eob_i+"_payment").val(myjson.payments[i]['services'][eob_i-1]["amount"]);
                                    $("#service_"+(i+1)+"_"+eob_i+"_payment_id").val(myjson.payments[i]['services'][eob_i-1]["service_payment_id"]);
                                   //console.log(myjson.payments[i]['services'][eob_i-1]);
                                }
                            }
                           // alert(i+1);
                            var from_number="<?php echo $this->invalid?>";
                            if(from_number)
                            {
                              
                               var from = "#payment_"+from_number;
                               $(from).css("border","4px solid red");
                            }
                            var amount = "#payment_amount_" + (i + 1);
                            var datetime = "#payment_date_and_time_" + (i  + 1);
                            var from = "#payment_from_" + (i  + 1);
                            var notes = "#payment_notes_" + (i + 1);
                            var internal_notes = "#payment_internal_notes_" + (i + 1); 
                            var positive = "#payment_amount_positive_" + (i+1);
                            var amount_value = parseFloat(myjson.payments[i]['amount']);
                            //alert((i+1)+" : "+amount_value);
                            if(amount_value>0){
                                $(amount).val(myjson.payments[i]['amount']);
                                $(positive).val("positive");
                            }else{
                                //$(amount).val(myjson.payments[i]['amount'].substring(1));
                                //alert(amount_value);
                                value = -amount_value;
                                value = Math.abs(value).toString();
                                if(value.search(/\./)!=-1){}else{value = value +".00";}
                                //alert(value);
                                $(amount).val(value);
                                $(positive).val("negative");
                                $(amount).css("color","red");
                            }
                            //$(amount).val(myjson.payments[i]['amount']);
                            $(datetime).val(myjson.payments[i]['datetime']);
                            $(notes).val(myjson.payments[i]['notes']);
                            $(internal_notes).val(myjson.payments[i]['internal_notes']);
                            if(myjson.payments[i]['from']!=''){
                                var from_id = "payment_from_" + (i  + 1);
                                elem=document.getElementById(from_id);
                                var length = elem.length;
                                //alert(length);
                                var flag_exsit = 0;
                                for(var j=0;j< length;j++){
                                    if(myjson.payments[i]['from'] == elem.options[j].text)
                                    {
                                        flag_exsit = 1;
                                        break;
                                    }
                                }
                                //alert(flag_exsit);
                                if(flag_exsit == 1){
                                    $(from).val(myjson.payments[i]['from']);
                                }else{
                                    $(from).val("Misc");
                                    $(from).css("display","none");
                                    var self_id = "#payment_from_self_" + (i + 1);
                                    $(self_id).css("display","");
                                    $(self_id).val(myjson.payments[i]['from']);
                                }
                            }
                        }
                    }
                    var custom_field_flag = false;
           
                    if(myjson.custom_label_1_flag != "1"){
                        if(myjson.custom_label_1!="" && myjson.custom_label_1 != null)
                        {
                            var th_custom_label_1 = document.getElementById("th_custom_label_1");       
                            th_custom_label_1.style.display = "";

                            var custom_label_1 = document.getElementById("custom_label_1");       
                            custom_label_1.innerHTML = myjson.custom_label_1;

                            var custom_1_input = document.getElementById("custom_1_input");       
                            custom_1_input.style.display ="";

                            $("#custom_1_input").val(myjson.custom_1);
//                            $("#custom_1").val(myjson.custom_1);
//                            $("last_custom_label_1").val();
                            $("last_custom_1").val(myjson.custom_1);
                            custom_field_flag = true;
                            set_custom_value_input('1');
                            $("#custom_1").val(myjson.custom_1);                            
                        }
                    }else if(myjson.custom_label_1_flag == "1"){
                        var th_custom_label_1 = document.getElementById("th_custom_label_1");       
                        th_custom_label_1.style.display = "";

                        var custom_label_1 = document.getElementById("custom_label_1");       
                        custom_label_1.innerHTML = myjson.custom_label_1_name;
                        
                        var custom_1_select = document.getElementById("custom_1_select");       
                        custom_1_select.style.display ="";
                        
                         for(var i=0;i<myjson.custom_1_List.length;i++){
                                $("#custom_1_select").append("<option value='"+
                                    myjson.custom_1_List[i]['value']+
                                    "'>"+myjson.custom_1_List[i]['value'] +
                                    "</option>");
                            }
                        $("#custom_1_select").val(myjson.custom_1);
//                        $("#custom_1").val(myjson.custom_1);
//                        $("last_custom_label_1").val();
                        $("last_custom_1").val(myjson.custom_1);
                        custom_field_flag = true;
                        $("#custom_1").val(myjson.custom_1);                           
                    }
                    if(myjson.custom_label_2_flag != "1"){
                        if(myjson.custom_label_2!="" && myjson.custom_label_2 != null)
                        {
                            var th_custom_label_2 = document.getElementById("th_custom_label_2");       
                            th_custom_label_2.style.display = "";

                            var custom_label_2 = document.getElementById("custom_label_2");       
                            custom_label_2.innerHTML = myjson.custom_label_2;

                            var custom_2_input = document.getElementById("custom_2_input");       
                            custom_2_input.style.display ="";
                            $("#custom_2_input").val(myjson.custom_2);
//                            $("#custom_2").val(myjson.custom_2); // 对隐藏域进行赋值
//                            $("last_custom_label_2").val();
                            $("last_custom_2").val(myjson.custom_2);
                            custom_field_flag = true;
                            $("#custom_2").val(myjson.custom_2);                            
}
                    }else if(myjson.custom_label_2_flag == "1"){
                        var th_custom_label_2 = document.getElementById("th_custom_label_2");       
                        th_custom_label_2.style.display = "";

                        var custom_label_2 = document.getElementById("custom_label_2");       
                        custom_label_2.innerHTML = myjson.custom_label_2_name;
                        
                        var custom_2_select = document.getElementById("custom_2_select");       
                        custom_2_select.style.display ="";
                        
                         for(var i=0;i<myjson.custom_2_List.length;i++){
                                $("#custom_2_select").append("<option value='"+
                                    myjson.custom_2_List[i]['value']+
                                    "'>"+myjson.custom_2_List[i]['value'] +
                                    "</option>");
                            }
                        $("#custom_2_select").val(myjson.custom_2);
//                        $("#custom_2").val(myjson.custom_2);
//                        $("last_custom_label_2").val();
                        $("last_custom_2").val(myjson.custom_2);
                        custom_field_flag = true;
                        $("#custom_2").val(myjson.custom_2);                            
                    }
                    if(myjson.custom_label_3_flag != "1"){
                        if(myjson.custom_label_3!="" && myjson.custom_label_3 != null)
                        {
                            var th_custom_label_3 = document.getElementById("th_custom_label_3");       
                            th_custom_label_3.style.display = "";

                            var custom_label_3 = document.getElementById("custom_label_3");       
                            custom_label_3.innerHTML = myjson.custom_label_3;

                            var custom_3_input = document.getElementById("custom_3_input");       
                            custom_3_input.style.display ="";

                            $("#custom_3_input").val(myjson.custom_3);
//                            $("#custom_3").val(myjson.custom_3);
//                            $("last_custom_label_3").val();
                            $("last_custom_3").val(myjson.custom_3);
                            custom_field_flag = true;
                            $("#custom_3").val(myjson.custom_3);                            
                        }
                    }else if(myjson.custom_label_3_flag == "1"){
                        var th_custom_label_3 = document.getElementById("th_custom_label_3");       
                        th_custom_label_3.style.display = "";

                        var custom_label_3 = document.getElementById("custom_label_3");       
                        custom_label_3.innerHTML = myjson.custom_label_3_name;
                        
                        var custom_3_select = document.getElementById("custom_3_select");       
                        custom_3_select.style.display ="";
                        
                         for(var i=0;i<myjson.custom_3_List.length;i++){
                                $("#custom_3_select").append("<option value='"+
                                    myjson.custom_3_List[i]['value']+
                                    "'>"+myjson.custom_3_List[i]['value'] +
                                    "</option>");
                            }
                        $("#custom_3_select").val(myjson.custom_3);
//                        $("#custom_3").val(myjson.custom_3);
//                        $("last_custom_label_3").val();
                        $("last_custom_3").val(myjson.custom_3);
                        custom_field_flag = true;
                        $("#custom_3").val(myjson.custom_3);                            
                    }
                    if(myjson.custom_label_4_flag != "1"){
                        if(myjson.custom_label_4!="" && myjson.custom_label_4 != null)
                        {
                            var th_custom_label_4 = document.getElementById("th_custom_label_4");       
                            th_custom_label_4.style.display = "";

                            var custom_label_4 = document.getElementById("custom_label_4");       
                            custom_label_4.innerHTML = myjson.custom_label_4;

                            var custom_4_input = document.getElementById("custom_4_input");       
                            custom_4_input.style.display ="";

                            $("#custom_4_input").val(myjson.custom_4);
//                            $("#custom_4").val(myjson.custom_4);
//                            $("last_custom_label_4").val();
                            $("last_custom_4").val(myjson.custom_4);
                            custom_field_flag = true;
                            $("#custom_4").val(myjson.custom_4);                            
                        }
                    }else if(myjson.custom_label_4_flag == "1"){
                        var th_custom_label_4 = document.getElementById("th_custom_label_4");       
                        th_custom_label_4.style.display = "";

                        var custom_label_4 = document.getElementById("custom_label_4");       
                        custom_label_4.innerHTML = myjson.custom_label_4_name;
                        
                        var custom_4_select = document.getElementById("custom_4_select");       
                        custom_4_select.style.display ="";
                        
                         for(var i=0;i<myjson.custom_4_List.length;i++){
                                $("#custom_4_select").append("<option value='"+
                                    myjson.custom_4_List[i]['value']+
                                    "'>"+myjson.custom_4_List[i]['value'] +
                                    "</option>");
                            }
                        $("#custom_4_select").val(myjson.custom_4);
//                        $("#custom_4").val(myjson.custom_4);
//                        $("last_custom_label_4").val();
                        $("last_custom_4").val(myjson.custom_4);
                        custom_field_flag = true;
                        $("#custom_4").val(myjson.custom_4);                            
                    }
                    if(custom_field_flag)
                    {                   
                        var th_title_custom_data = document.getElementById("th_title_custom_data");       
                        th_title_custom_data.style.display = "";
                        
                        //var bottom_custom_data = document.getElementById("bottom_custom_data");       
                        //bottom_custom_data.style.display = "";
                    }
                    if(myjson.needsave==1){
                    
                       document.getElementById('ischanged').style.display="";
                    }else{
                       document.getElementById('ischanged').style.display="none";
                    }
                    /************************Add 4 custom field By Yu Lang**************************/
                    
                    var sentopatient = document.getElementsByName("is_the_issued_payment_sent_to_patient[]")[0];
                    if(myjson.is_the_issued_payment_sent_to_patient=='1')
                        sentopatient.checked=true;
                    else
                        sentopatient.checked=false;
                    if(myjson.guarantor!=null && myjson.guarantor!=""){
                        if(myjson.guarantor=="no"||myjson.guarantor.id=="no"){
                            $("#g_tr_1").css("display","none");
                            $("#g_tr_2").css("display","none");
                            $("#g_tr_3").css("display","none");
                        }else{
                            var guarantor = myjson.guarantor;
                            $("#g_tr_1").css("display","");
                            $("#g_tr_2").css("display","");
                            $("#g_tr_3").css("display","");
                            $("#guarantor").val(guarantor.id);
                            $("#g_last_name").val(guarantor.last_name);
                            $("#g_first_name").val(guarantor.first_name);
                            $("#g_dob").val(guarantor.DOB);
                            $("#g_sex").val(guarantor.sex);
                            $("#g_street_address").val(guarantor.street_address);
                            $("#g_zip").val(guarantor.zip);
                            $("#g_city").val(guarantor.city);
                            $("#g_state").val(guarantor.state);
                            $("#g_phone_number").val(guarantor.phone_number);
                            $("#g_second_phone_number").val(guarantor.second_phone_number);
                            $("#g_ssn").val(guarantor.SSN);
                            $("#g_relationship_to_patient").val(guarantor.relationship_to_patient);
                            
                        }
                    }
                    var interactionDiv = document.getElementById("interactionDiv");
                    for(var i=8;i>0;i--)
                    {
                      
                        var datename="#date_and_time_"+i.toString();
                        
                        var startdate=$(datename).val();
                        if(startdate!=null&&startdate!="")
                        {
                            
                            if(i==7){
                                interactionDiv.style.height = "50px";
                          
                            }
                            if(i==6){
                       
                                interactionDiv.style.height = "75px";
                            }
                            var tablename="mytable"+i.toString()+'_1';
                            document.getElementById(tablename).style.display="";
                            //                            var tablename="mytable"+i.toString()+'_2';
                            //                            document.getElementById(tablename).style.display="";
                        }
                    }
                  
                    refreshaccessbutton();
                    totalcharge();
                
//                
                });
                
                $.get("<?php echo $this->baseUrl ?>/biller/claims/innetwork/",
                function(data)
                {
                    var myjson='';
                    eval("myjson=" + data + ";");
                    var innetwork = document.getElementsByName("innetwork[]")[0];
                    if(myjson.innetwork=='1')
                        innetwork.checked=true;
                    else
                        innetwork.checked=false;
                });
                
                var document_dir_avaiable=("<?php echo $this->cur_service_info['docbtn_vavaiable'] ?>"==1);
                if(document_dir_avaiable)
                    $("#upload").removeAttr("disabled");
                else
                    $("#upload").attr("disabled","disabled");
                
                $.get("<?php echo $this->baseUrl ?>/biller/claims/claiminput/",
               //  alert("before claiminput...");    
                function(data)
                {
                    refreshaccessbutton();
                    //iseobfileexist();
                });
//                    $.get("<?php echo $this->baseUrl ?>/biller/claims/patientalert/patientid/<?php echo $this->cur_service_info['patient_id']?>",function(data){
//                  
//                   var myjson='';
//                    eval("myjson=" + data + ";");
//                               
//                    if(myjson.first_severe_flag == 1)
//                    {
//                        if(myjson.patient_alert_info!= null && myjson.patient_alert_info != "")
//                        {
//                            alert(myjson.patient_name +":  "+myjson.patient_alert_info);
//                        }
//                    }
//                        
//                });
                 //alert("before claiminput...");   
                if("<?php echo $this->nullcheck ?>")
                {
                    $("#<?php echo $this->nullcheck ?>").css("border","4px solid red");
                    $("#<?php echo $this->nullcheck ?>").focus();
                }
                //window.prettyPrint && prettyPrint();
                $('#colorselector_1').colorselector();
                //alert('default color ' + $('#colorselector_1').val());
            });
        </script>
        
        <script type="text/javascript" language="javascript" >
            function refreshaccessbutton()
            {
                $.get("<?php echo $this->baseUrl ?>/biller/claims/accessbuttonstatus/pageno/4",function(data){
                    var myjson='';
                    eval("myjson=" + data + ";");
                    var td1 = $("#document_access td");
                    if(td1.length>1)
                        document.getElementById("document_access").deleteCell(1);
                    var str='<td colspan="7">';
                    var button_count=0;
                    var fixed_bt_value=new Array('CMS1500','EOB','Payment');
                    var fixed_bt_path=new Array(myjson.CMS1500_path,myjson.EOB_path,myjson.Payment_path);
                    button_count=fixed_bt_value.length;
                    for(var i=0;i<button_count;i++)
                        str=str+mk_buttonadd_str(fixed_bt_path[i],"<?php echo $this->baseUrl ?>",fixed_bt_value[i]);
                    if(myjson.Agreement_path!=null)
                        str=str+mk_buttonadd_str(myjson.Agreement_path,"<?php echo $this->baseUrl ?>",'Agreement');
                    if(myjson.Statement_1_path!=null)
                        str=str+mk_buttonadd_str(myjson.Statement_1_path,"<?php echo $this->baseUrl ?>",'Statement I');
                    if(myjson.Statement_2_path!=null)
                        str=str+mk_buttonadd_str(myjson.Statement_2_path,"<?php echo $this->baseUrl ?>",'Statement II');
                    if(myjson.Statement_3_path!=null)
                        str=str+mk_buttonadd_str(myjson.Statement_3_path,"<?php echo $this->baseUrl ?>",'Statement III');
                    for(var i=0;i<myjson.one_off_paths.length;i++){
                        var filename=myjson.one_off_paths[i];
                        button_count++;
                        str=str+mk_buttonadd_str(filename,"<?php echo $this->baseUrl ?>",'');
                    }
                    str+='</td>';
                    $("#document_access").append(str);
                });
            }

        </script>
        
        <script type="text/javascript" language="javascript" >
            function sendtopatient()
            {
                var sentopatient = document.getElementsByName("is_the_issued_payment_sent_to_patient[]")[0];
                check_change('is_the_issued_payment_sent_to_patient');
                //if(sentopatient.checked==true);
                //$("#claim_status").val('open_payment_issued_not_received');
            }
        </script>
        
        <script type="text/javascript" language="javascript" >
            function paymentissued()
            {
                
                var amountissued=$("#amount_insurance_payment_issued").val();
                if(amountissued.length>0)
                {
                      /*Fix the date format*/
                    var month,day,year;
                    var myDate = new Date();
                    if( myDate.getMonth() + 1 < 10)
                        month = '0'+(myDate.getMonth()+1);
                    else
                        month = myDate.getMonth()+1;
                    
                    if( myDate.getDate() < 10)
                       day = '0'+myDate.getDate();
                    else
                       day = myDate.getDate();
                   
                    year = myDate.getFullYear();

                    /*Fix the date format*/
                    
                    $("#date_insurance_payment_issued").val(month+'/'+day+'/'+year);
                }
                else
                    $("#date_insurance_payment_issued").val('');
                dollorchange("#amount_insurance_payment_issued");
               //check_change('amount_insurance_payment_issued');
            }
        </script>
        <script type="text/javascript" language="javascript" >
            function dateandtimefocus(index)
            {
                var hiddendatename="#hidden_date_and_time_"+index.toString();
                var datename="#date_and_time_"+index.toString();
                var real_date = "#date_and_time_real_"+index.toString();
                var billername="#log_"+index.toString();
                if($(datename).val()==null||$(datename).val()==''||$(datename).val()=="")
                {
                    var myDate = new Date();
                    var myTime = showtime();
                    $(datename).val(myTime);
//                    $(datename).val((myDate.getMonth()+1)+'/'+myDate.getDate()+'/'+myDate.getFullYear()+' '+myDate.getHours()+':'+myDate.getMinutes());
                    $(billername).val($("#billername").val()+': ');
                    var hiddentime = hiddenshowtime();
                    $(hiddendatename).val(hiddentime);
                    var real_time = realtime();
                    $(real_date).val(real_time);
                }
            }
        </script>
        <!--
            when the assigned biller changed add it to the log.
        -->
        <script type="text/javascript" language="javascript">
        function assignedbillerchange() {
            var biller=$("#billername").val();
            var assignee = $("#assigned_user_id").val();
            var user_name='';
            var log="";
            if(assignee!=null&&assignee!=''){
                $.post("<?php echo $this->baseUrl ?>/biller/claims/getusernamefromid/",{user_id:assignee},
                function(data)
                {
                  var myjson='';
                  var currenttime = showtime();
                  var real_time = realtime();
                  eval("myjson=" + data + ";");
                  user_name = myjson.user_name;   
                  log = biller + ": assigned this claim to "+ user_name;
                  addlog(currenttime,biller,log,real_time);
                });
            }else{
                 log = biller + ": unassigned this claim";
                 var currenttime = showtime();
                 var real_time = realtime();
                 addlog(currenttime,biller,log,real_time);
            }
        }
         </script>
        <script type="text/javascript" language="javascript" >
            /*function addlog(time,log,realtime)
            {
                addtable5();
                $('#date_and_time_'+interactionlogId).val(time);
                $('#date_and_time_real_'+interactionlogId).val(realtime);
                $('#log_'+interactionlogId).val(log);
                var hiddentime = hiddenshowtime();
                $('#hidden_date_and_time_'+interactionlogId).val(hiddentime);
            }*/
        </script>
        <script type="text/javascript" language="javascript" >
            function addlog(time,biller,log,realtime)
            {
                addtable5();
                $('#date_and_time_'+interactionlogId).val(time);
                $('#date_and_time_real_'+interactionlogId).val(realtime);
                $('#log_'+interactionlogId).val(log);
                var hiddentime = hiddenshowtime();
                $('#hidden_date_and_time_'+interactionlogId).val(hiddentime);
                        
//                var interactionDiv = document.getElementById("interactionlogDiv");
//                for(var i=8;i>0;i--)
//                {
//                    var hiddendatename ="#hidden_date_and_time_"+i.toString();
//                    var datename="#date_and_time_"+i.toString();
//                    //                    var billername="#who_number_and_ref_number_"+i.toString();
//                    var logname="#log_"+i.toString();
//                    var tablename='mytable'+i.toString()+'_1';
//                    //                    var tablename2='mytable'+i.toString()+'_2';
//                    var d=$(datename).val();
//                    if(d==null||d==""||d=='')
//                    {
//                        if(i!=1)
//                        {
//                            document.getElementById(tablename).style.display="";
//                            //                            document.getElementById(tablename2).style.display="";
//                        }
//                        if(i==7){
//                            interactionDiv.style.height = "50px";
//                        }
//                        if(i==6){
//                            interactionDiv.style.height = "75px";
//                        }
//                        
//                        $(datename).val(time);
//                        //                        date(datename);
//                        $(logname).val(log);
//                        // 
//                        var hiddentime = hiddenshowtime();
//                        $(hiddendatename).val(hiddentime);
//                        //                                     $(billername).val(biller);
//                        break;
//                    }
//                }
            }
        </script>
<!--        add the showtime() function to show the right time format -->
        <script type="text/javascript" language="javascript">
            function showtime(){
            var today=new Date();
            var year=today.getFullYear();
            var month=today.getMonth()+1;
            var day=today.getDate();
            var hours = today.getHours();
            var minutes = today.getMinutes();
            var timeValue = (month<10?"0":"")+month+"/"+(day<10?"0":"")+day+"/"+year + " " + (hours<10?"0":"")+hours +":" + (minutes<10?"0":"")+minutes; 
            return timeValue;
            }
        </script>
<!-- add the hidden_show time to sort the log input-->
<script type="text/javascript" language="javascript">
            function hiddenshowtime(){
            var today=new Date();
            var year=today.getFullYear();
            var month=today.getMonth()+1;
            var day=today.getDate();
            var hours = today.getHours();
            var minutes = today.getMinutes();
            var seconds = today.getSeconds();
            var timeValue = (month<10?"0":"")+month+"/"+(day<10?"0":"")+day+"/"+year + " " + (hours<10?"0":"")+hours +":" + (minutes<10?"0":"")+minutes+":"+seconds; 
            return timeValue;
            }
        </script>
<script type="text/javascript" language="javascript">
            function realtime(){
            var today=new Date();
            var year=today.getFullYear();
            var month=today.getMonth()+1;
            var day=today.getDate();
            var hours = today.getHours();
            var minutes = today.getMinutes();
            var seconds = today.getSeconds();
            var timeValue = (month<10?"0":"")+month+"/"+(day<10?"0":"")+day+"/"+year + " " + (hours<10?"0":"")+hours +":" + (minutes<10?"0":"")+minutes+":"+(seconds<10?"0":"")+seconds; 
            return timeValue;
            }
        </script>

        <script type="text/javascript" language="javascript" >
            function status() {
                var cur_payment_Id = paymentId;
                var claim_status=$("#claim_status").val();
                var last_status=$("#last_status").val();
                var claim_status_list =  <?php echo json_encode($this->claimstatusList); ?>;
                var claim_status_display ="";
                var last_status_display = "";
                var i=0;
                while(i<claim_status_list.length)
                {
                    
                    if(claim_status==claim_status_list[i]['claim_status']){
                        claim_status_display = claim_status_list[i]['claim_status_display'];
                    }
                    if(last_status==claim_status_list[i]['claim_status']){
                        last_status_display = claim_status_list[i]['claim_status_display'];
                    }
                    i++;
                }
                /*Fix the date format*/
                    var month,day,year;
                    var myDate = new Date();
                    if( myDate.getMonth() + 1< 10)
                        month = '0'+(myDate.getMonth()+1);
                    else
                        month = myDate.getMonth()+1;
                    
                    if( myDate.getDate() < 10)
                       day = '0'+myDate.getDate();
                    else
                       day = myDate.getDate(); 
                   
                    year = myDate.getFullYear();
                    /*Fix the date format*/
                
                
                var currentdate=month+'/'+day+'/'+year;
                
               // var currenttime=(myDate.getMonth()+1)+'/'+myDate.getDate()+'/'+myDate.getFullYear()+' '+myDate.getHours()+':'+myDate.getMinutes();
                currenttime = showtime();
                var real_time = realtime();
                /*Fix the date format*/
                    
                    var nextweek = new Date();
                    nextweek.setDate(myDate.getDate()+7);
                    
                    if( nextweek.getMonth() + 1 < 10)
                        month = '0'+(nextweek.getMonth()+1);
                    else
                        month = nextweek.getMonth()+1;
                    
                    if( nextweek.getDate() < 10)
                       day = '0'+nextweek.getDate();
                    else
                       day = nextweek.getDate(); 
                   
                    year = nextweek.getFullYear();
                    /*Fix the date format*/
                
                
                
                var nextweekdate=month+'/'+day+'/'+year;
                
                var close_status=claim_status.substring(0,6);
                var followup_status=claim_status.substring(0,14);
                /************Juage if the claim status is sec By Yu Lang*************/
                var sec_status = claim_status.substring(0,14);
                /************Juage if the claim status is sec By Yu Lang*************/
  
               
                var biller=$("#billername").val();
                if(claim_status!=last_status)
                {
                    var mainlog= biller+": Change Claim Status from "+last_status_display+" to "+claim_status_display;
                    if(claim_status!='open_billed_primary'&&followup_status!='open_follow_up'&&close_status!='closed' && sec_status!='open_secondary')
                    {
                        addlog(currenttime,biller,mainlog,real_time);
                        $("#last_status").val($("#claim_status").val());
                        return false;
                    }
                    if(claim_status=='open_billed_primary')
                    {
                        $("#date_billed").val(currentdate);
                        addlog(currenttime,biller,mainlog,real_time);
                        $("#last_status").val($("#claim_status").val());
                        return false;
                    }
                    
                    
                    /***************Check the status of secondary billed By Yu Lang********************/
                    if(claim_status=='open_ready_secondary_bill') {    
                        
//                        alert("open_secondary");
                        var secLog = new Array();
                        var secAcount=0;
                        var secCancel = false;
                        
                        $.get("<?php echo $this->baseUrl ?>/biller/claims/checkdobandsec",function(data){
                            var secJson='';
                            eval("secJson=" + data + ";");
                            if(secJson.exist=='false' || secJson.secondaryinfo=='false' /*|| secJson.policynumber=='false' || secJson.insuranceplan=='false'*/)
                            {
                                var secReason=prompt("Please confirm billing for secondary insurance without EOB or without secondary insurance info.","");
                                if(secReason)
                                {
                                    secLog[secAcount]='Please confirm billing for secondary insurance without EOB or without secondary insurance info: '+secReason;
                                    secAcount=secAcount+1;
                                }
                                else
                                {
                                    secCancel=true;
                                    $("#claim_status").val($("#last_status").val());
                                }
                            }
                            if(secCancel==false)
                            {
                                for(var i=0;i<secAcount;i++)
                                {
                                    addlog(currenttime,biller,secLog[i],real_time);
                                }
                                 addlog(currenttime,biller,mainlog,real_time);

                                $("#last_status").val($("#claim_status").val());
                            } 
                        });

                        return false;
                    }
                    /***************Check the status of secondary billed By Yu Lang********************/
     
                    if(followup_status=='open_follow_up')
                    {                  
                        $("#date_of_next_followup").val(nextweekdate);
                        addlog(currenttime,biller,mainlog,real_time);
                        $("#last_status").val($("#claim_status").val());
                        return false;
                    }
                    if(sec_status=='open_secondary')
                    {                  
                        addlog(currenttime,biller,mainlog,real_time);
                        $("#last_status").val($("#claim_status").val());
                        return false;
                    }
                   
                    /***************************************close_status juagement************/      
                    if(close_status=='closed')
                    {   
                        var autoBiller = $("#autoBiller").val();
                        
                        $("#date_closed").val(currentdate);
                        var deductable=$("#EOB_deductable").val();
                        var insurance=$("#EOB_co_insurance").val();
                        var reduction = $("#EOB_reduction").val();
                        var other_reduction =  $("#EOB_other_reduction").val();                        
                        
                        var exclude_deductible=$("#exclude_deductible").val();
                        var exclude_coinsurance=$("#exclude_coinsurance").val();
                        var exclude_reduction = $("#exclude_reduction").val();
                        var exclude_otherreduction =  $("#exclude_otherreduction").val();
                        
                        var amountreceived=$("#amount_insurance_payment_received").val();
                        /*<!------------------Add Reduction prompt  By <Yu Lang>--------------------->*/
                        var amountpaid =  $("#amount_paid").val();
                        //alert('amount paid = ' + amountpaid);
                        /*<!------------------Add Reduction prompt  By <Yu Lang>--------------------->*/
                        var allowedamount=$("#EOB_allowed_amount").val();
                        var paymentexpected=$("#expected_payment").val();
                        var agreedamount=$("#negotiated_payment_amount").val();
                        
                        
                        
                        var log=new Array();
                        var acount=0;
                        var cancel=false;
                        
                        if( amountpaid.length == 0 )amountpaid = 0;
                        if(exclude_deductible === '1' || deductable.length == 0 )deductable = 0;
                        if(exclude_coinsurance === '1' || insurance.length == 0 )insurance = 0;
                        if(exclude_reduction === '1' || reduction.length == 0 )reduction = 0;
                        if(exclude_otherreduction === '1' || other_reduction.length == 0 )other_reduction = 0;
                     
                        /**!!!!!The problem is about the amountreceived!!!!**/
                        /*<!------------------Add Reduction prompt  By <Yu Lang>--------------------->*/
                        /*
                        if(amountpaid.length > 0 && allowedamount.length > 0 && deductable.length > 0 && insurance.length > 0 && reduction.length > 0 && 
                        other_reduction.length > 0)
                         */
                       
                        $.get("<?php echo $this->baseUrl ?>/biller/claims/iseobfileexist",function(data){
                            var myjson='';
                            eval("myjson=" + data + ";");
                            var  payer_type=$('#payer_type').val();
                            //alert(myjson.document_feature);
                            if(myjson.exist=='false'&&'Self Pay'!=payer_type&&myjson.document_feature==1)
                            {
                                var reason=prompt("Please confirm closing this claim without EOB document in the system","");
                                if(reason)
                                {
                                    log[acount]='Please confirm closing this claim without EOB document in the system: '+reason;
                                    acount=acount+1;
                                }
                                else
                                {
                                    cancel=true;
                                    $("#claim_status").val($("#last_status").val());
                                }
                            }
                            if(cancel==false)
                            {
                              
                                for(var i=0;i<acount;i++)
                                {
                                    addlog(currenttime,biller,log[i],real_time);
                                }
                                  addlog(currenttime,biller,mainlog,real_time);
                                
                                $("#last_status").val($("#claim_status").val());
                                if(autoBiller == "1"){
                                    var balance_due = - parseFloat($("#balance_due").val());
                                    if(balance_due != 0){
                                        if(paymentId==1)
                                        {
                                            if($("#payment_amount_1").val()==""||$("#payment_amount_1").val()==null){
                                                var i = 1;
                                            }else{
                                                addtable7("total","new");
                                                var i = paymentId;
                                            }
                                        }else{
                                            addtable7("total","new");
                                            var i = paymentId;
                                        }
                                        var amount = "#payment_amount_" + (i);
                                        var datetime = "#payment_date_and_time_" + (i);
                                        var from = "#payment_from_" + (i);
                                        var notes = "#payment_notes_" + (i);
                                        var internal_notes = "#payment_internal_notes_" + (i); 
                                        var positive = "#payment_amount_positive_" + (i);
                                        var value = Math.abs(balance_due);
                                        value = value.toString()
                                        //alert(value)
                                        if(value.search(/\./)!=-1){}else{value = value +".00";}
                                        $(amount).val(value);
                                        $(positive).val("negative");
                                        $(amount).css("color","red");
                                        //$(amount).val(myjson.payments[i]['amount']);
                                        var addtime = realtime();
                                        $(datetime).val(addtime);
                                        $(from).val("Biller Adjustment");
                                        $("#balance_due").val(0);
                                        //check_change("balance_due");
                                    }
                                }
                            } 
                        });
                        
                         /* fix bug for close_payment_as_expected 2012-09-17
                        if(claim_status != 'closed_payment_as_expected')
                        {
                        *************************************************/
                       
                        if( allowedamount.length > 0 ) {         
                            //var x = parseFloat(allowedamount) * 100 - parseFloat(deductable) * 100 - parseFloat(insurance) * 100 - parseFloat(reduction) * 100 - parseFloat(other_reduction) * 100;                              
                            //alert(allowedamount + '|' + deductable + '|' + insurance +'|' + reduction + '|' + other_reduction);
                            var x = Math.round(allowedamount * 100) - Math.round(deductable * 100) - Math.round(insurance * 100) - Math.round(reduction * 100) - Math.round(other_reduction * 100);
                            //alert('amountpaid = ' + amountpaid + ' , x = ' + x);
                            if(Math.round(amountpaid * 100) != x) {
                                var reason=prompt("Please confirm the Amount Paid has included all patient responsibilities and reductions in the EOB section","");
                                if(reason) {
                                    log[acount]='Please confirm the Amount Paid has included all patient responsibilities and reductions in the EOB section: '+reason;
                                    acount=acount+1;
                                }
                                else {
                                    cancel=true;
                                    $("#claim_status").val($("#last_status").val());
                                    return false;
                                }
                            }
                        }
                        
                        /******************************************08-02******************************************
                        if(claim_status=='closed_payment_as_expected')
                        {
                            if(allowedamount.length > 0 && paymentexpected.length > 0)
                            {
                                if(parseFloat(allowedamount)<parseFloat(paymentexpected))
                                {
                                    var reason=prompt("Please confirm closing this claim with Allowed Amount less than Payment Expected","");
                                    if(reason)
                                    {
                                        log[acount]='Please confirm closing this claim with Allowed Amount less than Payment Expected: '+reason;
                                        acount=acount+1;
                                    }
                                    else
                                    {
                                        cancel=true;
                                        $("#claim_status").val($("#last_status").val());
                                        return false;
                                    }
                                }
                            }
                        }
                             ***************08-02****************************************************/
                            
                       /* fix bug for close_payment_as_expected 2012-09-17
                       }
                       ******************************************/
                 
                    
                        /******************************************08-06******************************************/
                    
                        if(claim_status=='closed_payment_as_expected') {                                                      
                            if(agreedamount.length>0) {
                                if(allowedamount.length>0) {
                                    // var x=allowedamount * 100 - deductable * 100 - insurance * 100;                                    
                                    var x = Math.round(allowedamount * 100) -  Math.round(deductable * 100) - Math.round(insurance * 100); 
                                                                        
                                    if(Math.round(amountpaid * 100)!=x) {
                                        var reason=prompt("Please confirm closing this claim with Allowed/Received Amount less than Payment Expected","");
                                        if(reason) {
                                            log[acount]='Please confirm closing this claim with Allowed/Received Amount less than Payment Expected: '+reason;
                                            acount=acount+1;
                                        } else {
                                            cancel=true;
                                            $("#claim_status").val($("#last_status").val());
                                            return false;
                                        }
                                    }
                                } else if(amountpaid.length>0) {
                                    if(parseFloat(amountpaid) < parseFloat(agreedamount)) {
                                        var reason=prompt("Please confirm closing this claim with Allowed/Received Amount less than Agreed Amount","");
                                        if(reason) {
                                            log[acount]='Please confirm closing this claim with Allowed/Received Amount less than Agreed Amount: '+reason;
                                            acount=acount+1;
                                        } else {
                                            cancel=true;
                                            $("#claim_status").val($("#last_status").val());
                                            return false;
                                        }
                                    }             
                                }
                                else {                              
                                    var reason=prompt("Please confirm closing this claim with Allowed/Received Amount less than Agreed Amount","");
                                    if(reason) {
                                        log[acount]='Please confirm closing this claim with Allowed/Received Amount less than Agreed Amount: '+reason;
                                        acount=acount+1;
                                    } else {
                                        cancel=true;
                                        $("#claim_status").val($("#last_status").val());
                                        return false;
                                    }
                                }                            
                            }
                                                
                            if(paymentexpected.length>0) {
                                if(allowedamount.length>0) {
                                    if(parseFloat(allowedamount) < parseFloat(paymentexpected)) {
                                        var reason=prompt("Please confirm closing this claim with Allowed/Received Amount less than Payment Expected","");
                                        if(reason) {
                                            log[acount]='Please confirm closing this claim with Allowed/Received Amount less than Payment Expected: '+reason;
                                            acount=acount+1;
                                        } else {
                                            cancel=true;
                                            $("#claim_status").val($("#last_status").val());
                                            return false;
                                        }
                                    }
                                } else if(amountpaid.length>0) {                           
                                    if(parseFloat(amountpaid) < parseFloat(paymentexpected)) {
                                        var reason=prompt("Please confirm closing this claim with Allowed/Received Amount less than Payment Expected","");
                                        if(reason) {
                                            log[acount]='Please confirm closing this claim with Allowed/Received Amount less than Payment Expected: '+reason;
                                            acount=acount+1;
                                        } else {
                                            cancel=true;
                                            $("#claim_status").val($("#last_status").val());
                                            return false;
                                        }
                                    }         
                                } else {                                                               
                                    var reason=prompt("Please confirm closing this claim with Allowed/Received Amount less than Payment Expected","");
                                    if(reason) {
                                        log[acount]='Please confirm closing this claim with Allowed/Received Amount less than Payment Expected: '+reason;
                                        acount=acount+1;
                                    } else {
                                        cancel=true;
                                        $("#claim_status").val($("#last_status").val());
                                        return false;
                                    }                                   
                                }
                            }    
                        }                                                      
                    }
                }    
            }
        </script>
<script type="text/javascript" language="javascript" >
            function statementstatus() {
               
                var statement_status=$("#statement_status").val();
                //alert("statement_status entered: " + statement_status);
                var last_statement_status=$("#last_statement_status").val();
                //alert('1- #last_statement_status = ' + $("#last_statement_status").val());
                var statement_status_list =  <?php echo json_encode($this->statementstatusList); ?>;
                var statement_status_display ="";
                var last_statement_status_display = "";
                var payer_type = $("#payer_type").val();
                var i=0;
                var err = false;
                if (statement_status == 'stmt_ready_selfpay' && payer_type != 'SP') {
                    err = true;
                    alert('You can not create this statement without Self Pay as the primary insurance for this claim, please correct on Service tab.'); 
                    //$("#statement_status").css("border","4px solid red");
                    //$("#statement_status").focus();
                } else if (statement_status == 'stmt_ready_payment_sent_to_patient') {
                    var box = document.getElementById("is_the_issued_payment_sent_to_patient");
                    var state = box.checked?"true":"false";
                    if (state == 'false') {
                        err = true;
                        alert('You can not create this statement without the "Sent To Patient?" box being checked for this claim, please correct it on Claim tab.');                    
                    }
                } else if (statement_status == 'stmt_ready_coinsurance') {
                    var co_ins = $("#EOB_co_insurance").val();
                    if(co_ins == null || co_ins == '') {
                        err = true;
                        alert('You can not create this statement without EOB data entered for this claim, please correct it on Claim tab.');                
                    }
                } else if (statement_status == 'stmt_ready_deductible') {
                    var deduct = $("#EOB_deductable").val();
                    if(deduct == null || deduct == '') {
                        err = true;
                        alert('You can not create this statement without EOB data entered for this claim, please correct it on Claim tab.');
                    }    
                }
                if (err) {
                    //alert('#last_statement_status = ' + $("#last_statement_status").val());
                    $("#statement_status").val($("#last_statement_status").val());
                    //alert('#statement_status = ' + $("#statement_status").val()) ;
                } else {
                
                while(i<statement_status_list.length)
                {
                    
                    if(statement_status==statement_status_list[i]['statement_status']){
                        statement_status_display = statement_status_list[i]['statement_status_display'];
                    }
                    if(last_statement_status==statement_status_list[i]['statement_status']){
                        last_statement_status_display = statement_status_list[i]['statement_status_display'];
                    }
                    i++;
                }
                /*Fix the date format*/
                    var month,day,year;
                    var myDate = new Date();
                    if( myDate.getMonth() + 1< 10)
                        month = '0'+(myDate.getMonth()+1);
                    else
                        month = myDate.getMonth()+1;
                    
                    if( myDate.getDate() < 10)
                       day = '0'+myDate.getDate();
                    else
                       day = myDate.getDate(); 
                   
                    year = myDate.getFullYear();
                    /*Fix the date format*/
                                
                var currentdate=month+'/'+day+'/'+year;
                
               // var currenttime=(myDate.getMonth()+1)+'/'+myDate.getDate()+'/'+myDate.getFullYear()+' '+myDate.getHours()+':'+myDate.getMinutes();
                currenttime = showtime();
                var real_time = realtime();
                /*Fix the date format*/
                    
                    var nextweek = new Date();
                    nextweek.setDate(myDate.getDate()+7);
                    
                    if( nextweek.getMonth() + 1 < 10)
                        month = '0'+(nextweek.getMonth()+1);
                    else
                        month = nextweek.getMonth()+1;
                    
                    if( nextweek.getDate() < 10)
                       day = '0'+nextweek.getDate();
                    else
                       day = nextweek.getDate(); 
                   
                    year = nextweek.getFullYear();
                    /*Fix the date format*/                                
                
                var nextweekdate=month+'/'+day+'/'+year;                                
                 
                var biller=$("#billername").val();
                //alert("statement_status : " + statement_status);
                //alert("last_statement_status : " + last_statement_status);
                if(statement_status!=last_statement_status)
                {   
                    if(last_statement_status==""){
                        var mainlog= biller+": Added Statement Status "+statement_status_display;
                        addlog(currenttime,biller,mainlog,real_time);
                    }else if(statement_status==""){
                        var mainlog= biller+": Removed Statement Status "+last_statement_status_display;
                        addlog(currenttime,biller,mainlog,real_time);
                    }else{
                        var mainlog= biller+": Changed Statement Status from "+last_statement_status_display+" to "+statement_status_display;
                        addlog(currenttime,biller,mainlog,real_time);
                    }
                    $("#last_statement_status").val($("#statement_status").val());
                    return false;                                                                                                                                                   
                }
            }
        }
        </script>
        <script type="text/javascript" language="javascript" >
            function totalcharge()
            {
                dollorchange('#total_charge');
                var totalcharge=$("#total_charge").val();
                var amountpaid=$("#amount_paid").val();
                var bjments = 0;
                var balance_due=0;
                for(var i= 1;i<=billerId;i++){
                    var amount=$("#amount_biller_adjustment_"+i.toString()).val();
                    
 
                    if(amount!=null&&amount.length!=0){
                        bjments = bjments + parseFloat(amount);
                    }
                    
                }
                
                if(totalcharge.length!=0){
                    if(amountpaid.length!=0)
                    {
                        balance_due  = parseFloat(totalcharge)-parseFloat(amountpaid) + bjments;
                  
                    }
                    else
                        balance_due = parseFloat(totalcharge) + bjments;;
                }
                
                 
                if(balance_due>=0)
                {   

                    $("#balance_due").val(balance_due.toFixed(2));
                }
                else
                  $("#balance_due").val("0.00");
                check_change("balance_due");
                
                  //alert("Total Charge Must Greater Than Amount Paid");
               
            }
        </script>
        <script type="text/javascript" language="javascript" >
            function  benefitdate(name)
            {
                var benifit=$(name).val();
                var myDate = new Date();
                var month = myDate.getMonth()+1;
                var day;
                var myMonth
                right_format(name);
                if(month<10){
                    myMonth = "0"+month;
                }else{
                    myMonth = month;
                }
                if(myDate.getDate() < 10){
                    day =  '0'+myDate.getDate();
                }else{
                    day = myDate.getDate();
                }
                
                if(benifit.length>0){
                    $("#benefit_date_taken").val(myMonth+'/'+day+'/'+myDate.getFullYear());
                }
                //check_change('benefit');
            }
        </script>
        <script type="text/javascript" language="javascript">
            function right_format(name){
                dollorchange(name);
            }
        </script>
        <script type="text/javascript" language="javascript" >
            function amount(index)
            {
                if(index==1){
                    dollorchange("#EOB_allowed_amount");
                }
                if(index==2){
                    dollorchange("#EOB_not_allowed_amount");
                }
                
                var totalcharge=$("#total_charge").val();
                var allowedamount=$("#EOB_allowed_amount").val();
                var notallowedamount=$("#EOB_not_allowed_amount").val();
                if(totalcharge.length>0)
                {
                    if(index==1)
                    {
                        if(allowedamount.length>0)
                        {
                            var x=totalcharge-allowedamount;
                            $("#EOB_not_allowed_amount").val(x.toFixed(2));
                        }
                        //check_change('EOB_allowed_amount');
                    }
                
                    else
                    {
                        if(notallowedamount.length>0)
                        {
                            var x=totalcharge-notallowedamount;
                            $("#EOB_allowed_amount").val(x.toFixed(2));
                        }
                        //check_change('EOB_not_allowed_amount');
                    }
                }
            }
        </script>
        <script type="text/javascript" language="javascript" >
            function amountpaidreceive()
            {
                dollorchange('#amount_paid');
                var totalcharge=$("#total_charge").val();
                var amountpaid=$("#amount_paid").val();
                if(amountpaid.length>0)
                {
                    $("#amount_insurance_payment_received").val(amountpaid);
                    var amountissued=$("#amount_insurance_payment_issued").val();
                    var myDate = new Date();
                    var month = myDate.getMonth()+1;
                    var day;
                    var myMonth="";
                    if(month<10){
                        myMonth = "0"+month;
                    }else{
                        myMonth = month;
                    }
                     if(myDate.getDate()<10){
                        day = "0"+myDate.getDate();
                    }else{
                        day = myDate.getDate();
                    }
                                       
                    if(amountissued.length==0)
                    {
                        $("#date_insurance_payment_issued").val(myMonth+'/'+day+'/'+myDate.getFullYear());
                        $("#amount_insurance_payment_issued").val($("#amount_insurance_payment_received").val());
                        //var myDate = new Date();
                        check_change("date_insurance_payment_issued");
                        check_change('amount_insurance_payment_issued');
                    }

                    $("#date_insurance_payment_received").val(myMonth+'/'+day+'/'+myDate.getFullYear());
                }
                else
                    $("#date_insurance_payment_received").val('');
                check_change('amount_insurance_payment_received');
                
                totalcharge();
                
            }
        </script>
        <script type="text/javascript" language="javascript" >
            function paymentreceived(index)
            {
                dollorchange("#amount_insurance_payment_received_"+index.toString());
                
                var amountreceived;
                var datename;
                amountreceived=$("#amount_insurance_payment_received_"+index.toString()).val();
                datename="#date_insurance_payment_received_"+index.toString();
                //                if(index==1)
                //                {
                //                    amountreceived=$("#amount_insurance_payment_received_1").val();
                //                    datename="#date_insurance_payment_received_1";
                //                }
                //                else
                //                {
                //                    amountreceived=$("#amount_insurance_payment_received_"+index.toString()).val();
                //                    datename="#date_insurance_payment_received_"+index.toString();
                //                }
                var x=0;
                //                var pay1=$("#amount_patient_payment_received").val();
                //                var pay2=$("#amount_insurance_payment_received").val();
                //                if(pay1!='')
                //                    x=x+parseFloat(pay1);
                //                if(pay2!='')
                //                    x=x+parseFloat(pay2);
                var counter = 0;
                if(id>id3){
                    counter = id;
                }else{
                    counter = id3
                }
                 
                
                for(var i=1;i<=counter;i++)
                {
                    var amount1=$("#amount_patient_payment_received_"+i.toString()).val();
                    if(amount1!='' && amount1 != null)
                    {
                        x=x+parseFloat(amount1);
                        // x += (amount1*100)/100;
                    }
                    var amount2=$("#amount_insurance_payment_received_"+i.toString()).val();
                    if(amount2!='' && amount2 != null )
                    {
                        x=x+parseFloat(amount2);
                    }
                }
                
               
                
                $("#amount_paid").val(x.toFixed(2));
                var myDate = new Date();
                var month = myDate.getMonth()+1;
                var day;
                var myMonth="";
                if(month<10){
                    myMonth = "0"+month;
                }else{
                    myMonth = month;
                }
                
                if(myDate.getDate()<10){
                    day = '0'+myDate.getDate();
                }
                else{
                    day = myDate.getDate();
                }
                  
                
               
                if(amountreceived.length>0)
                {
                    $(datename).val(myMonth+'/'+day+'/'+myDate.getFullYear());
                }
                else
                    $(datename).val('');

                totalcharge();

            }
        </script>
        <script type="text/javascript" language="javascript" >
            function paymentreceived2(index)
            {
                dollorchange("#amount_patient_payment_received_"+index.toString());
                var amountreceived;
                var datename;
                //                if(index==1)
                //                {
                //                    amountreceived=$("#amount_patient_payment_received_1").val();
                //                    datename="#date_patient_payment_received_1";
                //                }
                //                else
                //                {
                amountreceived=$("#amount_patient_payment_received_"+index.toString()).val();
                datename="#date_patient_payment_received_"+index.toString();
                //                }
                var x=0;
                //                var pay1=$("#amount_patient_payment_received_1").val();
                //                var pay2=$("#amount_insurance_payment_received_1").val();
                //                if(pay1!='')
                //                    x=x+parseFloat(pay1);
                //                if(pay2!='')
                //                    x=x+parseFloat(pay2);

                var counter = 0;
                if(id>id3){
                    counter = id;
                }else{
                    counter = id3
                }
                for(var i=1;i<=counter;i++)
                {
                    var amount1=$("#amount_patient_payment_received_"+i.toString()).val();
                    if(amount1!='' && amount1 != null)
                        x=x+parseFloat(amount1);
                    var amount2=$("#amount_insurance_payment_received_"+i.toString()).val();
                    if(amount2!='' && amount2 != null )
                        x=x+parseFloat(amount2);
                }

                $("#amount_paid").val(x.toFixed(2));
                var myDate = new Date();
                var month = myDate.getMonth()+1;
                var myMonth=(month<10?"0":"")+month;
                
                var day =(myDate.getDate()<10?  "0":"")+myDate.getDate();
//                if(month<10){
//                    myMonth = "0"+month;
//                }else{
//                    myMonth = month;
//                }
               
                if(amountreceived.length>0)
                {
                    $(datename).val(myMonth+'/'+day+'/'+myDate.getFullYear());
                }
                else
                    $(datename).val('');
                totalcharge();
            }
        </script>
  
        <script type="text/javascript" language="javascript" >
            function paymentreceived3(index)
            {
                dollorchange("#amount_biller_adjustment_"+index.toString());
                var amountreceived;
                var datename;
                if(index==1)
                {
                    amountreceived=$("#amount_biller_adjustment_1").val();
                    datename="#date_biller_adjustment_1";
                }
                else
                {
                    amountreceived=$("#amount_biller_adjustment_"+index.toString()).val();
                    datename="#date_biller_adjustment_"+index.toString();
                }
               
                var myDate = new Date();
                var month = myDate.getMonth()+1;
                var myMonth="";
                
                var day =(myDate.getDate()<10? "0":"")+myDate.getDate();
                
                if(month<10){
                    myMonth = "0"+month;
                }else{
                    myMonth = month;
                }
               
                if(amountreceived.length>0)
                {
                    $(datename).val(myMonth+'/'+day+'/'+myDate.getFullYear());
                }
                else
                    $(datename).val('');
                
                totalcharge();
            }
        </script>

        <script type="text/javascript" language="javascript" >
            function initialoffer()
            {
                //var myDate = new Date();
                dollorchange('#amount_initial_offer');
                //$("#date_insurance_payment_issued").val(myDate.getMonth()+'/'+myDate.getDate()+'/'+myDate.getFullYear());
                var initialoffer=$("#amount_initial_offer").val();
                //alert(amountissued.length);
                if(initialoffer.length>0)
                {
                    /*Fix the date format*/
                    var month,day,year;
                    var myDate = new Date();
                    if( myDate.getMonth() + 1< 10)
                        month = '0'+(myDate.getMonth()+1);
                    else
                        month = myDate.getMonth()+1;
                    /*
                    if( myDate.getDate() < 10)
                       day = '0'+myDate.getDate();
                    else
                       day = myDate.getDate();
                   */
               
                  day =(myDate.getDate()<10?  "0":"")+myDate.getDate();
      
                    year = myDate.getFullYear();
                    /*Fix the date format*/
                    
                    
                    $("#date_initial_offer").val(month+'/'+day+'/'+year);
                }
                else{
                    $("#date_initial_offer").val('');
                }
                //alert(1);
            }
        </script>
        <script type="text/javascript" language="javascript" >
            function paymentagreed()
            {
                //var myDate = new Date();
                //$("#date_insurance_payment_issued").val(myDate.getMonth()+'/'+myDate.getDate()+'/'+myDate.getFullYear());
                dollorchange('#negotiated_payment_amount');
                var amountissued=$("#negotiated_payment_amount").val();
                //alert(amountissued.length);
                if(amountissued.length>0)
                {
                     /*Fix the date format*/
                    var month,day,year;
                    var myDate = new Date();
                    if( myDate.getMonth() + 1 < 10)
                        month = '0'+(myDate.getMonth()+1);
                    else
                        month = myDate.getMonth()+1;
                    
                    if( myDate.getDate() < 10)
                       day = '0'+myDate.getDate();
                    else
                       day = myDate.getDate();
                   
                    year = myDate.getFullYear();
               
                    /*Fix the date format*/
                    $("#date_negotiated_amount_reached").val(month+'/'+day+'/'+year);
                }
                else
                    $("#date_negotiated_amount_reached").val('');
            }
        </script>


        <script type="text/javascript" language="javascript" >
            function addtable()
            {
                var interactionDiv = document.getElementById("interactionDiv");
                for (i=7;i>0;i--)
                {
                    var tablename='mytable'+i.toString()+'_1';
                    //                    var tablename2='mytable'+i.toString()+'_2';
                    if(document.getElementById(tablename).style.display=='none')
                    {
                        if(i==7){
                            interactionDiv.style.height = "50px";
                        }
                        if(i==6){
                            interactionDiv.style.height = "75px";
                        }
                        document.getElementById(tablename).style.display="";
                        //                        document.getElementById(tablename2).style.display="";
                        break;
                    }
                }
            }
        </script>
        <script type="text/javascript" language="javascript" >
            function deletetable()
            {
                var acount=0;
                var interactionDiv = document.getElementById("interactionDiv");
                for (i=1;i<8;i++)
                { //alert(i);
                    var tablename='mytable'+i.toString()+'_1';
                    if(document.getElementById(tablename).style.display=='')
                    {
                        if(i==7){
                            interactionDiv.style.height = "25px";
                        }
                        if(i==6){
                            interactionDiv.style.height = "50px";
                        }
                        acount=i;
                        break;
                    }
                }
                var tablename2_1='mytable'+acount.toString()+'_1';
                var DandT = 'date_and_time_'+acount.toString();
                document.getElementById(tablename2_1).style.display='none';
                document.getElementById(DandT).value ="";
                //                var who_n_AND_r_n = 'who_number_and_ref_number_'+acount.toString();
                //                document.getElementById(who_n_AND_r_n).value ="";
                var log = 'log_'+acount.toString();
                //                alert(document.getElementById(log).value);
                document.getElementById(log).value ="";
                
                //                var tablename2_2='mytable'+acount.toString()+'_2';
                //                document.getElementById(tablename2_2).style.display='none'
            }
        </script>
        <script type="text/javascript" language="javascript" >
            
            
            /*function addtable2(){
                ++id;
                var count2 = document.getElementById("count2");
                var insurancePaymentDiv = document.getElementById("insurancePaymentDiv");
                var insurancePaymentTable = document.getElementById("insurancePaymentTable");
                count2.value = id;
                
                if(id==1){
                    insurancePaymentDiv.style.display = "";
                    insurancePaymentDiv.style.height ="25px";
                }
                if(id ==2){
                    insurancePaymentDiv.style.height = "50px";
                }
                if(id == 3){
                    insurancePaymentDiv.style.height = "75px";
                }
                var newTr= insurancePaymentTable.insertRow(0);
                newTr.id="tr"+id+"";
                var newth1 = document.createElement("TH");
                var newtd1 = document.createElement("TD");
                var newth2 = document.createElement("TH");
                var newth3 = document.createElement("TH");
                if(navigator.userAgent.indexOf("MSIE")!=-1){
                    //alert ("not -1");                
                    newth1.style.width="122px";
                    newth1.colspan=1;
                    newth2.style.width="124px";
                    newth3.style.width="117px";
                }else{
                    //alert (" -1");
                    newth1.style.width="13.8%";
                    //newth1.colspan=1;
                    newtd1.style.width="11%";
                    //newtd1.colspan=1;
                    newth2.style.width="14%";
                    //newth2.colspan=1;
                    newth3.style.width="13.5%";
                    //newth3.colspan=1;
                }
                newth1.innerHTML ="Received Amount";
                newth2.innerHTML ="Received Date";
                newth3.innerHTML ="Notes";
                newTr.appendChild(newth1,0);
                newTr.appendChild(newtd1,1);
                newTr.appendChild(newth2,2);
                newTr.appendChild(newth3,4);
                var newtd2 = newTr.insertCell(3);
                var newtd3 = newTr.insertCell(5);
                if(navigator.userAgent.indexOf("MSIE")!=-1){
                    newtd2.style.width="11%";          
                    newtd2.colspan=1;
                }else{
                    //alert (" Again -1");
                
                    newtd2.style.width="11%";
                    //newtd2.colspan=1;
                    //newtd3.style.width="%99";          
                    newtd3.colspan=4;
                }                               
                newtd3.innerHTML ="<input type=\"text\" name=\"notes_insurance_payment_"+id+"\" id=\"notes_insurance_payment_"+id+")  style=\"width:99%\"/>";
                //newtd3.innerHTML ="<input type=\"text\" name=\"notes_insurance_payment_"+id+"\" id=\"notes_insurance_payment_"+id+"\"/>";
                newtd2.innerHTML ="<input type=\"text\" name=\"date_insurance_payment_received_"+id+"\" id=\"date_insurance_payment_received_"+id+"\" onkeyup=\"javascript:date1902(\'#date_insurance_payment_received_"+id+"\')\"/>";
                newtd1.innerHTML ="<input type=\"text\" name=\"amount_insurance_payment_received_"+id+"\" id=\"amount_insurance_payment_received_"+id+"\" onkeyup=\"javascript:dollorformate('#amount_insurance_payment_received_"+id+"\')\" onblur=\"javascript:paymentreceived("+id+")\" />";               
        
            }
            
            function deletetable2(){
                var insurancePaymentDiv = document.getElementById("insurancePaymentDiv");
                var count2 = document.getElementById("count2");
                if(id>1){
                    
                    var theDeleTr = document.getElementById("tr"+id+"");
                    
                    theDeleTr.parentNode.removeChild(theDeleTr);
                    --id;
                    paymentreceived(id);
                    count2.value = id;
                 
                    if(id ==1){
                        insurancePaymentDiv.style.height ="25px";
                    }
                    if(id == 2){
                        insurancePaymentDiv.style.height = "50px";
                    }
                    if(id == 3){
                        insurancePaymentDiv.style.height ="75px";
                    }
                }
            } */
            
        </script>
         <script type="text/javascript" language="javascript" >
              function dollorchange(money)
             {
                 
                 var localdian=0;
                 var dollormoney=$(money).val();
                 var dollorafter='';
                 var i=0;
                 var isdor=false;
                 var first=dollormoney.charAt(0);
                 for(i=0;i<dollormoney.length;i++){
                     var temp=dollormoney.charAt(i);
                     
                     if(temp.match(/^\d.*$/)||(temp=='.'&&!isdor)||temp=='-'){
                         dollorafter=dollorafter+temp;
                         if(temp=='.'){
                             isdor=true;
                         }
                     }
                 }
                 //dollorafter=9;
               //  $(money).val(dollorafter);
                // newmoney=$(money).val();
                  var dian=dollorafter.length;
                  for(i=0;i<dollorafter.length-1;i++){
                       var temp=dollormoney.charAt(i);
                      if(temp=='.')
                      {
                          dian=i;
                         break;
                      }
                  }
               //   $(money).val('localdian');
              
               
                    localdian=dian+3;
                 
//                   alert(localdian);
//                   alert(dollorafter.length);
//                 $(money).val(localdian);
                 if(localdian<dollorafter.length)
                 {
                     newdollor=dollorafter.substr(0,localdian);
                      $(money).val(newdollor);
                 }else
                 {
                     if((localdian-dollorafter.length)==3&&!isdor&&dollorafter.length!=0){
                      
                        dollorafter=dollorafter+".00"
                     }
                     else if(localdian-dollorafter.length==3&&isdor&&dollorafter.length!=0){
                        dollorafter=dollorafter+"00"
                     }
                     else if(localdian-dollorafter.length==1&&dollorafter.length!=0){
                        dollorafter=dollorafter+"0"
                     }
                     $(money).val(dollorafter);
                 }
                 var namelength=money.length;
                 var newname=money.substr(1,namelength-1);
                
//                 $('#expected_payment').var('123');
                 
             }
             function dollorformate(money)
             {
                 var dollormoney=$(money).val();
                 var dollorlenght=dollormoney.length;
                 var temp=dollormoney.charAt(dollorlenght-1);
//                  $(money).val('');
                 if(dollorlenght==1){
                     if(temp=='-'||temp=='0'||temp=='1'||temp=='2'||temp=='3'||temp=='4'||temp=='5'||temp=='6'||temp=='7'||temp=='8'||temp=='9')
                     {
                         
                     }else{
                         $(money).val('');
                     }
                 }
                 else
                 {
                     if(dollorlenght==2){//deal with 0.0
                          //$(money).val(dollorlenght);
                         var zero=dollormoney.charAt(0);
                         if(zero=='0'){
                                if(zero=='0'&&temp=='.'){

                                }else{
                                    if(temp=='1'||temp=='2'||temp=='3'||temp=='4'||temp=='5'||temp=='6'||temp=='7'||temp=='8'||temp=='9')
                                    {
                                        $(money).val(team);
                                    }
                                    else{
                                        $(money).val(zero);
                                    }
                                }
                            }
                            else{
                                    if(temp==','||temp=='.'||temp=='1'||temp=='2'||temp=='3'||temp=='4'||temp=='5'||temp=='6'||temp=='7'||temp=='8'||temp=='9'||temp=='0')
                                       {
                                           $(money).val(team);
                                       }
                                       else{
                                           $(money).val(zero);
                                       }
                            }
                     }
                     else{
                            if(temp==','||temp=='1'||temp=='2'||temp=='3'||temp=='4'||temp=='5'||temp=='6'||temp=='7'||temp=='8'||temp=='9'||temp=='.'||temp=='0')
                            {
                             //   $(money).val(isdian(money)); 
                                if(isdian(money)&&temp=='.'){
                                    valm=dollormoney.substr(0,dollorlenght-1);
                                    $(money).val(valm); 
                                }else{
                                    
                                }

                            }else
                            {
                                valm=dollormoney.substr(0,dollorlenght-1);
                                $(money).val(valm);
                            }
                        }
                 }
             }
             function wheredian(dollorafter){
                
                 var dian=dollorafter.length;
                 for(i=0;i<dollorafter.length-1;i++){
                      if(temp=='.')
                      {
                          dian=i;
                        
                      }
                 }
                 
             }
             function isdian(money){ //judge there is "." before or not 
                 var isdian=false;
                 var dollormoney=$(money).val();
                 //var i=0;
                 for(i=0;i<dollormoney.length-1;i++){
                      var temp=dollormoney.charAt(i);
                      if(temp=='.')
                      {
                          isdian=true;
                      }
                 }
                 return isdian;
                 
             }
             function date1902(name){
                
                 date(name);
                 var time=$(name).val();
                 if(time.length==10){
                    
                    var index=0;
                    for(index=0;index<time.length;index++){
                       var cur=time.charAt(index) ;
                              if(cur<'0'||cur>'9'){
                               if(index==2||index==5){
                                   if(cur!='/'){
                                        time=time.substr(0,index)+time.substr(index+1,time.length-index-1);
                                        $(name).val(time);
                                         return;
                                   }
                               }else{
                                        //alert(cur);
                                        time=time.substr(0,index)+time.substr(index+1,time.length-index-1);
                                        $(name).val(time);
                                        tempname=name.substr(1,name.length-1);
                                        //alert(tempname);
                                        setCaretPosition(document.getElementById(tempname),index);
    
                                         return;
                                }
                              
                       }
                    }
                     
                }
                 
                 if(time.length==10)
                {
                    var year=parseInt(time.substr(6,10));
                    if(year>2037){
                         newyear=time.substr(0,6);
                          $(name).val(newyear);
                     }
                    if(year<1902){
                         newyear=time.substr(0,6);
                          $(name).val(newyear);
                     }
                        
                     
                        
                }
                // dateformat(name);
             }
            function setCaretPosition(ctrl, pos){//设置光标位置函数
                    if(ctrl.setSelectionRange)
                    {
                            ctrl.focus();
                            ctrl.setSelectionRange(pos,pos);
                    }
                    else if (ctrl.createTextRange) {
                            var range = ctrl.createTextRange();
                            range.collapse(true);
                            range.moveEnd('character', pos);
                            range.moveStart('character', pos);
                            range.select();
                    }
            }

             function datelimit90(name)
             {
                 
                 date1902(name);
                 var time=$(name).val();
                 //$(name).val("nowtime");
                 var myDate = new Date();
                // var nowtime=myDate.toLocaleDateString();
                 if(time.length==10)
                {
                    MM=time.substr(0,2);
                    DD=time.substr(3,2);
                    YY=time.substr(6,4);
                    YY_NOW=myDate.getFullYear(); 
                    MM_NOW=myDate.getMonth()+1;
                    DD_NOW=myDate.getDate();
                    if(MM_NOW<10){
                        MM_NOW='0'+MM_NOW;
                    }
                    if(DD_NOW<10){
                        DD_NOW='0'+DD_NOW;
                    }
                    nownomal=MM_NOW+'/'+DD_NOW+'/'+YY_NOW;
                    CurGetTime=new Date(YY,MM,DD);
                    NowGetTime=new Date(YY_NOW,MM_NOW,DD_NOW);
                    if(CurGetTime<NowGetTime){
                      $(name).val(nownomal);
                       // $(name).val();
                        if(name=='#date_of_next_followup'){
                          
                            check_change('date_of_next_followup');
                        }
                    }
                    //MM_NOW=10;
                    
                    DD_END=DD_NOW;
                    var YY_END;
                    if((parseInt(MM_NOW)+3)>12){
                        MM_END=(parseInt(MM_NOW)+3)%12;
                        YY_END=parseInt(YY_NOW)+1;
                    }else{
                        YY_END=YY_NOW;
                        MM_END=parseInt(MM_NOW)+3;
                    }
                    if(MM_END<10){
                        MM_END='0'+MM_END;
                    }
                    endnomal=MM_END+'/'+DD_END+'/'+YY_END;
                    EndGetTime=new Date(YY_END,MM_END,DD_END);
                    if(EndGetTime<CurGetTime){
                       $(name).val(endnomal);
                      
                       
                    }
                    

                }
                 
                 
             }
             function dateformat(name){
                  var time=$(name).val();
                  if(time.length<10&&time.length!=0){
                    var inputList = document.getElementsByTagName("input");
                    for(var i = 0;i<inputList.length;i++){
                        if(inputList[i].type=='submit'){
                            inputList[i].disabled="true";
                            inputList[i].style.background="url(<?php echo $this->baseUrl ?>/images/tab_bg_2.png)";
                        } 
                        
                    }
                  }else{
                   var inputList = document.getElementsByTagName("input");
                    for(var i = 0;i<inputList.length;i++){
                        if(inputList[i].type=='submit'){
                            inputList[i].removeAttribute("disabled");
                            //inputList[i].enable="true";
                            inputList[i].style.background="url(<?php echo $this->baseUrl ?>/images/tab_bg.png)";
                        } 
                        
                    }
                  
                  }
             }
             function dateupformat(name){
                     //dateformat(name);
                    var time=$(name).val();
                    var len_time=time.length;
                    // alert(time);
                    if(len_time<10&&len_time!=0)
                    {
                            $(name).css("border","4px solid red");
                            $(name).focus();
                    }else{
                            $(name).css("border"," 1px solid #aaa");
                    }
             }
           
             function dateofDOB(name){
                   date(name);
                 var time=$(name).val();
                  if(time.length==10){
                    
                    var index=0;
                    for(index=0;index<time.length;index++){
                       var cur=time.charAt(index) ;
                              if(cur<'0'||cur>'9'){
                               if(index==2||index==5){
                                   if(cur!='/'){
                                        time=time.substr(0,index)+time.substr(index+1,time.length-index-1);
                                        $(name).val(time);
                                         return;
                                   }
                               }else{
                                        //alert(cur);
                                        time=time.substr(0,index)+time.substr(index+1,time.length-index-1);
                                        $(name).val(time);
                                        tempname=name.substr(1,name.length-1);
                                        //alert(tempname);
                                        setCaretPosition(document.getElementById(tempname),index);
    
                                         return;
                                }
                              
                       }
                    }
                     
                }
                 //$(name).val("nowtime");
                 var myDate = new Date();
                // var nowtime=myDate.toLocaleDateString();
                 if(time.length==10)
                {
                    MM=time.substr(0,2);
                    DD=time.substr(3,2);
                    YY=time.substr(6,4);
                    YY_NOW=myDate.getFullYear(); 
                    MM_NOW=myDate.getMonth()+1;
                    DD_NOW=myDate.getDate();
                    if(MM_NOW<10){
                        MM_NOW='0'+MM_NOW;
                    }
                    if(DD_NOW<10){
                        DD_NOW='0'+DD_NOW;
                    }
                    nownomal=MM_NOW+'/'+DD_NOW+'/'+YY_NOW;
                    CurGetTime=new Date(YY,MM,DD);
                    NowGetTime=new Date(YY_NOW,MM_NOW,DD_NOW);
                    if(CurGetTime>NowGetTime){
                       // $(name).val(nownomal);
                        $(name).val();
                    }
                    
                    MM_Start=MM_NOW;
                    DD_Start=DD_NOW;
                    YY_Start=parseInt(YY_NOW)-110;
                    
                    startnomal=MM_Start+'/'+DD_Start+'/'+YY_Start;
                    StartGetTime=new Date(YY_Start,MM_Start,DD_Start);
                    if(StartGetTime>CurGetTime){
                       $(name).val(startnomal);
                    }
                }
             }
         </script>
        <script type="text/javascript" language="javascript" >
            /*function addtable3(){
                ++id3;
                var count3 = document.getElementById("count3");
                var patientPaymentTd = document.getElementById("patientPaymentTd");
                var patientPaymentDiv = document.getElementById("patientPaymentDiv");
                var patientPaymentTable = document.getElementById("patientPaymentTable");
                count3.value = id3;
                
                if(id3==1){
                    patientPaymentTd.style.display ="";
                    patientPaymentDiv.style.display = "";
                    patientPaymentDiv.style.height ="25px";
                }
                if(id3 ==2){
                    patientPaymentDiv.style.height = "50px";
                }
                if(id3 == 3){
                    patientPaymentDiv.style.height = "75px";
                }
                var newTr= patientPaymentTable.insertRow(0);
                newTr.id="tr"+id3+"";
                var newth1 = document.createElement("TH");
                var newtd1 = document.createElement("TD");
                var newth2 = document.createElement("TH");
                var newth3 = document.createElement("TH");
                if(navigator.userAgent.indexOf("MSIE")!=-1){
                    newth1.style.width="122px";
                    newth1.colspan=1;
                    newth2.style.width="124px";
                    newth3.style.width="117px";
                }else{
                    //newth1.style.width="130px";
                    newth1.style.width="13.8%";
                    newtd1.style.width="11%";
                    //newth1.colspan=1;
                    newth2.style.width="14%";
                    newth3.style.width="13.5%";
                }
                newth1.innerHTML ="Received Amount1";
                newth2.innerHTML ="Received Date";
                newth3.innerHTML ="Notes";
                newTr.appendChild(newth1,0);
                newTr.appendChild(newtd1,1);
                newTr.appendChild(newth2,2);
                newTr.appendChild(newth3,4);
                var newtd2 = newTr.insertCell(3);
                var newtd3 = newTr.insertCell(5);
                if(navigator.userAgent.indexOf("MSIE")!=-1){
                    newtd2.style.width="11%";
                }else{
                    newtd2.style.width="11%";
                    newtd3.colspan = 3;
                }
                //newtd1.style.width="11%";
               
                newtd3.innerHTML ="<input type=\"text\" name=\"notes_patient_payment_"+id3+"\" id=\"notes_patient_payment_"+id3+"\" onblur=\"javascript:dollorchange(\'#notes_patient_payment_"+id3+"\') style=\"width:99%\"/>";
                newtd2.innerHTML ="<input type=\"text\" name=\"date_patient_payment_received_"+id3+"\" id=\"date_patient_payment_received_"+id3+"\" onkeyup=\"javascript:date1902(\'#date_patient_payment_received_"+id3+"\')\"/>";
                newtd1.innerHTML ="<input type=\"text\" name=\"amount_patient_payment_received_"+id3+"\" id=\"amount_patient_payment_received_"+id3+"\" onkeyup=\"javascript:dollorformate('#amount_patient_payment_received_"+id3+"\')\" onblur=\"javascript:paymentreceived2("+id3+")\" />";               
        
            }*/
        </script>
        <script type="text/javascript" language="javascript" >
            /*function deletetable3(){
                var patientPaymentDiv = document.getElementById("patientPaymentDiv");
                var patientPaymentTd = document.getElementById("patientPaymentTd");
                var count3 = document.getElementById("count3");
                if(id3>1){
                    
                    var theDeleTr = document.getElementById("tr"+id3+"");
                    
                    theDeleTr.parentNode.removeChild(theDeleTr);
                    --id3;
                    paymentreceived2(id3);
                    count3.value = id3;
               
                    if(id3 ==1){
                        patientPaymentDiv.style.height ="25px";
                    }
                    if(id3 == 2){
                        patientPaymentDiv.style.height = "50px";
                    }
                    if(id3 == 3){
                        patientPaymentDiv.style.height ="75px";
                    }
                }
            } */
        </script>
        <script type="text/javascript" language="javascript" >
            
            /*function addtable4(){
                billerId = billerId +1;
                var count4 = document.getElementById("count4");
                var billerAdjustmentTd = document.getElementById("billerAdjustmentTd");
                var billerAdjustmentDiv = document.getElementById("billerAdjustmentDiv");
                var billerAdjustmentTable = document.getElementById("billerAdjustmentTable");
                count4.value = billerId;
                
                if(billerId==1){
                    billerAdjustmentTd.style.display ="";
                    billerAdjustmentDiv.style.display = "";
                    billerAdjustmentDiv.style.height ="25px";
                }
                if(billerId ==2){
                    billerAdjustmentDiv.style.height = "50px";
                }
                if(billerId == 3){
                    billerAdjustmentDiv.style.height = "75px";
                }
                var newTr= billerAdjustmentTable.insertRow(0);
                newTr.id="tr"+billerId+"";
                var newth1 = document.createElement("TH");
                var newtd1 = document.createElement("TD");
                var newth2 = document.createElement("TH");
                var newth3 = document.createElement("TH");
                if(navigator.userAgent.indexOf("MSIE")!=-1){
                    newth1.style.width="122px";
                    newth1.colspan=1;
                    newth2.style.width="124px";
                    newth3.style.width="117px";
                }else{                   
                    newth1.style.width="13.8%";
                    //newth1.colspan=1;
                    newtd1.style.width="11%";
                    newth2.style.width="14%";
                    newth3.style.width="13.5%";
                }
                newth1.innerHTML ="Adjustment Amount";
                newth2.innerHTML ="Adjustment Date";
                newth3.innerHTML ="Notes";
                newTr.appendChild(newth1,0);
                newTr.appendChild(newtd1,1);
                newTr.appendChild(newth2,2);
                newTr.appendChild(newth3,4);
                var newtd2 = newTr.insertCell(3);
                var newtd3 = newTr.insertCell(5);
                if(navigator.userAgent.indexOf("MSIE")!=-1){
                    newtd2.style.width="139px";
                }else{
                    newtd2.style.width="11%";
                    newtd3.colspan = 3;
                }
                //newtd1.style.width="130px";
               
                newtd3.innerHTML ="<input type=\"text\" name=\"notes_biller_adjustment_"+billerId+"\" id=\"notes_biller_adjustment_"+billerId+"\" style=\"width:99%\"/>";
                newtd2.innerHTML ="<input type=\"text\" name=\"date_biller_adjustment_"+billerId+"\" id=\"date_biller_adjustment_"+billerId+"\" onkeyup=\"javascript:date1902(\'#date_patient_payment_received_"+billerId+"\')\"/>";
                newtd1.innerHTML ="<input type=\"text\" name=\"amount_biller_adjustment_"+billerId+"\" id=\"amount_biller_adjustment_"+billerId+"\" onkeyup=\"javascript:dollorformate('#amount_biller_adjustment_"+billerId+"\')\" onblur=\"javascript:paymentreceived3("+billerId+")\" />";               
        
            }*/
        </script>
        <script type="text/javascript" language="javascript" >
            /*function deletetable4(){
                var billerAdjustmentTd = document.getElementById("billerAdjustmentTd");
                var billerAdjustmentDiv = document.getElementById("billerAdjustmentDiv");
                var count4 = document.getElementById("count4");
                if(billerId>1){
                    
                    var theDeleTr = document.getElementById("tr"+billerId+"");
                    
                    theDeleTr.parentNode.removeChild(theDeleTr);
                    --billerId;
                    paymentreceived3(billerId);
                    count4.value = billerId;
                 
                    if(billerId ==1){
                        billerAdjustmentDiv.style.height ="25px";
                    }
                    if(billerId == 2){
                        billerAdjustmentDiv.style.height = "50px";
                    }
                    if(billerId == 3){
                        billerAdjustmentDiv.style.height ="75px";
                    }
                }
            }*/ 
        </script>
<script type="text/javascript" language="javascript" >
            
            function addtable5(){
                interactionlogId = interactionlogId +1;
                var count5 = document.getElementById("count5");
                var interactionlogTd = document.getElementById("interactionlogTd");
                var interactionlogDiv = document.getElementById("interactionlogDiv");
                var interactionlogTable = document.getElementById("interactionlogTable");
                count5.value = interactionlogId;
                
                if((patientlogId+interactionlogId)==1){
                    interactionlogTd.style.display ="";
                    interactionlogDiv.style.display = "";
                    interactionlogDiv.style.height ="25px";
                }
                if((patientlogId+interactionlogId) ==2){
                    interactionlogDiv.style.height = "50px";
                }
                if((patientlogId+interactionlogId) == 3){
                    interactionlogDiv.style.height = "75px";
                }
                if((patientlogId+interactionlogId) == 4){
                interactionlogDiv.style.height = "100px";
            }
            if((patientlogId+interactionlogId) == 5){
                interactionlogDiv.style.height = "125px";
            }
            if((patientlogId+interactionlogId) == 6){
                interactionlogDiv.style.height = "150px";
            }
            if((patientlogId+interactionlogId) == 7){
                interactionlogDiv.style.height = "175px";
            }
            if((patientlogId+interactionlogId) == 8){
                interactionlogDiv.style.height = "200px";
            }
            if((patientlogId+interactionlogId) == 9){
                interactionlogDiv.style.height = "225px";
            }
            if((patientlogId+interactionlogId) == 10){
                interactionlogDiv.style.height = "250px";
            }
                var newTr= interactionlogTable.insertRow(0);
                newTr.id="tr"+interactionlogId+"";
                var newth1 = document.createElement("TH");
                var newtd1 = document.createElement("TD");
                var newth2 = document.createElement("TH");
                if(navigator.userAgent.indexOf("MSIE")!=-1){
                    newth1.style.width="122px";
                    newth1.colspan=1;
                    newth2.style.width="124px";
                }else{
                    newth1.style.width="13.8%";
                    newtd1.style.width="11%";
                    //newth1.colspan=1;
                    newth2.style.width="14%";
                }
                newth1.innerHTML ="Date And Time";
                newth2.innerHTML ="Log";
                newTr.appendChild(newth1,0);
                newTr.appendChild(newtd1,1);
                newTr.appendChild(newth2,2);
                var newtd2 = newTr.insertCell(3);
                if(navigator.userAgent.indexOf("MSIE")!=-1){
                    newtd2.style.width="999px";
                }else{
                    newtd2.style.width="70%";
                    newtd2.colspan = 5;
                }
                //newtd1.style.width="130px";
                //newtd3.style.width="14%";
                var newtd3 = document.createElement("TD");
                newtd3.style.display="none";
                newTr.appendChild(newtd3,4);
                newtd3.innerHTML ="<input type=\"text\" name=\"date_and_time_real_"+interactionlogId+"\" id=\"date_and_time_real_"+interactionlogId+"\">";
                newtd1.innerHTML ="<input type=\"text\" name=\"date_and_time_"+interactionlogId+"\" id=\"date_and_time_"+interactionlogId+"\" onkeyup=\"javascript:dateandtime(\'#date_and_time_"+interactionlogId+"\')\" onfocus=\"javascript:dateandtimefocus("+interactionlogId+");myischanged()\"/>";
                newtd2.innerHTML ="<input type=\"text\" name=\"log_"+interactionlogId+"\" id=\"log_"+interactionlogId+"\" style=\"width:99%\"/>";               
        
            }
        </script>
    <script type="text/javascript" language="javascript">
        function addtable6(){
            patientlogId = patientlogId +1;
            var interactionlogTd = document.getElementById("interactionlogTd");
            var interactionlogDiv = document.getElementById("interactionlogDiv");
            var interactionlogTable = document.getElementById("interactionlogTable");
            

            if((patientlogId+interactionlogId)==1){
                interactionlogTd.style.display ="";
                interactionlogDiv.style.display = "";
                interactionlogDiv.style.height ="25px";
            }
            if((patientlogId+interactionlogId)==2){
                interactionlogDiv.style.height = "50px";
            }
            if((patientlogId+interactionlogId) == 3){
                interactionlogDiv.style.height = "75px";
            }
            if((patientlogId+interactionlogId) == 4){
                interactionlogDiv.style.height = "100px";
            }
            if((patientlogId+interactionlogId) == 5){
                interactionlogDiv.style.height = "125px";
            }
            if((patientlogId+interactionlogId) == 6){
                interactionlogDiv.style.height = "150px";
            }
            if((patientlogId+interactionlogId) == 7){
                interactionlogDiv.style.height = "175px";
            }
            if((patientlogId+interactionlogId) == 8){
                interactionlogDiv.style.height = "200px";
            }
            if((patientlogId+interactionlogId) == 9){
                interactionlogDiv.style.height = "225px";
            }
            if((patientlogId+interactionlogId) == 10){
                interactionlogDiv.style.height = "250px";
            }
            var newTr= interactionlogTable.insertRow(0);
            newTr.id="tr_patient"+patientlogId+"";
            var newth1 = document.createElement("TH");
            var newtd1 = document.createElement("TD");
            var newth2 = document.createElement("TH");
            if(navigator.userAgent.indexOf("MSIE")!=-1){
                newth1.style.width="122px";
                newth1.colspan=1;
                newth2.style.width="124px";
            }else{
                newth1.style.width="13.8%";
                newtd1.style.width="11%";
                //newth1.colspan=1;
                newth2.style.width="14%";
            }
            newth1.innerHTML ="Date And Time";
            newth2.innerHTML ="Log";
            newTr.appendChild(newth1,0);
            newTr.appendChild(newtd1,1);
            newTr.appendChild(newth2,2);
            var newtd2 = newTr.insertCell(3);
            if(navigator.userAgent.indexOf("MSIE")!=-1){
                newtd2.style.width="999px";
            }else{
                newtd2.style.width="70%";
                newtd2.colspan = 5;
            }
            var newtd3 = document.createElement("TD");
            newtd3.style.display="none";
            newTr.appendChild(newtd3,4);
            //newtd1.style.width="130px";
            //newtd3.style.width="14%";
            newtd3.innerHTML ="<input type=\"text\" name=\"patient_date_and_time_real_"+patientlogId+"\" id=\"patient_date_and_time_real_"+patientlogId+"\">";
            newtd1.innerHTML ="<input type=\"text\" name=\"patient_date_and_time_"+patientlogId+"\" id=\"patient_date_and_time_"+patientlogId+"\" />";
            newtd2.innerHTML ="<input type=\"text\" name=\"patient_log_"+patientlogId+"\" id=\"patient_log_"+patientlogId+"\" style=\"width:99%\"/>";               

        }
    </script>
        <script type="text/javascript" language="javascript" >
            function deletetable5   (){
                var interactionlogTd = document.getElementById("interactionlogTd");
                var interactionlogDiv = document.getElementById("interactionlogDiv");
                var count5 = document.getElementById("count5");
                if(interactionlogId>1){
                    
                    var theDeleTr = document.getElementById("tr"+interactionlogId+"");
                    
                    theDeleTr.parentNode.removeChild(theDeleTr);
                    --interactionlogId;
                    paymentreceived3(interactionlogId);
                    count5.value = interactionlogId;
                 
                    if(interactionlogId ==1){
                        interactionlogDiv.style.height ="25px";
                    }
                    if(interactionlogId == 2){
                        interactionlogDiv.style.height = "50px";
                    }
                    if(interactionlogId == 3){
                        interactionlogDiv.style.height ="75px";
                    }
                }
            } 
        </script>
 <script type="text/javascript" language="javascript">
            function check(){
                var role = "<?php echo $this->role ?>";
                if(role=="guest"){
                var selectList = document.getElementsByTagName("select");
                var inputList = document.getElementsByTagName("input");
                 var textList = document.getElementsByTagName("textarea");
                    for(var i=0;i<textList.length;i++){
                        textList[i].disabled = false;
                    }
                for(var i = 0;i<inputList.length;i++){
//                    if(inputList[i].type=='checkbox'||inputList[i].type=='radio'||inputList[i].type=='button')
                        inputList[i].disabled=false;
                }
                for(var i =0;i<selectList.length;i++){
                    selectList[i].disabled=false;
                }
                }
            }
    
        </script>
<script type="text/javascript" language="javascript">
    function myischanged(){
       // alert(1);
       var id=0;
      document.getElementById('ischanged').style.display="";
       $.get("<?php echo $this->baseUrl ?>/biller/claims/needsave/",
             function(date){
       });
    }
</script>
<script type="text/javascript" language="javascript">
    function set_custom_value_input(num){
       if(num == "1"){
           var tp_custom = $("#custom_1_input").val();
           $("#custom_1").val(tp_custom);
       }
       if(num == "2"){
           var tp_custom = $("#custom_2_input").val();
//           alert(tp_custom);
           $("#custom_2").val(tp_custom);
       }
       if(num == "3"){
           var tp_custom = $("#custom_3_input").val();
           $("#custom_3").val(tp_custom);
       }
       if(num == "4"){
           var tp_custom = $("#custom_4_input").val();
           $("#custom_4").val(tp_custom);
       }
    }
</script>
<script type="text/javascript" language="javascript">
    function set_custom_value_select(num){
 
        if(num == "1"){
           var tp_custom = $("#custom_1_select").val();
           $("#custom_1").val(tp_custom);
       }
       if(num == "2"){
           var tp_custom = $("#custom_2_select").val();
           $("#custom_2").val(tp_custom);
       }
       if(num == "3"){
           var tp_custom = $("#custom_3_select").val();
           $("#custom_3").val(tp_custom);
       }
       if(num == "4"){
           var tp_custom = $("#custom_4_select").val();
           $("#custom_4").val(tp_custom);
       }
    }
</script>
<script type="text/javascript" language="javascript">
    function check_change(type){
   
        var biller = $("#billername").val();
        var time = showtime();
        var real_time = realtime();
        var new_claim_flag = $("#new_claim_flag").val();
        if (new_claim_flag!=1 &&new_claim_flag!='1'){
            //alert(1);            
            if(type=="bill_status"||type=="date_insurance_payment_issued"||type=="amount_insurance_payment_issued"||type=="date_negotiated_amount_reached"||type=="negotiated_payment_amount"||type=="date_initial_offer"||type=="amount_initial_offer"||type=="date_closed"||type=="date_billed"||type=="date_last_billed"||type=="date_creation"||type=="date_secondary_insurance_billed"||type=="date_of_next_followup"||type=="expected_payment"||type=="balance_due"||type=="amount_paid"||type=="total_charge"){       
                var trans ={"bill_status":"Bill Status","total_charge": "Total Charge","amount_paid":"Amount Paid","balance_due":"Balance Due","expected_payment":"Payment Expected","date_of_next_followup":"Next Follow-up Date","date_secondary_insurance_billed":"Date Secondary Insurance Billed","date_creation":"Date Bill Created","date_billed":"Date Billed","date_last_billed":"Date Last Billed","date_closed":"Date Closed","amount_initial_offer":"Proposed Amount","date_initial_offer":"Proposal Date","negotiated_payment_amount":"Agreed Amount","date_negotiated_amount_reached":"Agreement Date","amount_insurance_payment_issued":"Issued Amount","date_insurance_payment_issued":"Issued Date","is_the_issued_payment_sent_to_patient":"Send To Patient?"};
                if(type=="amount_initial_offer"||type=="date_initial_offer"||type=="negotiated_payment_amount"||type=="date_negotiated_amount_reached"||type=="amount_insurance_payment_issued"||type=="date_insurance_payment_issued"){
                    if(type=="amount_initial_offer"||type=="date_initial_offer"){
                        last_amount = $("#last_amount_initial_offer").val();
                        cur_amount = $("#amount_initial_offer").val();
                        last_date = $("#last_date_initial_offer").val();
                        cur_date = $("#date_initial_offer").val();
                        last = last_amount + ' | ' + last_date;
                        cur = cur_amount + ' | ' + cur_date;
                        if(last != cur){
                            if(last_amount =='' || last_amount == null){
                                var log = biller + ': Added Proposed ' + cur;
                            }else if(cur_amount =='' || cur_amount == null){
                                var log = biller + ": Removed Proposed " + last;
                            }else{
                                var log = biller + ": Changed Proposed from " +last + " to " + cur;
                            }
                            addlog(time,biller,log,real_time);
                            $("#last_amount_initial_offer").val(cur_amount);
                            $("#last_date_initial_offer").val(cur_date);
                        }
                    }
                    if(type=="negotiated_payment_amount"||type=="date_negotiated_amount_reached"){
                        last_amount = $("#last_negotiated_payment_amount").val();
                        cur_amount = $("#negotiated_payment_amount").val();
                        last_date = $("#last_date_negotiated_amount_reached").val();
                        cur_date = $("#date_negotiated_amount_reached").val();
                        last = last_amount + ' | ' + last_date;
                        cur = cur_amount + ' | ' + cur_date;
                        if(last != cur){
                            if(last_amount =='' || last_amount == null){
                                var log = biller + ': Added Agreement ' + cur;
                            }else if(cur_amount =='' || cur_amount == null){
                                var log = biller + ": Removed Agreement " + last;
                            }else{
                                var log = biller + ": Changed Agreement " +last + " to " + cur;
                            }
                            addlog(time,biller,log,real_time);
                            $("#last_negotiated_payment_amount").val(cur_amount);
                            $("#last_date_negotiated_amount_reached").val(cur_date);
                        }
                    }
                    if(type=="amount_insurance_payment_issued"||type=="date_insurance_payment_issued"){
                        last_amount = $("#last_amount_insurance_payment_issued").val();
                        cur_amount = $("#amount_insurance_payment_issued").val();
                        last_date = $("#last_date_insurance_payment_issued").val();
                        cur_date = $("#date_insurance_payment_issued").val();
                        var box = document.getElementById("is_the_issued_payment_sent_to_patient");
                        var state = box.checked?"true":"false";
                        last = last_amount + ' | ' + last_date + ' | ' +state;
                        cur = cur_amount + ' | ' + cur_date  + ' | ' +state;
                        if(last != cur){
                            if(last_amount =='' || last_amount == null){
                                var log = biller + ': Added Payment Issurance ' + cur;
                            }else if(cur_amount =='' || cur_amount == null){
                                var log = biller + ": Removed Payment Issurance " + last;
                                //box.checked = false;
                            }else{
                                var log = biller + ": Changed Payment Issurance " +last + " to " + cur;
                            }
                            addlog(time,biller,log,real_time);
                            $("#last_amount_insurance_payment_issued").val(cur_amount);
                            $("#last_date_insurance_payment_issued").val(cur_date);
                        }
                    }
                    
                    if (type =='is_the_issued_payment_sent_to_patient'){
                        last_amount = $("#last_amount_insurance_payment_issued").val();
                        cur_amount = $("#amount_insurance_payment_issued").val();
                        last_date = $("#last_date_insurance_payment_issued").val();
                        cur_date = $("#date_insurance_payment_issued").val();
                        var box = document.getElementById("is_the_issued_payment_sent_to_patient");
                        var cur_state = box.checked?"true":"false";
                        var last_state = box.checked?"false":"true";
                        last = last_amount + ' | ' + last_date + ' | ' +last_state;
                        cur = cur_amount + ' | ' + cur_date  + ' | ' + cur_state;
                        if(cur_amount == '' || cur_amount==null){
                            box.checked = box.checked?false:true;
                            alert("No Issued Amount Now!");
                        }else{
                            var log= biller + ": Changed Payment Issurance " +last + " to " + cur;
                            addlog(time,biller,log,real_time);
                        }
                    }
                    
                }else{
                   
                    var last_name = '#last_' + type;
                    var cur_name = '#'+type;
                    var last = $(last_name).val();
                    var cur = $(cur_name).val();
                    if(last != cur){
                        $(last_name).val(cur);
                        if(last==''||last==null){
                            var log = biller + ': Added ' + trans[type]  + ' ' + cur;
                        }else if(cur == '' || cur == null){
                            var log = biller + ': Removed ' + trans[type]  + ' ' + last;
                        }else{
                            var log = biller + ': Changed ' + trans[type]  + ' from ' + last + ' to ' + cur;
                        }
                        $(last_name).val(cur);
                        addlog(time,biller,log,real_time);
                    }
                }
            }
            if(type=="EOB_allowed_amount"||type=="EOB_not_allowed_amount"||type=="EOB_co_insurance"||type=="EOB_deductable"||type=="EOB_reduction"||type=="EOB_other_reduction"||type=="EOB_adjustment_reason"){
                var last_allowed_amount = $("#last_EOB_allowed_amount").val();
                var cur_allowed_amount = $("#EOB_allowed_amount").val();
                var last_not_allowed_amount = $("#last_EOB_not_allowed_amount").val();
                var cur_not_allowed_amount = $("#EOB_not_allowed_amount").val();
                var last_co_insurance = $("#last_EOB_co_insurance").val();
                var cur_co_insurance = $("#EOB_co_insurance").val();
                var last_deductable = $("#last_EOB_deductable").val();
                var cur_deductable = $("#EOB_deductable").val();
                var last_reduction = $("#last_EOB_reduction").val();
                var cur_reduction = $("#EOB_reduction").val();
                var last_other_reduction = $("#last_EOB_other_reduction").val();
                var cur_other_reduction = $("#EOB_other_reduction").val();
                var last_adjustment_reason = $("#last_EOB_adjustment_reason").val();
                var cur_adjustment_reason = $("#EOB_adjustment_reason").val();
                var last = last_allowed_amount + ' | ' + last_not_allowed_amount + ' | ' + last_co_insurance + ' | ' + last_deductable + ' | ' + last_reduction + ' | ' + last_other_reduction + ' | ' + last_adjustment_reason;
                var cur = cur_allowed_amount + ' | ' + cur_not_allowed_amount + ' | ' + cur_co_insurance + ' | ' + cur_deductable + ' | ' + cur_reduction + ' | ' + cur_other_reduction + ' | ' + cur_adjustment_reason;
                var flag_tmp = 1;
                if(last != cur){
                    if(last_allowed_amount==null || last_allowed_amount==''){
                        if(cur_allowed_amount!=null && cur_allowed_amount!=''){
                            var log = biller +　": Added EOB: " + cur;
                            flag_tmp = 0;
                        }
                        /*else{
                            $("#last_EOB_allowed_amount").val(cur_allowed_amount);
                            $("#last_EOB_not_allowed_amount").val(cur_not_allowed_amount);
                            $("#last_EOB_co_insurance").val(cur_co_insurance);
                            $("#last_EOB_deductable").val(cur_deductable);
                            $("#last_EOB_reduction").val(cur_reduction);
                            $("#last_EOB_other_reduction").val(cur_other_reduction);
                            $("#last_EOB_adjustment_reason").val(cur_adjustment_reason);
                            alert("Please Input Allowed Amount First!");
                        }*/
                    }else{
                        if(cur_allowed_amount==null || cur_allowed_amount==''){
                            var log = biller + ": Removed EOB: " + last;
                            flag_tmp = 0;
                        }else{
                            //alert(flag);
                            var log = biller + ": Changed EOB from " + last + " to " + cur;
                            flag_tmp = 0;
                        }
                    }
                    if(flag_tmp == 0){
                        addlog(time,biller,log,real_time);
                        $("#last_EOB_allowed_amount").val(cur_allowed_amount);
                        $("#last_EOB_not_allowed_amount").val(cur_not_allowed_amount);
                        $("#last_EOB_co_insurance").val(cur_co_insurance);
                        $("#last_EOB_deductable").val(cur_deductable);
                        $("#last_EOB_reduction").val(cur_reduction);
                        $("#last_EOB_other_reduction").val(cur_other_reduction);
                        $("#last_EOB_adjustment_reason").val(cur_adjustment_reason);
                   }
                }
            }
            if(type=='benefit'){
                var cur_benefit_OOP = $("#benefit_OOP").val();
                var last_benefit_OOP = $("#last_benefit_OOP").val();
                var cur_benefit_OOP_remaining = $("#benefit_OOP_remaining").val();
                var last_benefit_OOP_remaining = $("#last_benefit_OOP_remaining").val();
                var cur_benefit_deductible = $("#benefit_deductible").val();
                var last_benefit_deductible = $("#last_benefit_deductible").val();
                var cur_benefit_co_insurance = $("#benefit_co_insurance").val();
                var last_benefit_co_insurance = $("#last_benefit_co_insurance").val();
                var cur_benefit_date_taken = $("#benefit_date_taken").val();
                var last_benefit_date_taken = $("#last_benefit_date_taken").val();
                var box = document.getElementById("innetwork");
                var cur_in_network = box.checked?"true":"false";
                var last_in_network = cur_in_network;
                var last = last_benefit_OOP + ' | ' + last_benefit_OOP_remaining + ' | ' + last_benefit_deductible + ' | ' + last_benefit_co_insurance + ' | ' + last_benefit_date_taken + ' | ' + last_in_network;
                var cur = cur_benefit_OOP + ' | ' + cur_benefit_OOP_remaining + ' | ' + cur_benefit_deductible + ' | ' + cur_benefit_co_insurance + ' | ' + cur_benefit_date_taken + ' | ' + cur_in_network;
                var flag =1;
                if(last != cur){
                    if (last_benefit_OOP == null || last_benefit_OOP == ''){
                         if(cur_benefit_OOP !=null && cur_benefit_OOP !=''){
                            var log = biller +　": Added Benefits: " + cur;
                            flag = 0;
                        }
                    }else{
                        if(cur_benefit_OOP ==null || cur_benefit_OOP ==''){
                            var log = biller + ": Removed Benefits: " + last;
                            flag = 0;
                        }else{
                            if(last!=cur){
                                var log = biller + ": Changed Benefits from " + last + " to " + cur;
                                flag = 0;
                            }
                        }
                    }
                    if(flag == 0){
                        addlog(time,biller,log,real_time);
                        $("#last_benefit_OOP").val(cur_benefit_OOP);
                        $("#last_benefit_OOP_remaining").val(cur_benefit_OOP_remaining);
                        $("#last_benefit_deductible").val(cur_benefit_deductible);
                        $("#last_benefit_co_insurance").val(cur_benefit_co_insurance);
                        $("#last_benefit_date_taken").val(cur_benefit_date_taken);
                    }
                }
            }
            if(type=='benefit_innetwork'){
                var cur_benefit_OOP = $("#benefit_OOP").val();
                var last_benefit_OOP = $("#last_benefit_OOP").val();
                var cur_benefit_OOP_remaining = $("#benefit_OOP_remaining").val();
                var last_benefit_OOP_remaining = $("#last_benefit_OOP_remaining").val();
                var cur_benefit_deductible = $("#benefit_deductible").val();
                var last_benefit_deductible = $("#last_benefit_deductible").val();
                var cur_benefit_co_insurance = $("#benefit_co_insurance").val();
                var last_benefit_co_insurance = $("#last_benefit_co_insurance").val();
                var cur_benefit_date_taken = $("#benefit_date_taken").val();
                var last_benefit_date_taken = $("#last_benefit_date_taken").val();
                var box = document.getElementById("innetwork");
                var cur_in_network = box.checked?"true":"false";
                var last_in_network = box.checked?"false":"true";
                var last_state = box.checked?false:true;
                var last = last_benefit_OOP + ' | ' + last_benefit_OOP_remaining + ' | ' + last_benefit_deductible + ' | ' + last_benefit_co_insurance + ' | ' + last_benefit_date_taken + ' | ' + last_in_network;
                var cur = cur_benefit_OOP + ' | ' + cur_benefit_OOP_remaining + ' | ' + cur_benefit_deductible + ' | ' + cur_benefit_co_insurance + ' | ' + cur_benefit_date_taken + ' | ' + cur_in_network;
                if (cur_benefit_OOP == null || cur_benefit_OOP == ''){
                     box.checked = last_state;
                     alert("Please Input OOP First!");
                }else{
                    var log = biller + ": Changed Benefits from " + last + " to " + cur;
                    addlog(time,biller,log,real_time);
                    $("#last_benefit_OOP").val(cur_benefit_OOP);
                    $("#last_benefit_OOP_remaining").val(cur_benefit_OOP_remaining);
                    $("#last_benefit_deductible").val(cur_benefit_deductible);
                    $("#last_benefit_co_insurance").val(cur_benefit_co_insurance);
                    $("#last_benefit_date_taken").val(cur_benefit_date_taken);   
                }
            }
           
            if(type=="1"||type=='2'||type=='3'||type=='4'){
                
                var tag_name_id = "#last_custom_label_" + type;//组合成 id 供下面jQuery 调用
                var tag_name = $(tag_name_id).val();//获取 last_custom_label 对象,获得的是label对象,获取这个 label 是没有用的啊
                var last_id = "#last_custom_" + type;//上一次该区域的值
                var cur_id = "#custom_" + type;//当前 id
//                alert(cur_id);
                var last_val = $(last_id).val();
                var cur_val = $(cur_id).val();
                if(last_val != cur_val){  //旧的不等于新的
                        if(last_val ==''|| last_val ==null){
                            var log = biller + ': Added custom_' +   type + ' ' +  cur_val;
                        }else if(cur_val == '' || cur_val == null){
                            var log = biller + ': Removed custom_' + type  + ' ' + last_val;
                        }else{
                            var log = biller + ': Changed custom_' + type  + ' from ' + last_val + ' to ' + cur_val;
                        }
                        $(last_id).val(cur_val);
                        addlog(time,biller,log,real_time);
                    }
            }
        }
        myischanged();
    }
</script>
<script type="text/javascript" language="javascript">
    function getPaymentFrom(){
        var paymentFrom = $("#paymentFrom").val();
        var paymentFromList = paymentFrom.split('|');
        return paymentFromList;
    }
    function getInsuranceFrom(){
        var insuranceFrom =$("#insuranceFrom").val();
        var insuranceFromList = insuranceFrom.split('|');
        return insuranceFromList;
    }
</script>
<script type="text/javascript" language="javascript">
    function addtable7(EOB_or_total,NoO){
        paymentId = paymentId +1;
        paymentIdReal = paymentIdReal+1;
        var count_payment = document.getElementById("count_payment");
        var paymentTd = document.getElementById("paymentTd");
        var paymentDiv = document.getElementById("paymentDiv");
        var paymentTable = document.getElementById("paymentTable");
        count_payment.value = paymentId;

        if((paymentId+eobTableLines)==1){
            paymentTd.style.display ="";
            paymentDiv.style.display = "";
            paymentDiv.style.height ="25px";
        }
        if((paymentId+eobTableLines)==2){
            paymentDiv.style.height = "50px";
        }
        if((paymentId+eobTableLines)==3){
            paymentDiv.style.height = "75px";
        }
        if((paymentId+eobTableLines)==4){
            paymentDiv.style.height = "100px";
        }
        if((paymentId+eobTableLines)==5){
            paymentDiv.style.height = "125px";
        }
        if((paymentId+eobTableLines)==6){
            paymentDiv.style.height = "150px";
        }
        if((paymentId+eobTableLines)==7){
            paymentDiv.style.height = "175px";
        }
        if((paymentId+eobTableLines)==8){
            paymentDiv.style.height = "200px";
        }
        if((paymentId+eobTableLines)==9){
            paymentDiv.style.height = "225px";
        }
        if((paymentId+eobTableLines)==10){
            paymentDiv.style.height = "250px";
        }
        var newTr= paymentTable.insertRow(0);
        newTr.id="tr_payment_"+paymentId+"";
        var newtd_ext = document.createElement("TD");
        var newth1 = document.createElement("TH");
        var newth2 = document.createElement("TH");
        var newth3 = document.createElement("TH");
        var newth4 = document.createElement("TH");
        var newth5 = document.createElement("TH");
        var newtd1 = document.createElement("TD");
        var newtd2 = document.createElement("TD");
        var newtd3 = document.createElement("TD");
        var newtd4 = document.createElement("TD");
        var newtd5 = document.createElement("TD");
        var newtd6 = document.createElement("TD");
        var newtd7 = document.createElement("TD");
        var newtd_type = document.createElement("TD");
        newtd_ext.style.width = "5%";
        newth1.style.width = "10%";
        newth2.style.width = "10%";
        newth3.style.width = "10%";
        newth4.style.width = "10%";
        newth5.style.width = "10%";
        newtd1.style.width = "9%";
        newtd2.style.width = "9%";
        newtd3.style.width = "9%";
        newtd4.style.width = "9%";
        newtd5.style.width = "9%";
        newth1.innerHTML ="Amount";
        newth2.innerHTML ="Date and Time";
        newth3.innerHTML ="From";
        newth4.innerHTML ="Notes";
        newth5.innerHTML = "Internal Notes";
        newTr.appendChild(newtd_ext,0);
        newTr.appendChild(newth1,1);
        newTr.appendChild(newtd1,2);
        newTr.appendChild(newth2,3);
        newTr.appendChild(newtd2,4);
        newTr.appendChild(newth3,5);
        newTr.appendChild(newtd3,6);
        newTr.appendChild(newth4,7);
        newTr.appendChild(newtd4,8);
        newTr.appendChild(newth5,9);
        newTr.appendChild(newtd5,10);
        newTr.appendChild(newtd6,11);
        newTr.appendChild(newtd7,12);
        newTr.appendChild(newtd_type,13);
        if(NoO=="new"){
            newtd_ext.innerHTML="<button style='width:30px' type='button' onclick=\"expand("+paymentId+",this);\" >+</button>";
        }
        if(NoO=="old"&&EOB_or_total=="EOB"){
            newtd_ext.innerHTML="<button style='width:30px' type='button' onclick=\"eobarea("+paymentId+",this)\" >+</button>";
        }
        if(NoO=="old"&&EOB_or_total=="total"){
            newtd_ext.innerHTML="<button style='width:30px' type='button' onclick=\"eobarea("+paymentId+",this)\" >+</button>";
        }
        newtd1.innerHTML ="<input type=\"text\" name=\"payment_amount_"+paymentId+"\" id=\"payment_amount_"+paymentId+"\"   onkeyup=\"javascript:dollorformate('#payment_amount_"+paymentId+"')\" onchange=\"javascript:change_payment(" + paymentId+");calculate_all();myischanged();\" onblur=\"javascript:dollorchange('#payment_amount_"+paymentId+"')\"/>";
        newtd2.innerHTML ="<input type=\"text\" name=\"payment_date_and_time_"+paymentId+"\" id=\"payment_date_and_time_"+paymentId+"\" onchange=\"javascript:myischanged()\" />";
        newtd3.innerHTML ="<select type=\"text\" name=\"payment_from_"+paymentId+"\" id=\"payment_from_"+paymentId+"\" style=\"width:80%;\" onchange=\"javascript:change_payment_from(this.id);calculate_all();myischanged();\"></select>" + "<input style=\"display:none;width:80%;\"  type=\"text\" name=\"payment_from_self_"+paymentId+"\" id=\"payment_from_self_"+paymentId+"\"  />";
        var payment_from = "#payment_from_" + paymentId;
        var text_0 = "<option value=\"\">" + "Select" + "</options>";
        $(payment_from).append(text_0);
        var text_1 = "<option value=\"Patient\">" + "Patient" + "</options>";
        var text_2 = "<option value=\"Biller Adjustment\">" + "Biller Adjustment" + "</options>";
        var text_3 = "<option value=\"Misc\">" + "Misc" + "</options>";
        $(payment_from).append(text_1);
        $(payment_from).append(text_2);
        $(payment_from).append(text_3);
        var payment_from_list = getPaymentFrom();
        var length = payment_from_list.length;
        for(var i=0;i<length;i++){
            if(payment_from_list[i]!='' && payment_from_list[i]!=null){
                var text = "<option value=\""+ payment_from_list[i]  +"\">" + payment_from_list[i] + "</options>";
                $(payment_from).append(text);
            }
        }
        var insurance_from_list = getInsuranceFrom();
        var length = insurance_from_list.length;
        for(var i=0;i<length;i++){
     //       if(insurance_from_list[i]!='' && insurance_from_list[i]!=null){
      if(insurance_from_list[i]!='' && insurance_from_list[i]!=null&&insurance_from_list[i]!='Self Pay'){
                var text = "<option value=\""+ insurance_from_list[i]  +"\">" + insurance_from_list[i] + "</options>";
                $(payment_from).append(text);
            }
        }
        //var text_1 = "<option value=\"Insurance\">" + "Insurance" + "</options>";
        newtd4.innerHTML ="<input type=\"text\" name=\"payment_notes_"+paymentId+"\" id=\"payment_notes_"+paymentId+"\" onchange=\"javascript:myischanged()\"/>";
        newtd5.innerHTML ="<input type=\"text\" name=\"payment_internal_notes_"+paymentId+"\" id=\"payment_internal_notes_"+paymentId+"\" onchange=\"javascript:myischanged()\" />";
        newtd_type.innerHTML = "<input style=\"display:none\" type=\"text\" name=\"payment_type_"+paymentId+"\" id=\"payment_type_"+paymentId+"\" value=\""+ EOB_or_total +"\"/>"
        newtd6.innerHTML ="<input style=\"display:none\" type=\"text\" name=\"payment_amount_positive_"+paymentId+"\" id=\"payment_amount_positive_"+paymentId+"\" />";
        newtd7.innerHTML ="<input style=\"display:none\" type=\"text\" name=\"payment_realnum_"+paymentId+"\" id=\"payment_realnum_"+paymentId+"\" value=\"" +paymentIdReal +"\"/>";
        newtd6.style.display ="none";
        newtd7.style.display ="none";
        newtd_type.style.display ="none";
        if(NoO=="new"){
            $("<tr></tr>").insertAfter("#tr_payment_"+paymentId).attr("id","tr_payment_eob_"+paymentId).css("display","none");
            $("<td></td>").appendTo("#tr_payment_eob_"+paymentId).attr("colspan",12).append("<table style=\"margin-left:30px;background-color:#EEE;\" id=\"payment_eob_"+paymentId+"\"></table>");
            //$("<table></table>").appendTo("#tr_payment_eob_"+paymentId).attr("id","payment_eob_"+paymentId);
            var eob_count = $("#service_count").val();
            for(var i = 1;i<=eob_count;i++){
                var eob_value = $("#service_"+i).val().split("|");
                //$("#payment_eob_"+paymentId).append("<tr style=\"background-color:#EEE;\" id=\"payment_service_"+paymentId+"_"+i+"\"><td width=\"80px\">Service "+i+"</td></tr>");
                $("#payment_eob_"+paymentId).append("<tr style=\"background-color:#EEE;\" id=\"payment_service_"+paymentId+"_"+i+"\"></tr>");
                $("#payment_service_"+paymentId+"_"+i).append("<td style=\"display:none;background-color:#EEE;\" ><input type=\"text\" name=\"service_"+paymentId+"_"+i+"_payment_id\" id=\"service_"+paymentId+"_"+i+"_payment_id\" /></td>");
                $("#payment_service_"+paymentId+"_"+i).append("<td style=\"background-color:#EEE;\" >CPT Code</td><td style=\"background-color:#EEE;\" ><input type=\"text\" name=\"service_"+paymentId+"_"+i+"_cptcode\" id=\"service_"+paymentId+"_"+i+"_cptcode\" value=\""+eob_value[0]+"\" onchange=\"javascript:myischanged()\"/></td>");
                $("#payment_service_"+paymentId+"_"+i).append("<td style=\"background-color:#EEE;\" >Charges</td><td style=\"background-color:#EEE;\" ><input type=\"text\" name=\"service_"+paymentId+"_"+i+"_charge\" id=\"service_"+paymentId+"_"+i+"_charge\" value=\""+eob_value[1]+"\" onkeyup=\"javascript:dollorformate('#service_"+paymentId+"_"+i+"_charge')\"  onblur=\"javascript:dollorchange('#service_"+paymentId+"_"+i+"_charge')\" onchange=\"javascript:right_format('#service_"+paymentId+"_"+i+"_charge');myischanged();\"/></td>");
                $("#payment_service_"+paymentId+"_"+i).append("<td style=\"background-color:#EEE;\" >Expected Pay</td><td style=\"background-color:#EEE;\" ><input type=\"text\" name=\"service_"+paymentId+"_"+i+"_expectedpay\" id=\"service_"+paymentId+"_"+i+"_expectedpay\" value=\""+eob_value[2]+"\" onkeyup=\"javascript:dollorformate('#service_"+paymentId+"_"+i+"_expectedpay')\" onblur=\"javascript:dollorchange('#service_"+paymentId+"_"+i+"_expectedpay')\"  onchange=\"javascript:right_format('#service_"+paymentId+"_"+i+"_expectedpay');myischanged();\"/></td>");
                $("#payment_service_"+paymentId+"_"+i).append("<td style=\"background-color:#EEE;\" >Payment Amount</td><td style=\"background-color:#EEE;\" ><input type=\"text\" name=\"service_"+paymentId+"_"+i+"_payment\" id=\"service_"+paymentId+"_"+i+"_payment\" onkeyup=\"javascript:dollorformate('#service_"+paymentId+"_"+i+"_payment')\" onblur=\"javascript:dollorchange('#service_"+paymentId+"_"+i+"_payment')\"  onchange=\"javascript:right_format('#service_"+paymentId+"_"+i+"_payment');calculatepayment("+paymentId+");change_payment(" + paymentId+");calculate_all();myischanged();\"/></td>");
            }
        }
        if(EOB_or_total=="EOB"&&NoO=="old"){
            $("<tr></tr>").insertAfter("#tr_payment_"+paymentId).attr("id","tr_payment_eob_"+paymentId).css("display","none");
            $("<td></td>").appendTo("#tr_payment_eob_"+paymentId).attr("colspan",12).append("<table style=\"margin-left:30px;background-color:#EEE;\" id=\"payment_eob_"+paymentId+"\"></table>");
            //$("<table></table>").appendTo("#tr_payment_eob_"+paymentId).attr("id","payment_eob_"+paymentId);
            var eob_count = $("#service_count").val();
            for(var i = 1;i<=eob_count;i++){
                var eob_value = $("#service_"+i).val().split("|");
                //$("#payment_eob_"+paymentId).append("<tr style=\"background-color:#EEE;\" id=\"payment_service_"+paymentId+"_"+i+"\"><td width=\"80px\">Service "+i+"</td></tr>");
                $("#payment_eob_"+paymentId).append("<tr style=\"background-color:#EEE;\" id=\"payment_service_"+paymentId+"_"+i+"\"></tr>");
                $("#payment_service_"+paymentId+"_"+i).append("<td style=\"display:none;background-color:#EEE;\" ><input type=\"text\" name=\"service_"+paymentId+"_"+i+"_payment_id\" id=\"service_"+paymentId+"_"+i+"_payment_id\" /></td>");
                $("#payment_service_"+paymentId+"_"+i).append("<td style=\"background-color:#EEE;\" >CPT Code</td><td style=\"background-color:#EEE;\" ><input type=\"text\" name=\"service_"+paymentId+"_"+i+"_cptcode\"  id=\"service_"+paymentId+"_"+i+"_cptcode\" value=\""+eob_value[0]+"\" /></td>");
                $("#payment_service_"+paymentId+"_"+i).append("<td style=\"background-color:#EEE;\" >Charges</td><td style=\"background-color:#EEE;\" ><input type=\"text\" name=\"service_"+paymentId+"_"+i+"_charge\" id=\"service_"+paymentId+"_"+i+"_charge\" value=\""+eob_value[1]+"\" onkeyup=\"javascript:dollorformate('#service_"+paymentId+"_"+i+"_charge')\" onblur=\"javascript:dollorchange('#service_"+paymentId+"_"+i+"_charge')\" onchange=\"javascript:myischanged();\"/></td>");
                $("#payment_service_"+paymentId+"_"+i).append("<td style=\"background-color:#EEE;\" >Expected Pay</td><td style=\"background-color:#EEE;\" ><input type=\"text\" name=\"service_"+paymentId+"_"+i+"_expectedpay\" id=\"service_"+paymentId+"_"+i+"_expectedpay\" value=\""+eob_value[2]+"\" onkeyup=\"javascript:dollorformate('#service_"+paymentId+"_"+i+"_expectedpay')\" onblur=\"javascript:dollorchange('#service_"+paymentId+"_"+i+"_expectedpay')\" onchange=\"javascript:myischanged();\" /></td>");
                $("#payment_service_"+paymentId+"_"+i).append("<td style=\"background-color:#EEE;\" >Payment Amount</td><td style=\"background-color:#EEE;\" ><input type=\"text\" name=\"service_"+paymentId+"_"+i+"_payment\" id=\"service_"+paymentId+"_"+i+"_payment\"  onkeyup=\"javascript:dollorformate('#service_"+paymentId+"_"+i+"_payment')\" onblur=\"javascript:dollorchange('#service_"+paymentId+"_"+i+"_payment')\"  onchange=\"calculatepayment("+paymentId+");change_payment(" + paymentId+");calculate_all();myischanged();\"/></td>");
            }
        }
        if(EOB_or_total=="total"&&NoO=="old"){
            $("<tr></tr>").insertAfter("#tr_payment_"+paymentId).attr("id","tr_payment_eob_"+paymentId).css("display","none");
            $("<td></td>").appendTo("#tr_payment_eob_"+paymentId).attr("colspan",12).append("<table  style=\"margin-left:30px;\" id=\"payment_eob_"+paymentId+"\"></table>");
            //$("<table></table>").appendTo("#tr_payment_eob_"+paymentId).attr("id","payment_eob_"+paymentId);
            var eob_count = $("#service_count").val();
            for(var i = 1;i<=eob_count;i++){
                var eob_value = $("#service_"+i).val().split("|");
                //$("#payment_eob_"+paymentId).append("<tr style=\"background-color:#EEE;\" id=\"payment_service_"+paymentId+"_"+i+"\"><td width=\"80px\">Service "+i+"</td></tr>");
                $("#payment_eob_"+paymentId).append("<tr style=\"background-color:#EEE;\" id=\"payment_service_"+paymentId+"_"+i+"\"></tr>");
                $("#payment_service_"+paymentId+"_"+i).append("<td style=\"display:none;background-color:#EEE;\" ><input type=\"text\" name=\"service_"+paymentId+"_"+i+"_payment_id\" id=\"service_"+paymentId+"_"+i+"_payment_id\" /></td>");
                $("#payment_service_"+paymentId+"_"+i).append("<td style=\"background-color:#EEE;\" >CPT Code</td><td style=\"background-color:#EEE;\" ><input type=\"text\" name=\"service_"+paymentId+"_"+i+"_cptcode\" id=\"service_"+paymentId+"_"+i+"_cptcode\" value=\""+eob_value[0]+"\"/></td>");
                $("#payment_service_"+paymentId+"_"+i).append("<td style=\"background-color:#EEE;\" >Charges</td><td style=\"background-color:#EEE;\" ><input type=\"text\" name=\"service_"+paymentId+"_"+i+"_charge\" id=\"service_"+paymentId+"_"+i+"_charge\" value=\""+eob_value[1]+"\" onkeyup=\"javascript:dollorformate('#service_"+paymentId+"_"+i+"_charge')\" onblur=\"javascript:dollorchange('#service_"+paymentId+"_"+i+"_charge')\" onchange=\"javascript:myischanged();/></td>");
                $("#payment_service_"+paymentId+"_"+i).append("<td style=\"background-color:#EEE;\" >Expected Pay</td><td style=\"background-color:#EEE;\" ><input type=\"text\" name=\"service_"+paymentId+"_"+i+"_expectedpay\" id=\"service_"+paymentId+"_"+i+"_expectedpay\" value=\""+eob_value[2]+"\" onkeyup=\"javascript:dollorformate('#service_"+paymentId+"_"+i+"_expectedpay')\" onblur=\"javascript:dollorchange('#service_"+paymentId+"_"+i+"_charge')\" onchange=\"javascript:myischanged();/></td>");
                $("#payment_service_"+paymentId+"_"+i).append("<td style=\"background-color:#EEE;\" >Payment Amount</td><td style=\"background-color:#EEE;\" ><input type=\"text\" name=\"service_"+paymentId+"_"+i+"_payment\" id=\"service_"+paymentId+"_"+i+"_payment\" onblur=\"javascript:dollorchange('#service_"+paymentId+"_"+i+"_payment')\"  onkeyup=\"javascript:dollorformate('#service_"+paymentId+"_"+i+"_payment')\" onchange=\"check_type("+paymentId+");myischanged(); /></td>");
            }
        }
    }
</script>
<script type="text/javascript" language="javascript">
    function changeHeight(){
        if((paymentId+eobTableLines)==1){
            paymentTd.style.display ="";
            paymentDiv.style.display = "";
            paymentDiv.style.height ="25px";
        }
        if((paymentId+eobTableLines)==2){
            paymentDiv.style.height = "50px";
        }
        if((paymentId+eobTableLines)==3){
            paymentDiv.style.height = "75px";
        }
        if((paymentId+eobTableLines)==4){
            paymentDiv.style.height = "100px";
        }
        if((paymentId+eobTableLines)==5){
            paymentDiv.style.height = "125px";
        }
        if((paymentId+eobTableLines)==6){
            paymentDiv.style.height = "150px";
        }
        if((paymentId+eobTableLines)==7){
            paymentDiv.style.height = "175px";
        }
        if((paymentId+eobTableLines)==8){
            paymentDiv.style.height = "200px";
        }
        if((paymentId+eobTableLines)==9){
            paymentDiv.style.height = "225px";
        }
        if((paymentId+eobTableLines)==10){
            paymentDiv.style.height = "250px";
        }
    }
    function check_type(Id){
        var count = parseInt($("#service_count").val());
        for(var i=1;i<=count;i++){
            var cur = $("#service_"+paymentId+"_"+i+"_payment").val();
            if(cur!=null && cur!="" && cur!=0){
                $("#payment_type_"+Id).val("EOB");
                break;
            }
        }
    }
    function calculatepayment(paymentId){
        var count = parseInt($("#service_count").val());
        var sum = 0;
        for(var i=1;i<=count;i++){
            var cur = $("#service_"+paymentId+"_"+i+"_payment").val();
            sum =((cur!=""&&cur!=null)?parseFloat(cur):0) +sum;
        }
        $("#payment_amount_"+paymentId).val(sum);
    }
    function expand(paymentId,elem){
        var text = elem.innerHTML;
        if(text=="+"){
            var count = parseInt($("#service_count").val());
            eobTableLines = eobTableLines + count;
            changeHeight();
            $("#tr_payment_eob_"+paymentId).css("display","");
            $("#payment_type_"+paymentId).val("EOB");
            $("#payment_amount_"+paymentId).attr("readonly","readonly");
            elem.innerHTML = "-";
        }
        if(text=="-"){
            var count = parseInt($("#service_count").val());
            eobTableLines = eobTableLines - count;
            changeHeight();
            $("#tr_payment_eob_"+paymentId).css("display","none");
            $("#payment_type_"+paymentId).val("total");
            $("#payment_amount_"+paymentId).removeAttr("readonly");
            elem.innerHTML = "+";
        }
    }
    function eobarea(paymentId,elem){
        var text = elem.innerHTML;
        if(text=="+"){
            var count = parseInt($("#service_count").val());
            eobTableLines = eobTableLines + count;
            changeHeight();
            $("#tr_payment_eob_"+paymentId).css("display","");
            $("#payment_amount_"+paymentId).attr("readonly","readonly");
            elem.innerHTML = "-";
        }
        if(text =="-"){
            var count = parseInt($("#service_count").val());
            eobTableLines = eobTableLines - count;
            changeHeight();
            $("#tr_payment_eob_"+paymentId).css("display","none");
            $("#payment_amount_"+paymentId).removeAttr("readonly");
            elem.innerHTML = "+";
        }
    } 
</script>
<!--<script type="text/javascript" language="javascript">
     function validationforpayment(paymentId){
      
     var count = parseInt($("#service_count").val());
    
     var sum=0;
        for(var i=1;i<=count;i++){
            var servicepayment=$("#service_"+paymentId+"_"+i+"_payment").val();
            
            if(servicepayment===undefined){
               
                
            }else{
                sum+=servicepayment;
            }
                

        }
       
        var payment_amount = $("#payment_amount_"+paymentId).val();
        sum=parseInt(sum);
        payment_amount=parseInt(payment_amount);
        if(payment_amount!=sum&&sum!=0){
           $("#payment_amount_"+paymentId).css("border","4px solid red");
           $("#payment_amount_"+paymentId).focus();
        }else{
           $("#payment_amount_"+paymentId).css("border"," 1px solid #aaa");
                    
        }
        
    }
</script>-->
<script type="text/javascript" language="javascript">
function deletetable7(){
                var paymentTd = document.getElementById("paymentTd");
                var paymentDiv = document.getElementById("paymentDiv");
                var count_payment = document.getElementById("count_payment");
                if(paymentId>1){
                    
                    var theDeleTr = document.getElementById("tr_payment_"+paymentId+"");
                    
                    theDeleTr.parentNode.removeChild(theDeleTr);
                    --paymentId;
                    calculate_amount();
                    //paymentreceived3(interactionlogId);
                    count_payment.value = paymentId;
                 
                    if(paymentId ==1){
                        paymentDiv.style.height ="25px";
                    }
                    if(paymentId == 2){
                        paymentDiv.style.height = "50px";
                    }
                    if(paymentId == 3){
                        paymentDiv.style.height ="75px";
                    }
                }
                var time = realtime();
                $("#delete_time").val(time);
                calculate_all();
            } 
</script>
<script type="text/javascript" language="javascript">
    function change_payment(paymentId){
        //alert('-- changepayment triggered');
        var date_and_time = "#payment_date_and_time_" + paymentId;
        var time = realtime();
        $(date_and_time).val(time);
        var payment_id = "#payment_amount_" + paymentId;
        var amount_string = $(payment_id).val();
        var value ;
        if(amount_string=="" || amount_string==null){
            value = 0;
            var time =realtime();
            $("#delete_time").val(time);
        }else{
//            value = parseFloat($(payment_id).val());
            right_format(payment_id);
            value = parseFloat($(payment_id).val());
        }
        //alert('value = '+ value);
        if(value<0) {
            //alert('negative'+ value);
            value = (0-value).toString();
            if(value.search(/\./)!=-1){}else{value = value +".00";}
            $(payment_id).val(value);
            //alert('before change color');
            $(payment_id).css("color","red");
            //alert('after change color');
            var payment_positive = "#payment_amount_positive_" + paymentId;
            $(payment_positive).val("negative");
        }else if(value>0){
            value = value.toString();
            if(value.search(/\./)!=-1){}else{value = value +".00";}
            $(payment_id).val(value);
            $(payment_id).css("color","black");
            var payment_positive = "#payment_amount_positive_" + paymentId;
            $(payment_positive).val("positive");
        }
        calculate_amount();
    }
</script>
<script type="text/javascript" language="javascript">
    function change_payment_from(paymentfrom_Id){
        var elem = document.getElementById(paymentfrom_Id);
        var value = elem.options[elem.selectedIndex].text;
        //alert(value);
        if(value=='Misc'){
            paymentfrom_Id = "#" + paymentfrom_Id; 
            $(paymentfrom_Id).css("display","none");
            var self_id = "#payment_from_self_" + paymentfrom_Id.split("_")[2];
            //alert(self_id);
            $(self_id).css("display","");
        }
    }
</script>
<script type="text/javascript" language="javascript">
    function calculate_amount(){
        var i=1;
        var sum = 0;
        var negative = 0;
        for(i=1;i<=paymentId;i++){
            var payment_amount_id = "#payment_amount_" + i;
            var color = $(payment_amount_id).css("color");
            //alert('color = ' + color + ' color.toString() = ' + color.toString());
            var amount = parseFloat($(payment_amount_id).val());
            if(color.toString() != 'rgb(255, 0, 0)'){
                //alert('None red');
                sum = sum + amount;
            }else{
                //alert('Red');
                negative = negative + amount;
            }
        }
        var total_charge = parseFloat($("#total_charge").val());
        var amount_paid =  sum;
        var balance_due = total_charge - sum - negative;
        //alert(amount_paid + "   " + balance_due);
        amount_paid = amount_paid.toFixed(2);
        balance_due = balance_due.toFixed(2);
        $("#amount_paid").val(amount_paid);
        $("#balance_due").val(balance_due);
        var curTime = new Date();
        var amount_paid_bk = $("#amount_paid_bk").val();
        var balance_due_bk = $("#balance_due_bk").val();
        var time = ((curTime.getMonth()<9)?("0"+(curTime.getMonth()+1)):(curTime.getMonth()+1)) + "/" + ((curTime.getDate()<10)?("0"+curTime.getDate()):(curTime.getDate())) +"/" + curTime.getFullYear() + " " + ((curTime.getHours()<10)?("0"+curTime.getHours()):(curTime.getHours())) + ":" +curTime.getMinutes() +":"+curTime.getSeconds();
        if(amount_paid_bk != amount_paid){
            $("#amount_paid_time").val(time);
        }
        if(balance_due_bk != balance_due){
            $("#balance_due_time").val(time);
        }
        //check_change("amount_paid");
        //check_change("balance_due");
    }
</script>
<script type="text/javascript" language="javascript">
    function change_guarantor(){
        var guarantor = $("#guarantor").val();
        if(guarantor == "no"){
            $("#g_tr_1").css("display","none");
            $("#g_tr_2").css("display","none");
            $("#g_tr_3").css("display","none");
            $("#g_last_name").val("");
            $("#g_first_name").val("");
            $("#g_dob").val("");
            $("#g_sex").val("");
            $("#g_street_address").val("");
            $("#g_zip").val("");
            $("#g_city").val("");
            $("#g_state").val("");
            $("#g_phone_number").val("");
            $("#g_second_phone_number").val("");
            $("#g_ssn").val("");
            $("#g_relationship_to_patient").val("");
        }else if(guarantor=="new"){
            $("#g_tr_1").css("display","");
            $("#g_tr_2").css("display","");
            $("#g_tr_3").css("display","");
            $("#g_last_name").val("");
            $("#g_first_name").val("");
            $("#g_dob").val("");
            $("#g_sex").val("");
            $("#g_street_address").val("");
            $("#g_zip").val("");
            $("#g_city").val("");
            $("#g_state").val("");
            $("#g_phone_number").val("");
            $("#g_second_phone_number").val("");
            $("#g_ssn").val("");
            $("#g_relationship_to_patient").val("");
        }else if(parseInt(guarantor)>0){
            $.post("<?php echo $this->baseUrl ?>/biller/claims/getguarantorfromid/",{guarantor_id:guarantor},
            function(data){
                var myjson='';
                eval("myjson=" + data + ";");
                var guarantor = myjson;  
                $("#g_tr_1").css("display","");
                $("#g_tr_2").css("display","");
                $("#g_tr_3").css("display","");
                $("#g_last_name").val(guarantor.last_name);
                $("#g_first_name").val(guarantor.first_name);
                $("#g_dob").val(guarantor.DOB);
                $("#g_sex").val(guarantor.sex);
                $("#g_street_address").val(guarantor.street_address);
                $("#g_zip").val(guarantor.zip);
                $("#g_city").val(guarantor.city);
                $("#g_state").val(guarantor.state);
                $("#g_phone_number").val(guarantor.phone_number);
                $("#g_second_phone_number").val(guarantor.second_phone_number);
                $("#g_ssn").val(guarantor.SSN);
                $("#g_relationship_to_patient").val(guarantor.relationship_to_patient);
            });
        }
    }
    function calculate_all(){
        var totalCharge = parseFloat($("#total_charge").val());
        var paymentSum = 0;
        var billeradjustment = 0;
        var i=1;
        for(i=1;i<=paymentId;i++){
            var curNum = $("#payment_amount_"+i).val();
            if(curNum==""||curNum==null){
                curNum = 0;
            }
            if($("#payment_from_"+i).val()!="Biller Adjustment"){
                var color = $("#payment_amount_" + i).css("color");
                if(color.toString() != 'rgb(255, 0, 0)'){
                    paymentSum = paymentSum + parseFloat(curNum);
                }else{
                    paymentSum = paymentSum - parseFloat(curNum);
                }
            }else{
                var color = $("#payment_amount_" + i).css("color");
                var tmp = parseFloat(curNum);
                if(color.toString() != 'rgb(255, 0, 0)'){
                    billeradjustment = billeradjustment + Math.abs(tmp);
                }else{
                    billeradjustment = billeradjustment - Math.abs(tmp);
                }
            }
        }
        var balance_due = totalCharge - paymentSum + billeradjustment;
        paymentSum = paymentSum.toFixed(2);
        balance_due = balance_due.toFixed(2);
        $("#amount_paid").val(paymentSum);
        $("#balance_due").val(balance_due);
        var amount_paid_bk = $("#amount_paid_bk").val();
        var balance_due_bk = $("#balance_due_bk").val();
        var curTime = new Date();
        var time = ((curTime.getMonth()<9)?("0"+(curTime.getMonth()+1)):(curTime.getMonth()+1)) + "/" + ((curTime.getDate()<10)?("0"+curTime.getDate()):(curTime.getDate())) +"/" + curTime.getFullYear() +" "+ ((curTime.getHours()<10)?("0"+curTime.getHours()):(curTime.getHours())) + ":" +curTime.getMinutes() +":"+curTime.getSeconds();
        if(amount_paid_bk != paymentSum){
            $("#amount_paid_time").val(time);
        }
        if(balance_due_bk != balance_due){
            $("#balance_due_time").val(time);
        }
    }
    function setPrevious(){
        var value = $("#bill_status").val();
        $("#bill_status_bk").val(value);
    }
    function checkCondition(){
        var value = $("#bill_status").val();
        var err=false;
        if(value=="bill_ready_bill_primary"){
            if($("#check_self").val()=="0"){
                $("#bill_status").val($("#bill_status_bk").val());
                err=true;
                alert("You can not bill for Primary insurance without the correct insurance setup, please correct it on Service tab");
            }
        }
        if(value=="bill_ready_bill_secondary"){
            if($("#check_secondary").val()=="0"){
                $("#bill_status").val($("#bill_status_bk").val());
                err=true;
                alert("You can not bill for Secondary insurance without the correct insurance setup, please correct it on Service tab");
            }
        }
        if(value=="bill_ready_bill_other"){
            if($("#check_other").val()=="0"){
                err=true;
                $("#bill_status").val($("#bill_status_bk").val());
                alert("You can not bill for Other insurance without the correct insurance setup, please correct it on Service tab");
            }
        }
        //following is for adding last
        var bill_status=$("#bill_status").val();
                //alert("statement_status entered: " + statement_status);
        var last_bill_status=$("#bill_status_bk").val();
                //alert('1- #last_statement_status = ' + $("#last_statement_status").val());
        var bill_status_list =  <?php echo json_encode($this->billstatusList); ?>;
        var bill_status_display ="";
        var last_bill_status_display = "";
        if (err) {
                   
               $("#bill_status").val($("#bill_status_bk").val());
                
         } else {
//                alert(bill_status_list.length);
                var i=0;
                while(i<bill_status_list.length)
                {
                    
                    if(bill_status==bill_status_list[i]['bill_status']){
                        bill_status_display = bill_status_list[i]['bill_status_display'];
                    }
                    if(last_bill_status==bill_status_list[i]['bill_status']){
                        last_bill_status_display = bill_status_list[i]['bill_status_display'];
                    }
                    i++;
                }
//                alert(1);
                /*Fix the date format*/
                    var month,day,year;
                    var myDate = new Date();
                    if( myDate.getMonth() + 1< 10)
                        month = '0'+(myDate.getMonth()+1);
                    else
                        month = myDate.getMonth()+1;
                    
                    if( myDate.getDate() < 10)
                       day = '0'+myDate.getDate();
                    else
                       day = myDate.getDate(); 
                   
                    year = myDate.getFullYear();
                    /*Fix the date format*/
                                
                var currentdate=month+'/'+day+'/'+year;
                
               // var currenttime=(myDate.getMonth()+1)+'/'+myDate.getDate()+'/'+myDate.getFullYear()+' '+myDate.getHours()+':'+myDate.getMinutes();
                currenttime = showtime();
                var real_time = realtime();
                /*Fix the date format*/
                    
                    var nextweek = new Date();
                    nextweek.setDate(myDate.getDate()+7);
                    
                    if( nextweek.getMonth() + 1 < 10)
                        month = '0'+(nextweek.getMonth()+1);
                    else
                        month = nextweek.getMonth()+1;
                    
                    if( nextweek.getDate() < 10)
                       day = '0'+nextweek.getDate();
                    else
                       day = nextweek.getDate(); 
                   
                    year = nextweek.getFullYear();
                    /*Fix the date format*/                                
                
                var nextweekdate=month+'/'+day+'/'+year;                                
//                 alert(nextweekdate);
                var biller=$("#billername").val();
                
               
                if(bill_status!=last_bill_status)
                {   
                    if(last_bill_status==""){
                        var mainlog= biller+": Added Bill Status "+bill_status_display;
                        addlog(currenttime,biller,mainlog,real_time);
                    }else if(statement_status==""){
                        var mainlog= biller+": Removed Bill Status "+last_bill_status_display;
                        addlog(currenttime,biller,mainlog,real_time);
                    }else{
                        var mainlog= biller+": Changed Bill Status from "+last_bill_status_display+" to "+bill_status_display;
                        addlog(currenttime,biller,mainlog,real_time);
                    }
                    $("#bill_status_bk").val($("#bill_status").val());
                    return false;                                                                                                                                                   
                }
            }
      
    }
</script>
<script type="text/javascript" language="javascript" >
            function zipcode(name)
            {
                var zip=$(name).val();
                var zip=$(name).val();
//                var phone_number=$(name).val();
                 var SSNlenght=zip.length;
                var temp=zip.charAt(SSNlenght-1);
                if(temp=='1'||temp=='2'||temp=='3'||temp=='4'||temp=='5'||temp=='6'||temp=='7'||temp=='8'||temp=='9'||temp=='0'){
//                    alert(1)
                }else{
//                    alert(3);

                       zip=zip.substr(0,SSNlenght-1);
                      
//                      
//                   
                }
                if(zip.length==5)
                {
                   
                }
                if(zip.length==6)
                {
                    zip = zip.substr(0,5)+'-'+zip.substr(5,5);
                   // $(name).val(zip);
                }
                if(zip.length>10)
                {
                    zip = zip.substr(0,10);
                    //$(name).val(zip);
                }
                if(zip.length==10||zip.length==5){
                    
                    var index=0;
                    for(index=0;index<zip.length;index++){
                       var cur=zip.charAt(index) ;
                              if(cur<'0'||cur>'9'){
                               if(index==5){
                                   if(cur!='-'){
                                        zip=zip.substr(0,index)+zip.substr(index+1,zip.length-index-1);
                                         $(name).val(zip);
                                        var tempname=name.substr(1,name.length-1);
//                                        //alert(tempname);
                                        setCaretPosition(document.getElementById(tempname),index);
                                        //$(name).val(SSN);
                                        return;
                                        
                                   }
                               }else{
                                        //alert(cur);
                                        zip=zip.substr(0,index)+zip.substr(index+1,zip.length-index-1);
                                        $(name).val(zip);
                                        var tempname=name.substr(1,name.length-1);
//                                        //alert(tempname);
                                        setCaretPosition(document.getElementById(tempname),index);
                                        
                                        return;
                                        
                                }
//                              
                       }
                    }
                     
                }
                 $(name).val(zip);
            }
            function phone(name)
            {
                var phone_number=$(name).val();
                var length=phone_number.length;
                if(length==0||length==1||length==2||length==5||length==6||length==7||length==9||length==10||length==11||length==12){
                    var charat=phone_number.charAt(length-1) ;
                    if(charat<'0'||charat>'9'){
                        phone_number=phone_number.substr(0,length-1);
                        $(name).val(phone_number);
                    }
                    //alert(charat);
                }
                if(phone_number.length==1)
                if(phone_number.length==1){
                    if(phone_number=='0'||phone_number=='1'){
                        phone_number='';
                    }
                 $(name).val(phone_number);
                }
                if(phone_number.length==3)
                {
                    phone_number='('+phone_number+')';
                    $(name).val(phone_number);
                }
                if(phone_number.length==8)
                {
                    phone_number=phone_number+'-';
                    $(name).val(phone_number);
                }
                if(phone_number.length>13)
                {
                    phone_number = phone_number.substr(0,13);
                    $(name).val(phone_number);
                }
                 if(phone_number.length==13){
                    //alert(phone_number);
                    var index=0;
                    for(index=0;index<phone_number.length;index++){
                       var cur=phone_number.charAt(index) ;
                              if(cur<'0'||cur>'9'){
                               if(index==0){
                                   if(cur!='('){
                                        phone_number=phone_number.substr(0,index)+phone_number.substr(index+1,time.length-index-1);
                                        var tempname=name.substr(1,name.length-1);
                                        //alert(tempname);
                                        setCaretPosition(document.getElementById(tempname),index);
                                        $(name).val(phone_number);
                                         return;
                                   }
                               }else if(index==4){
                                   if(cur!=')'){
                                        phone_number=phone_number.substr(0,index)+phone_number.substr(index+1,time.length-index-1);
                                        var tempname=name.substr(1,name.length-1);
                                        //alert(tempname);
                                        setCaretPosition(document.getElementById(tempname),index);
                                        $(name).val(phone_number);
                                         return;
                                   }
                               } else if(index==8){
                                   if(cur!='-'){
                                        phone_number=phone_number.substr(0,index)+phone_number.substr(index+1,time.length-index-1);
                                        var tempname=name.substr(1,name.length-1);
                                        //alert(tempname);
                                        setCaretPosition(document.getElementById(tempname),index);
                                        $(name).val(phone_number);
                                         return;
                                   }
                               }
                               else{
                                        //alert(cur);
                                        phone_number=phone_number.substr(0,index)+phone_number.substr(index+1,phone_number.length-index-1);
                                        $(name).val(phone_number);
                                        var tempname=name.substr(1,name.length-1);
                                        //alert(tempname);
                                        setCaretPosition(document.getElementById(tempname),index);
    
                                         return;
                                }
                              
                       }
                    }
                     
                }
            }
            function ssn(name)
            {
                var SSN=$(name).val();
                var SSNlenght=SSN.length;
                var temp=SSN.charAt(SSNlenght-1);
                if(temp=='1'||temp=='2'||temp=='3'||temp=='4'||temp=='5'||temp=='6'||temp=='7'||temp=='8'||temp=='9'||temp=='0'){
//                    alert(1)
                }else{
//                    alert(3);

                       SSN=SSN.substr(0,SSNlenght-1);
                      
//                      
//                   
                }
                if(SSN.length==3)
                {
                    SSN=SSN+'-';
                   
                }
                if(SSN.length==6)
                {
                    SSN=SSN+'-';
//                    $(name).val(SSN);
                }
                if(SSN.length>11)
                {
                    SSN = SSN.substr(0,11);
//                    $(name).val(SSN);
                }
                
               if(SSN.length==11){
                    
                    var index=0;
                    for(index=0;index<SSN.length;index++){
                       var cur=SSN.charAt(index) ;
                              if(cur<'0'||cur>'9'){
                               if(index==3||index==6){
                                   if(cur!='-'){
                                        SSN=SSN.substr(0,index)+SSN.substr(index+1,SSN.length-index-1);
                                         $(name).val(SSN);
                                        var tempname=name.substr(1,name.length-1);
//                                        //alert(tempname);
                                        setCaretPosition(document.getElementById(tempname),index);
                                        //$(name).val(SSN);
                                        return;
                                        
                                   }
                               }else{
                                        //alert(cur);
                                        SSN=SSN.substr(0,index)+SSN.substr(index+1,SSN.length-index-1);
                                        $(name).val(SSN);
                                        var tempname=name.substr(1,name.length-1);
//                                        //alert(tempname);
                                        setCaretPosition(document.getElementById(tempname),index);
                                        
                                        return;
                                        
                                }
//                              
                       }
                    }
                     
                }
                 $(name).val(SSN);
                 
            }
            function zipupformat(name){
                    // dateformat(name);
                    var time=$(name).val();
                    var len_time=time.length;
                    //alert(time);
                    if(len_time<11&&len_time!=0&&len_time!=5)
                    {
                            $(name).css("border","4px solid red");
                            $(name).focus();
                    }else{
                            $(name).css("border"," 1px solid #aaa");
                    }
             }
            function zip2citystate()
            {
                var zip=$("#g_zip").val();
                if(zip.length>0)
                {
                    $.post("<?php echo $this->baseUrl ?>/biller/claims/zip2citystate/",{zip:zip},
                    function(data){
                        var myjson='';
                        eval("myjson=" + data + ";");
                        if(myjson.city!=null)
                            $("#g_city").val(myjson.city);
                        if(myjson.state!=null)
                            $("#g_state").val(myjson.state);
                    }
                );
                }
                var new_patient = $("#new_patient_flag").val();
                if(new_patient == '0'){
                    var time = showtime();
                    var real_time = realtime();
                    var last_zip = $("#g_last_zip").val();
                    var cur_zip = $("#g_zip").val();
                    if(last_zip != cur_zip){
                        var biller = $("#billername").val();
                        $("#g_last_zip").val(cur_zip);
                        if(last_zip == '' || last_zip == null){
                            var log = biller + ": Added Zip Code " + cur_zip ;
                        }else if (cur_zip == '' || cur_zip == null){
                            var log = biller + ": Removed Zip Code " + last_zip ;
                        }else{
                            var log = biller + ": Changed Zip Code from " + last_zip + " to " + cur_zip ;
                        }
                        addlog(time,real_time,log);
                    }
                }
            }

</script>
<style>
    label.ui-corner-all{
        margin: 0;
        padding: 0;
        line-height: 0;
    }
    label.ui-corner-all  span{
        float:none;
        margin: 0;
        padding: 0;
        /*line-height*/
    }
    div.ui-multiselect-header{
        height:24px;
    }
</style>
</head>

    <body>
        <!--        <div id="navbar">
                    <p>Your Location: <a  title="">Claims Management</a> &gt; Claims followup</p>
                </div>-->
         <a href="<?php echo $this->baseUrl ?>" target="_top" id="relogin" style="display: none" >wwwwww</a>
        <div class="table-div" >

            <form  method="post" onsubmit="javascript:return check();">
                <table>
<!--                    <tr>
                        <td>
                            <table>-->
                    <tr class="navigation">
                        <td colspan="8" style="background:#ffffff">
                            <a href="#"><span> <input type="submit" name="submit" id="Previous"value="Previous"/></span></a>
                            <a href="#"><span> <input type="submit"name="submit"id="Patient"value="Patient" /></span></a>
                            <a href="#"><span> <input type="submit" name="submit"id="Insurance"value="Insurance" /></span></a>
                            <a href="#"><span> <input type="submit"name="submit"id="Service"value="Service" /></span></a>
                            <a href="#"><span> <input type="submit" name="submit"id="Claim"value="Claim" style="width:60px;background:url(<?php echo $this->baseUrl ?>/images/tab_bg_3.png)"/></span></a>
                            <a href="#"><span> <input style="width:100px" type="submit"name="submit"id="Documents"value="Documents" /></span></a>
                            <a href="#"><span> <input type="submit"name="submit"id="Next"value="Next" /></span></a>
                            

                            
                            <!-- Fix the mid UI By Yu Lang-->           
                            <span style="margin:0 0 0 30px"> 
                             <div id="current">                                      
                             <ul class="megamenu">
                                 <li ><a href="javascript:void(0)" ><font color="FF0000" size="1px"><?php echo $this->cur_service_info['patient_name'] ?></font></a>&nbsp;<!--    </li>
                                 <li>
                                     <a href="javascript:void(0)" style="color:#FF0000;">=</a>-->
                                     <div style="width: 840px; left:3px;">
                                         <!-- <h3>Dropdown Example</h3> -->
                                         <table border="1" cellpadding="0" cellspacing="0" id="tabular-content">
                                             <tr>
                                                <!-- <th style="width: 15px">Number</th> -->
                                                 <th style="text-align:center">DOS</th>
                                                 <th style="width: 26%;text-overflow:clip ; overflow:hidden; white-space:nowrap;text-align:center">Charge</th>
                                                 <th style="width: 25%;text-overflow:clip ; overflow:hidden; white-space:nowrap;text-align:center">Paid</th>
                                                 <th style="width: 25%;text-overflow:clip ; overflow:hidden; white-space:nowrap;text-align:center">%</th>
                                                 <th style="width: 25%;text-overflow:clip ; overflow:hidden; white-space:nowrap;text-align:center">Due</th>
                                                 <th style="width: 26%;text-overflow:clip ; overflow:hidden; white-space:nowrap;text-align:center">Insurance</th>
                                                 <th style="width: 25%;text-overflow:clip ; overflow:hidden; white-space:nowrap;text-align:center">Provider</th>
                                                 <th style="width: 26%;text-overflow:clip ; overflow:hidden; white-space:nowrap;text-align:center">Rendering Provider</th>
                                                 <th style="width: 25%;text-overflow:clip ; overflow:hidden; white-space:nowrap;text-align:center">Referring Provider</th>
                                                 <th style="width: 32%;text-overflow:clip ; overflow:hidden; white-space:nowrap;text-align:center">Facility</th>
                                                 <th style="width: 32%;text-overflow:clip ; overflow:hidden; white-space:nowrap;text-align:center">Last</th>
                                                 <th style="width: 32%;text-overflow:clip ; overflow:hidden; white-space:nowrap;text-align:center">Claim Status</th>
                                                 <th style="width: 32%;text-overflow:clip ; overflow:hidden; white-space:nowrap;text-align:center">Bill Status</th>
                                                 <th style="width: 32%;text-overflow:clip ; overflow:hidden; white-space:nowrap;text-align:center">Statement Status</th>
                                                  <!--<th style="width: 100px">DOS</th> -->
                                             </tr>
                                             
                                             <?php
                                             $tmp_baseUrl = $this->baseUrl;
                                             $tmp_claim_id = $this->cur_service_info['claim_id'];                                             
                                             foreach($this->tmpList as $row)
                                             {
                                                
                                                if( $row['claim_id'] == $tmp_claim_id )
                                                {
                                                    $rendering_provdier_name = $row['ren_last_name']. ', '. $row['ren_first_name'];
                                                    $referring_provider_name = $row['ref_last_name'].', '.$row['ref_first_name'];
                                                    
                                                    echo "<tr><td style= 'background-color: rgb(150,230,230);'>";                                                  
                                                    echo "<a href=\"". $this->baseUrl."/biller/claims/dropdown?patient_id=".$row['patient_id']. " & encounter_id=".$row['encounter_id'] ." & type=claim \">";
                                                    echo $row['dos']."</a></td>";
                                                     echo "<td style= 'width: 26%;text-overflow:clip ; overflow:hidden; white-space:nowrap; background-color: rgb(150,230,230);'>";
                                                    echo $row['total_charge']."</a></td>";
                                                     echo "<td style= 'width: 26%;text-overflow:clip ; overflow:hidden; white-space:nowrap; background-color: rgb(150,230,230);'>";
                                                    echo $row['amount_paid']."</a></td>";
                                                    echo "<td style= 'width: 26%;text-overflow:clip ; overflow:hidden; white-space:nowrap; background-color: rgb(150,230,230);'>";
                                                    echo $row['percentage']."</a></td>";
                                                    echo "<td style= 'width: 26%;text-overflow:clip ; overflow:hidden; white-space:nowrap; background-color: rgb(150,230,230);'>";
                                                    echo $row['balance_due']."</a></td>";
                                                    echo "<td style= 'width: 26%;text-overflow:clip ; overflow:hidden; white-space:nowrap; background-color: rgb(150,230,230);'>";
                                                    echo $row['insurance_display']."</a></td>";
                                                    echo "<td style= 'width: 26%;text-overflow:clip ; overflow:hidden; white-space:nowrap; background-color: rgb(150,230,230);'>";
                                                    echo $row['provider_short_name']."</a></td>";
                                                    echo "<td style= 'width: 26%;text-overflow:clip ; overflow:hidden; white-space:nowrap; background-color: rgb(150,230,230);'>";
                                                    echo substr($rendering_provdier_name,0,15)."</td>" ;
                                                    echo "<td style= 'width: 25%;text-overflow:clip ; overflow:hidden; white-space:nowrap;background-color: rgb(150,230,230);'>";
                                                    echo substr($referring_provider_name,0,15)."</td>";
                                                     echo "<td style= 'width: 26%;text-overflow:clip ; overflow:hidden; white-space:nowrap; background-color: rgb(150,230,230);'>";
                                                    echo $row['facility_short_name']."</a></td>";
                                                    echo "<td style= 'width: 26%;text-overflow:clip ; overflow:hidden; white-space:nowrap; background-color: rgb(150,230,230);'>";
                                                    echo $row['last']."</a></td>";
                                                    echo "<td style= 'width: 32%;text-overflow:clip ; overflow:hidden; white-space:nowrap;background-color: rgb(150,230,230);'>";
                                                    echo substr($row['claim_status'],0,30)."</a></td>";
                                                     echo "<td style= 'width: 50%;text-overflow:clip ; overflow:hidden; white-space:nowrap;background-color: rgb(150,230,230);'>";
                                                    echo substr($row['bill_status'],0,30)."</a></td>";
                                                     echo "<td style= 'width: 50%;text-overflow:clip ; overflow:hidden; white-space:nowrap;background-color: rgb(150,230,230);'>";
                                                    echo substr($row['statement_status'],0,30)."</a></td>";
                                                    echo "<tr>";
                                                }
                                                else
                                                {
                                                    $rendering_provdier_name = $row['ren_last_name']. ', '. $row['ren_first_name'];
                                                    $referring_provider_name = $row['ref_last_name'].', '.$row['ref_first_name'];
                                                    
                                                    echo "<tr><td>";
                                                    echo "<a href=\"". $this->baseUrl."/biller/claims/dropdown?patient_id=".$row['patient_id']. " & encounter_id=".$row['encounter_id'] ." & type=claim \">";
                                                    echo $row['dos']."</a></td>";
                                                    echo "<td style= 'width: 32%;text-overflow:clip ; overflow:hidden; white-space:nowrap;'>";
                                                    echo $row['total_charge']."</a></td>";
                                                     echo "<td style= 'width: 32%;text-overflow:clip ; overflow:hidden; white-space:nowrap;'>";
                                                    echo $row['amount_paid']."</a></td>";
                                                     echo "<td style= 'width: 32%;text-overflow:clip ; overflow:hidden; white-space:nowrap;'>";
                                                    echo $row['percentage']."</a></td>";
                                                     echo "<td style= 'width: 32%;text-overflow:clip ; overflow:hidden; white-space:nowrap;'>";
                                                    echo $row['balance_due']."</a></td>";
                                                     echo "<td style= 'width: 32%;text-overflow:clip ; overflow:hidden; white-space:nowrap;'>";
                                                    echo $row['insurance_display']."</a></td>";
                                                     echo "<td style= 'width: 32%;text-overflow:clip ; overflow:hidden; white-space:nowrap;'>";
                                                    echo $row['provider_short_name']."</a></td>";
                                                    echo "<td style= 'width: 26%;text-overflow:clip ; overflow:hidden; white-space:nowrap;'>";
                                                    echo substr($rendering_provdier_name,0,15)."</td>" ;
                                                    echo "<td style= 'width: 25%;text-overflow:clip ; overflow:hidden; white-space:nowrap;'>";
                                                    echo substr($referring_provider_name,0,15)."</td>";
                                                    echo "<td style= 'width: 32%;text-overflow:clip ; overflow:hidden; white-space:nowrap;'>";
                                                    echo $row['facility_short_name']."</a></td>";
                                                    echo "<td style= 'width: 32%;text-overflow:clip ; overflow:hidden; white-space:nowrap;'>";
                                                    echo $row['last']."</a></td>";
                                                    echo "<td style= 'width: 32%;text-overflow:clip ; overflow:hidden; white-space:nowrap;'>";
                                                    echo substr($row['claim_status'],0,30)."</a></td>";;
                                                    echo "<td style= 'width: 50%;text-overflow:clip ; overflow:hidden; white-space:nowrap;'>";
                                                    echo substr($row['bill_status'],0,30)."</a></td>";;
                                                    echo "<td style= 'width: 50%;text-overflow:clip ; overflow:hidden; white-space:nowrap;'>";
                                                    echo substr($row['status_status'],0,30)."</a>";;
                                                    echo "</td><tr>";
                                                }
                                             }
                                             ?>
                                         </table>
                                     </div>
                                 </li>
                                 
                                     |&nbsp;<?php echo $this->cur_service_info['gender'] ?>&nbsp;
                                     |&nbsp;<?php echo $this->cur_service_info['DOB'] ?>&nbsp;
                                     |&nbsp;<?php echo $this->cur_service_info['MRN'] ?>&nbsp;
                                     |&nbsp;<?php echo $this->cur_service_info['DOS'] ?>&nbsp;
                                     |&nbsp$<?php echo $this->cur_service_info['total_charge'] ?>&nbsp;
                                
                                    <br/><li>&nbsp;&nbsp;<?php echo $this->cur_service_info['secondary_cpt_code_1'] ?>&nbsp;
                                    |&nbsp;<?php echo $this->cur_service_info['provider_short_name'] ?>&nbsp;
                                    |&nbsp;<?php echo $this->cur_service_info['renderingprovider_name'] ?>&nbsp;
                                    |&nbsp;<?php echo $this->cur_service_info['referingprovider_name'] ?>&nbsp;
                                    |&nbsp;<li><a href="javascript:void(0)"><font color = "FF0000" size ="1px"><?php echo $this->cur_service_info['insurance_display'] ?></font></a>
                                    <div style="width: 840px; left:3px;">
                                         <!-- <h3>Dropdown Example</h3> -->
                                         <table border="1" cellpadding="0" cellspacing="0" id="tabular-content">
                                             <tr>
                                                <!-- <th style="width: 15px">Number</th> -->
<!--                                                 <th style="width: 30%;text-align:center">Name</th>-->
                                                 <th style="width: 32%;text-overflow:clip ; overflow:hidden; white-space:nowrap;text-align:center">Patient Name</th>
                                                 <th style="width: 1%;text-overflow:clip ; overflow:hidden; white-space:nowrap;text-align:center">DOB</th>
                                                 <th style="width: 1%;text-overflow:clip ; overflow:hidden; white-space:nowrap;text-align:center">MRN</th>
                                                 <th style="width: 1%;text-overflow:clip ; overflow:hidden; white-space:nowrap;text-align:center">DOS</th>
                                                 <th style="width: 1%;text-overflow:clip ; overflow:hidden; white-space:nowrap;text-align:center">Charge</th>
                                                 <th style="width: 1%;text-overflow:clip ; overflow:hidden; white-space:nowrap;text-align:center">Due</th>
                                                 <th style="width: 1%;text-overflow:clip ; overflow:hidden; white-space:nowrap;text-align:center">%</th>
                                                 <th style="width: 1%;text-overflow:clip ; overflow:hidden; white-space:nowrap;text-align:center">Paid</th>
                                                
                                                 <th style="width: 1%;text-overflow:clip ; overflow:hidden; white-space:nowrap;text-align:center">Insurance</th>
                                                 <th style="width: 1%;text-overflow:clip ; overflow:hidden; white-space:nowrap;text-align:center">Provider</th>
                                                 <th style="width: 1%;text-overflow:clip ; overflow:hidden; white-space:nowrap;text-align:center">Rendering Provider</th>
                                                 <th style="width: 1%;text-overflow:clip ; overflow:hidden; white-space:nowrap;text-align:center">Referring Provider</th>
                                                 <th style="width: 1%;text-overflow:clip ; overflow:hidden; white-space:nowrap;text-align:center">Facility</th>
                                                 <th style="width: 1%;text-overflow:clip ; overflow:hidden; white-space:nowrap;text-align:center">Last</th>
                                                 <th style="width: 1%;text-overflow:clip ; overflow:hidden; white-space:nowrap;text-align:center">Issue</th>
                                                 
                                                  <!--<th style="width: 100px">DOS</th> -->
                                             </tr>
                                             
                                             <?php
                                             $tmp_baseUrl = $this->baseUrl;
                                             $tmp_claim_id = $this->cur_service_info['claim_id'];  
                                             
                                             foreach($this->taiList as $row)
                                             {
                                                
                                                if( $row['claim_id'] == $tmp_claim_id )
                                                {
                                                    $rendering_provdier_name = substr($row['renderingprovider'],0,15) ;
                                                    $referring_provider_name = substr($row['referringprovider'],0,15);
                                                    
                                                    echo "<tr><td style= 'width: 32%;background-color: rgb(150,230,230);'>";                                                  
                                                    echo "<a href=\"". $this->baseUrl."/biller/claims/dropdown?patient_id=".$row['patient_id']. " & encounter_id=".$row['encounter_id'] ." & type=claim \">";
                                                    echo substr($row['name'],0,20)."</a></td>";
                                                     echo "<td style= 'width: 1%;text-overflow:clip ; overflow:hidden; white-space:nowrap; background-color: rgb(150,230,230);'>";
                                                    echo  date('m/d/Y', strtotime($row['DOB']))."</a></td>";
                                                     echo "<td style= 'width: 1%;text-overflow:clip ; overflow:hidden; white-space:nowrap; background-color: rgb(150,230,230);'>";
                                                    echo $row['MRN']."</a></td>";
                                                    echo "<td style= 'width: 1%;text-overflow:clip ; overflow:hidden; white-space:nowrap; background-color: rgb(150,230,230);'>";
                                                    echo date('m/d/Y', strtotime($row['DOS'])) ."</a></td>";
                                                    echo "<td style= 'width: 1%;text-overflow:clip ; overflow:hidden; white-space:nowrap; background-color: rgb(150,230,230);'>";
                                                    echo $row['total_charge']."</a></td>";
                                                    echo "<td style= 'width: 1%;text-overflow:clip ; overflow:hidden; white-space:nowrap; background-color: rgb(150,230,230);'>";
                                                    echo $row['due']."</a></td>";
                                                    echo "<td style= 'width: 1%;text-overflow:clip ; overflow:hidden; white-space:nowrap; background-color: rgb(150,230,230);'>";
                                                    echo $row['percentage']."</a></td>";
                                                    echo "<td style= 'width: 1%;text-overflow:clip ; overflow:hidden; white-space:nowrap; background-color: rgb(150,230,230);'>";
                                                    echo $row['amount_paid']."</td>" ;
                                                    echo "<td style= 'width: 1%;text-overflow:clip ; overflow:hidden; white-space:nowrap;background-color: rgb(150,230,230);'>";
                                                    echo substr($row['payer'],0,15) ."</td>";
                                                     echo "<td style= 'width: 1%;text-overflow:clip ; overflow:hidden; white-space:nowrap; background-color: rgb(150,230,230);'>";
                                                    echo $row['provider_short_name']."</a></td>";
                                                    echo "<td style= 'width: 1%;text-overflow:clip ; overflow:hidden; white-space:nowrap; background-color: rgb(150,230,230);'>";
                                                    echo substr($row['renderingprovider'],0,15) ."</a></td>";
                                                    echo "<td style= 'width: 1%;text-overflow:clip ; overflow:hidden; white-space:nowrap;background-color: rgb(150,230,230);'>";
                                                    echo substr($row['referringprovider'],0,15) ."</a></td>";
                                                     echo "<td style= 'width: 1%;text-overflow:clip ; overflow:hidden; white-space:nowrap;background-color: rgb(150,230,230);'>";
                                                    echo substr($row['facility_short_name'],0,30)."</a></td>";
                                                     echo "<td style= 'width: 1%;text-overflow:clip ; overflow:hidden; white-space:nowrap;background-color: rgb(150,230,230);'>";
                                                    echo substr($row['last'],0,30)."</a></td>";
                                                     echo "<td style= 'width: 1%;text-overflow:clip ; overflow:hidden; white-space:nowrap;background-color: rgb(150,230,230);'>";
                                                    echo substr($row['display'],0,30)."</a></td>";
                                                    echo "<tr>";
                                                }
                                                else
                                                {
                                                     $rendering_provdier_name = substr($row['renderingprovider'],0,15) ;
                                                    $referring_provider_name = substr($row['referringprovider'],0,15);
                                                    
                                                    echo "<tr><td style= 'width: 32%'>";
                                                    echo "<a href=\"". $this->baseUrl."/biller/claims/dropdown?patient_id=".$row['patient_id']. " & encounter_id=".$row['encounter_id'] ." & type=claim \">";
                                                    echo  substr($row['name'],0,20)."</a></td>";
                                                    echo "<td style= 'width: 1%;text-overflow:clip ; overflow:hidden; white-space:nowrap;'>";
                                                    echo date('m/d/Y', strtotime($row['DOB']))."</a></td>";
                                                     echo "<td style= 'width: 1%;text-overflow:clip ; overflow:hidden; white-space:nowrap;'>";
                                                    echo $row['MRN']."</a></td>";
                                                     echo "<td style= 'width: 1%;text-overflow:clip ; overflow:hidden; white-space:nowrap;'>";
                                                    echo date('m/d/Y', strtotime($row['DOS'])) ."</a></td>";
                                                     echo "<td style= 'width: 1%;text-overflow:clip ; overflow:hidden; white-space:nowrap;'>";
                                                    echo $row['total_charge']."</a></td>";
                                                     echo "<td style= 'width: 1%;text-overflow:clip ; overflow:hidden; white-space:nowrap;'>";
                                                    echo $row['due']."</a></td>";
                                                     echo "<td style= 'width: 1%;text-overflow:clip ; overflow:hidden; white-space:nowrap;'>";
                                                    echo $row['percentage']."</a></td>";
                                                    echo "<td style= 'width: 1%;text-overflow:clip ; overflow:hidden; white-space:nowrap;'>";
                                                    echo  $row['amount_paid']."</td>" ;
                                                    echo "<td style= 'width: 1%;text-overflow:clip ; overflow:hidden; white-space:nowrap;'>";
                                                    echo  substr($row['payer'],0,15) ."</td>";
                                                    echo "<td style= 'width: 1%;text-overflow:clip ; overflow:hidden; white-space:nowrap;'>";
                                                    echo $row['provider_short_name']."</a></td>";
                                                    echo "<td style= 'width: 1%;text-overflow:clip ; overflow:hidden; white-space:nowrap;'>";
                                                    echo substr($row['renderingprovider'],0,15) ."</a></td>";
                                                    echo "<td style= 'width: 1%;text-overflow:clip ; overflow:hidden; white-space:nowrap;'>";
                                                    echo substr($row['referringprovider'],0,15)."</a></td>";;
                                                    echo "<td style= 'width: 1%;text-overflow:clip ; overflow:hidden; white-space:nowrap;'>";
                                                    echo substr($row['facility_short_name'],0,30)."</a></td>";;
                                                    echo "<td style= 'width: 1%;text-overflow:clip ; overflow:hidden; white-space:nowrap;'>";
                                                    echo substr($row['last'],0,30)."</a>";;
                                                    echo "<td style= 'width: 1%;text-overflow:clip ; overflow:hidden; white-space:nowrap;'>";
                                                    echo substr($row['display'],0,30)."</a>";;
                                                    echo "</td><tr>";
                                                }
                                             }
                                             ?>
                                         </table>
                                    </div>|&nbsp;
                                    </li><li><?php echo $this->cur_service_info['insured_ID_number'] ?></li>
                                  </li> </ul>                                                                                                            
                           </div>
                           </span>
                            <!-- Fix the mid UI By Yu Lang-->

                             <!--<a name="ischanged" id="ischanged"  style='color:red;display: none' ><span style="float:right;margin:2px 0px 0 0;font-size:50px;font-family:Times New Roman">.</span></a>-->
                            <a href="#"><span style="float:right;margin:2px 0px 0 0"> <input type="submit"name="submit"value="Finish Claim"  style="width:80px"/></span></a>
                            <a href="#"><span style="float:right;margin:2px 0px 0 0"> <input type="submit"name="submit"value="Save Claim" id= "saveclaim" style="width:80px"/></span></a>
                            <a name="ischanged" id="ischanged"  style='color:red;display: none' ><span style="float:right;margin:-25px 5px 0 0;font-size: 50px;font-family:Times New Roman">.</span></a>
                        </td>
                    </tr>
<!--                    <tr>
                        <th colspan="8" style="background:#eeeeee"><p align="center"><b>Claim Followup Information</b></p></th>
                    </tr>-->
                     </table>
                     <table>
                    <tr>

                        <th width="16%">Total Charge</th><td ><input type="text" name="total_charge" id="total_charge" onchange="javascript:totalcharge();"  onblur="javascript:dollorchange('#total_charge')" onkeyup="javascript:dollorformate('#total_charge')"/></td>
                        <th width="16%">Amount Paid</th><td ><input type="text" name="amount_paid" id="amount_paid" onchange="javascript:amountpaidreceive()"    onblur="javascript:dollorchange('#amount_paid')" onkeyup="javascript:dollorformate('#amount_paid')"/><input style="display:none" type="text" name="amount_paid_bk" id="amount_paid_bk"/><input style="display:none" type="text" name="amount_paid_time" id="amount_paid_time" /></td>
                        <th width="15%">Balance Due</th><td ><input type="text" name="balance_due" id="balance_due"  onblur="javascript:dollorchange('#balance_due')" onkeyup="javascript:dollorformate('#balance_due')" /><input style="display:none" type="text" name="balance_due_bk" id="balance_due_bk" /><input style="display:none" type="text" name="balance_due_time" id="balance_due_time" /></td>
                        <th width="15%">Payment Expected</th><td ><input type="text" name="expected_payment" id="expected_payment" onblur="javascript:dollorchange('#expected_payment')" onkeyup="javascript:dollorformate('#expected_payment')"/></td>
                    </tr>
                    <tr>
                        <th align="left" >Claim Status</th>
                        <td  colspan="3"><select name="claim_status" id="claim_status"  onblur="javascript:status()"  onchange="javascript:myischanged()" style= "width:100% ">
                               <option value="">Select</option>
                             
                                <?php                  
                                foreach ($this->claimstatusList as $row) {
                                    if($row['status'] == 'inactive')
                                        echo "<option style='display:none' value='" . $row['claim_status'] . "'>" . $row['claim_status_display']."</option>";
                                    else
                                        echo "<option value='" . $row['claim_status'] . "'>" . $row['claim_status_display'] ."</option>";
                                }
                                ?>
                            </select>
                        </td>
                        <th align="left" >Statement Status</th>
                        <td><select name="statement_status" id="statement_status"  onblur="javascript:statementstatus()" onchange="javascript:myischanged()"  style= "width:100% ">
                               <option value="">Select</option>
                             
                                <?php                  
                                foreach ($this->statementstatusList as $row) {
                                    if($row['status'] == 'inactive')
                                        echo "<option style='display:none' value='" . $row['statement_status'] . "'>" . $row['statement_status_display'] ."</option>";
                                    else
                                        echo "<option value='" . $row['statement_status'] . "'>" . $row['statement_status_display'] ."</option>";
                                }
                                ?>
                            </select>
                        </td>
                        <th>Bill Status</th>
                        <td  colspan="3"><select name="bill_status" id="bill_status"  onfocus="setPrevious()" onblur="javascript:checkCondition();"  onchange="javascript:myischanged();" style= "width:100% ">
                               <option value="" >Select</option>
                             
                                <?php                  
                                foreach ($this->billstatusList as $row) {
                                    if($row['status'] == 'inactive')
                                        echo "<option value='" . $row['bill_status'] . "'>" . $row['bill_status_display'] ."</option>";
                                    else
                                        echo "<option value='" . $row['bill_status'] . "'>" . $row['bill_status_display'] ."</option>";
                                }
                                ?>
                            </select>
                        </td> 
                    </tr>
                    <tr>
                        <th>Date Bill Created</th><td ><input type="text" name="date_creation" id="date_creation" onkeyup="javascript:date1902('#date_creation')" onblur="javascript:dateupformat('#date_creation')" onchange="javascript:check_change('date_creation');myischanged()"  /></td>
                        <th>Date Billed</th><td ><input type="text" name="date_billed" id="date_billed" onkeyup="javascript:date1902('#date_billed')"  onblur="javascript:dateupformat('#date_billed')"  onchange="javascript:check_change('date_billed');myischanged()" /></td>
                        <th>Date Last Billed</th><td ><input type="text" name="date_last_billed" id="date_last_billed" onkeyup="javascript:date1902('#date_last_billed')" onblur="javascript:dateupformat('#date_last_billed')"  onchange="javascript:check_change('date_last_billed');myischanged()" /></td>  
                        <th>Date Closed</th><td ><input type="text" name="date_closed" id="date_closed" onkeyup="javascript:date1902('#date_closed')"  onblur="javascript:dateupformat('#date_closed')"  onchange="javascript:check_change('date_closed');myischanged()" /></td>
                    </tr>
                    <tr>

                    </tr>
                    <!--
                    <tr>
                        <th colspan="8" >&nbsp</th>
                    </tr>
                    -->
<!--                    
                    <tr>
    <th colspan="7"  style="background:#eeeeee;text-align: center">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Assigned Claims</th>-->
    <tr>
     <th >Assign This Claim To</th>
                        <td >
                            <select class="select" name="assigned_user_id" style= "width:100% " id="assigned_user_id" onchange="javascript:assignedbillerchange();myischanged()">
                                <option value=''>Select</option>
                                <?php
                                foreach ($this->billerList as $row) {
                                    echo "<option value='" . $row['user_id'] . "'>" . $row['user_name'] . "</option>";
                                }
                                ?>
                            </select>
                        </td>
     <!--
                        <td colspan ="6">
                        </td>
     -->
     <th>Next Follow-up Date</th><td><input type="text" name="date_of_next_followup" id="date_of_next_followup" onblur="javascript:dateupformat('#date_of_next_followup')" onkeyup="javascript:datelimit90('#date_of_next_followup')" onchange="javascript:check_change('date_of_next_followup');" /></td>
       <script>
                                                                
            function get_pc_val(){
                    var result = "";
                    var value = $("#patientcor").val();
                    // alert(value);
                    //god，获得的竟然是个json
                    for(var item in value){
                            var temp = value[item]+"|";
                            result += temp;
                    }
                    final_string =  result.substring(0, result.length-1);
//                    alert(final_string);
                    $("#patientcorrespondence").val(final_string);
            }
        </script>
     <th style= "">Patient Correspondence</th>
      <input type="text" style="display:none" id="patientcorrespondence" name="patientcorrespondence"/>
                        <td style= "width:15%">
                            <select name="patientcor" id="patientcor" multiple="multiple" style= "width:16%" onchange="javascript:get_pc_val();myischanged();">
       <!--                        <option value="all" style="display:none">All</option>-->
                                <?php
                                        foreach ($this->pcList as $row) {
                                            echo "<option value='" . $row['id'] . "'>" . $row['template'] . "</option>";
                                        }
                                ?>
                            </select>
                          
                        </td> 
     <th>Select Claim Color </th> 
     <td style="background:#EEEEEE">       
         <select name="colorselector_1" id="colorselector_1">
         <?php                  
            foreach ($this->colorAlertList as $row) {
                if($row['select'] == 1 )
                    echo "<option value='" . $row['RGB'] . "' data-color='#" . $row['RGB'] . "' selected='selected'>" . $row['alert'] . "</option>";
                else
                    echo "<option value='" . $row['RGB'] . "' data-color='#" . $row['RGB'] . "'>" . $row['alert'] . "</option>";
            }
        ?>            
        </select> 
     </td>     
    </tr>

                    <tr>
                        <th colspan="8"  style="background:#eeeeee;text-align: center">Insurance Payments</th>
                    </tr>
                    <tr>
                        <th align="left">Proposed Amount</th><td><input type="text" name="amount_initial_offer" id="amount_initial_offer" onblur="javascript:initialoffer();dollorchange('#amount_initial_offer')" onkeyup="javascript:dollorformate('#amount_initial_offer')" onchange="javascript:myischanged()"/></td>
                        <th align="left">Proposal Date</th><td><input type="text" name="date_initial_offer" id="date_initial_offer" onblur="javascript:dateupformat('#date_initial_offer')" onkeyup="javascript:date1902('#date_initial_offer')" onchange="javascript:myischanged()"/></td>
                        <th align="left">Agreed Amount</th><td><input type="text" name="negotiated_payment_amount" id="negotiated_payment_amount" onblur="javascript:paymentagreed();dollorchange('#negotiated_payment_amount')" onkeyup="javascript:dollorformate('#negotiated_payment_amount');" onchange="javascript:myischanged()"/></td>
                        <th align="left">Agreement Date</th><td><input type="text" name="date_negotiated_amount_reached" id="date_negotiated_amount_reached" onblur="javascript:dateupformat('#date_negotiated_amount_reached')" onkeyup="javascript:date1902('#date_negotiated_amount_reached')" onchange="javascript:myischanged()" /></td>
                    </tr>
                    <tr>
       
                        <th colspan="1">Issued Amount</th><td ><input type="text" name="amount_insurance_payment_issued" id="amount_insurance_payment_issued" onblur="javascript:dollorchange('#amount_insurance_payment_issued');paymentissued()" onkeyup="javascript:dollorformate('#amount_insurance_payment_issued')" onchange="javascript:myischanged()"/></td>

                        <th colspan="1">Issued Date</th><td ><input type="text" name="date_insurance_payment_issued" id="date_insurance_payment_issued" onblur="javascript:dateupformat('#date_insurance_payment_issued')" onkeyup="javascript:date1902('#date_insurance_payment_issued')" onchange="javascript:myischanged()"/></td>
                        
                        <th align="left">Send To Patient?</th>
                        <td><input type="checkbox" name="is_the_issued_payment_sent_to_patient[]" id="is_the_issued_payment_sent_to_patient" onchange="javascript:sendtopatient();myischanged()" value="1" /></td>
                   
                    </tr>
                    <input type ="text" style="display:none" id="count2" name="count2"></input>
<!--                    <td colspan="8">
                        <div id="insurancePaymentDiv" style="display:none;overflow: scroll;overflow-x: hidden;height: 60px">
                            <table id="insurancePaymentTable">

                            </table>
                        </div>
                    </td>
-->
                    <tr>
                        <th colspan="8"  style="background:#eeeeee;text-align: center">Explanation of Benefits</th>
                    </tr>
                    <tr>

                        <th >Allowed Amount</th><td ><input type="text" name="EOB_allowed_amount" id="EOB_allowed_amount" onchange="javascript:amount(1);myischanged()" onblur ="javascript:dollorchange('#EOB_allowed_amount')"  onkeyup="javascript:dollorformate('#EOB_allowed_amount')"/></td>
                        <th >Not Allowed Amount</th><td ><input type="text" name="EOB_not_allowed_amount" id="EOB_not_allowed_amount" onchange="javascript:amount(2);myischanged()" onblur ="javascript:dollorchange('#EOB_not_allowed_amount')"  onkeyup="javascript:dollorformate('#EOB_not_allowed_amount')"/></td>
                        <th >Co-Insurance</th><td ><input type="text" name="EOB_co_insurance" id="EOB_co_insurance" onblur ="javascript:dollorchange('#EOB_co_insurance')" onkeyup="javascript:dollorformate('#EOB_co_insurance')" onchange="javascript:right_format('#EOB_co_insurance');myischanged()"/></td>
                        <th >Deductible</th><td ><input type="text" name="EOB_deductable" id="EOB_deductable"  onkeyup="javascript:dollorformate('#EOB_deductable')"  onblur ="javascript:dollorchange('#EOB_deductable')" onchange="javascript:right_format('#EOB_deductable');myischanged()"/></td>
                    </tr>
                    <tr>
                        <!------------------Add Reduction UI  By <Yu Lang>--------------------->
                        <th >Reduction</th><td ><input type="text" name="EOB_reduction" id="EOB_reduction"  onkeyup="javascript:dollorformate('#EOB_reduction')" onblur ="javascript:dollorchange('#EOB_reduction')" onchange="javascript:right_format('#EOB_reduction');myischanged()"/></td>
                        <th >Other Reduction</th><td ><input type="text" name="EOB_other_reduction" id="EOB_other_reduction"  onkeyup="javascript:dollorformate('#EOB_other_reduction')" onblur ="javascript:dollorchange('#EOB_other_reduction')" onchange="javascript:right_format('#EOB_other_reduction');myischanged()"/></td>
                        <!------------------Add Reduction UI  By <Yu Lang>--------------------->
                        <th >Adjustment Reason</th><td colspan="3" ><input type="text" name="EOB_adjustment_reason" id="EOB_adjustment_reason" style="width:98.8%"  onchange="javascript:myischanged()"/></td>
                    </tr>

                    <!--
                   <tr>
                       <th colspan="8" >&nbsp</th>
                   </tr>
                    -->
                    <tr>
                        <th colspan="8"  style="background:#eeeeee;text-align: center">Benefits</th>
                    </tr>
                    <tr>

                        <th >OOP</th><td ><input type="text" name="benefit_OOP" id="benefit_OOP" onblur="javascript:benefitdate('#benefit_OOP');dollorchange('#benefit_OOP')"  onkeyup="javascript:dollorformate('#benefit_OOP')" onchange="javascript:myischanged()"/></td>
                        <th >Remaining</th><td ><input type="text" name="benefit_OOP_remaining" id="benefit_OOP_remaining" onblur="javascript:benefitdate('#benefit_OOP_remaining');dollorchange('#benefit_OOP_remaining')" onkeyup="javascript:dollorformate('#benefit_OOP_remaining')" onchange="javascript:myischanged()"/></td>
                        <th >Deductible</th><td ><input type="text" name="benefit_deductible" id="benefit_deductible" onblur="javascript:benefitdate('#benefit_deductible');dollorchange('#benefit_deductible')" onkeyup="javascript:dollorformate('#benefit_deductible')" onchange="javascript:myischanged()"/></td>
                        <th >Co-Insurance</th><td ><input type="text" name="benefit_co_insurance" id="benefit_co_insurance" onblur="javascript:benefitdate('#benefit_co_insurance');dollorchange('#benefit_co_insurance')" onkeyup="javascript:dollorformate('#benefit_co_insurance')" onchange="javascript:myischanged()"/></td>
                    </tr>
                    <tr>
                        <th>Date</th><td><input type="text" name="benefit_date_taken" id="benefit_date_taken" onblur="javascript:dateupformat('#benefit_date_taken')"  onkeyup="javascript:date1902('#benefit_date_taken')" onchange="javascript:myischanged()"/></td>
                        <th align="left">In Network?</th>
                        <td><input type="checkbox" name="innetwork[]" id="innetwork" onchange="javascript:check_change('benefit_innetwork');myischanged()"/></td>
                        <td colspan ="4"></td>
                    </tr>
<!--                    <tr>
                        <th colspan="7"  style="background:#eeeeee;text-align: center">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Patient Payments</th>
                        <td style="text-align:right;background:#eeeeee;"><input type="button"  value="MORE" id="" onclick="javascript:addtable3()"/><input type="button"  value="LESS" id="" onclick="javascript:deletetable3()"/></td>
                    </tr>
                    <tr>
                        <th colspan="1">Received Amount</th><td ><input type="text" name="amount_patient_payment_received_1" id="amount_patient_payment_received_1" onblur="javascript:paymentreceived2(1)" /></td>
                        <th colspan="1">Received Date</th><td ><input type="text" name="date_patient_payment_received_1" id="date_patient_payment_received_1" onkeyup="javascript:date('#date_patient_payment_received_1')"/></td>
                        <th >Notes</th><td colspan="2"><input type="text" name="notes_patient_payment_1" id="notes_patient_payment_1" style="width:99%"/></td>
                        <td style="text-align:right;"><input type="button"  value="MORE" id="" onclick="javascript:addtable3()"/><input type="button"  value="LESS" id="" onclick="javascript:deletetable3()"/></td>
                    </tr>-->

<!--
                    <input type ="text" style="display:none" id="count3" name="count3"></input>
                    <td id="patientPaymentTd" colspan="8" style="display:none">
                        <div id="patientPaymentDiv" style="display:none;overflow: scroll;overflow-x: hidden;height: 60px">
                            <table id="patientPaymentTable">

                            </table>
                        </div>
                    </td> 
-->                    
<!--                    <tr>
                        <th colspan="7"  style="background:#eeeeee;text-align: center">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Biller Adjustments</th>
                        <td style="text-align:right;background:#eeeeee;"><input type="button"  value="MORE" id="" onclick="javascript:addtable4()"/><input type="button"  value="LESS" id="" onclick="javascript:deletetable4()"/></td>
                    </tr>
                    <input type ="text" style="display:none" id="count4" name="count4"></input>
                    <td id="billerAdjustmentTd" colspan="8" style="display:none">
                        <div id="billerAdjustmentDiv" style="display:none;overflow: scroll;overflow-x: hidden;height: 60px">
                            <table id="billerAdjustmentTable">

                            </table>
                        </div>
                    </td> 
-->
                    <!-- ***************Add four custom field BY Yu Lang ***************-->
                    <!--
                    <tr>
                        <th colspan="8" >&nbsp</th>
                    </tr>
                    -->                    
                    <!--
                    <tr>
                        <th colspan="8" id ="bottom_custom_data" style="display:none">&nbsp</th>
                    </tr>
                    <!--  ***************Add four custom field BY Yu Lang ***************-->
                    
<!-- add the assigned claims by Pan
-->
                    <tr>
                        <th colspan="8"  id ="th_title_custom_data" style="background:#eeeeee;text-align: center;display:none"><!--<span id="title_custom_data" style="display:none">-->Custom Data</th>
                    </tr>
                    <tr>  
                        <td style="display:none">
                            <input type="text" name="custom_1" id="custom_1"/>          
                            <input type="text" name="custom_2" id="custom_2"/> 
                            <input type="text" name="custom_3" id="custom_3"/> 
                            <input type="text" name="custom_4" id="custom_4"/>                             
                        </td>                            
                        <th align="left" id ="th_custom_label_1" style="display:none"><span id="custom_label_1" style ="float:right;">Custom_1</span></th>
                        <td><input type="text" name="custom_1_input" id="custom_1_input" style="display:none" onchange="javascript:set_custom_value_input('1');check_change('1');myischanged();"/>
                        <select class="select" name="custom_1_select" style="display:none;width:100%" id="custom_1_select" onchange="javascript:set_custom_value_select('1');check_change('1');myischanged();">
                                <option value="">Select</option>
                        </select>
                        </td>
                        <th align="left" id ="th_custom_label_2" style="display:none"><span id="custom_label_2" style ="float:right;">Custom_2</span></th>
                        <td><input type="text" name="custom_2_input" id="custom_2_input" style="display:none" onchange="javascript:set_custom_value_input('2');check_change('2');myischanged();"/>
                        <select class="select" name="custom_2_select" style="display:none;width:100%" id="custom_2_select" onchange="javascript:set_custom_value_select('2');check_change('2');myischanged();">
                                <option value="">Select</option>
                        </select>
                        </td>
                        <th align="left" id ="th_custom_label_3" style="display:none"><span id="custom_label_3" style ="float:right;">Custom_3</span></th>
                        <td><input type="text" name="custom_3_input" id="custom_3_input" style="display:none" onchange="javascript:set_custom_value_input('3');check_change('3');myischanged();"/>
                        <select class="select" name="custom_3_select" style="display:none;width:100%" id="custom_3_select" onchange="javascript:set_custom_value_select('3');check_change('3');myischanged();">
                                <option value="">Select</option>
                        </select>
                        </td>
                        <th align="left" id ="th_custom_label_4" style="display:none"><span id="custom_label_4" style ="float:right;">Custom_4</span></th>
                        <td><input type="text" name="custom_4_input" id="custom_4_input" style="display:none" onchange="javascript:set_custom_value_input('4');check_change('4');myischanged();"/>
                        <select class="select" name="custom_4_select" style="display:none;width:100%" id="custom_4_select" onchange="javascript:set_custom_value_select('4');check_change('4');myischanged();">
                                <option value="">Select</option>
                        </select>
                        </td>

                    </tr>
                    <!--Area for payment-->
                    <tr>
                        <th colspan="7"  id ="th_title_payment" style="background:#eeeeee;text-align: center;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Payment</th>
                        <td style="text-align:right;background:#eeeeee;"><input type="button"  value="ADD" id="add_payment" onclick="javascript:addtable7('total','new')"/><!--<input type="button"  value="LESS" id="" onclick="javascript:deletetable7()"/>--></td>
                    </tr>
                    <input type ="text" style="display:none" id="count_payment" name="count_payment"></input>
                    <td id="paymentTd" colspan="8" style="display:none">
                        <div id="paymentDiv" style="display:none;overflow: scroll;overflow-x: hidden;height: 60px">
                            <table id="paymentTable">
                            </table>
                        </div>
                    </td>
                    <tr>
                        <th colspan="7"  id ="th_title_payment" style="background:#eeeeee;text-align: center;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Guarantor</th>
                    </tr>
                    <tr>
                        <td id="guarantorTd" colspan="8">
                        <div id="guarantorDiv" style="overflow: auto;">
                            <table id="gurantorTable">
                                <tr>
                                    <th style="width:15%" colspan="1">Guarantor</th>
                                    <td colspan="1">
                                        <select id="guarantor" name="guarantor" onchange="javascript:change_guarantor();javascript:myischanged()">
                                            <option value="no">No separate guarantor</option>
                                            <option value="new">New guarantor</option>
                                            <?php
                                                foreach($this->guarantor_list as $guarantor){
                                                    echo "<option value='".$guarantor["g_id"]."'>".$guarantor["last_name"].", ".$guarantor["first_name"]."</option>";
                                                }
                                            ?>
                                        </select>
                                    </td>
                                </tr>
                                <tr id="g_tr_1" style="display: none">
                                    <th style="width:15%">
                                        Last Name
                                    </th>
                                    <td style="width:10%">
                                        <input name="g_last_name" id="g_last_name" type="text" onchange="javascript:myischanged()"/>
                                    </td>
                                    <th  style="width:15%">
                                        First Name
                                    </th>
                                    <td style="width:10%">
                                        <input name="g_first_name" id="g_first_name" type="text" onchange="javascript:myischanged()"/>
                                    </td>
                                    <th  style="width:15%">
                                        Date of Birth
                                    </th>
                                    <td style="width:10%">
                                        <input name="g_dob" id="g_dob" type="text" onkeyup="javascript:dateofDOB('#g_dob')" onchange="javascript:myischanged()"/>
                                    </td>
                                    <th  style="width:15%">
                                        Sex
                                    </th>
                                    <td style="width:10%">
                                        <select name="g_sex" id="g_sex" style="width:100%" onchange="javascript:myischanged()">
                                            <option value="" selected="selected">Select</option>
                                            <option value="m">Male</option>
                                            <option value="f">Female</option>
                                        </select>
                                    </td>
                                </tr>
                                <tr id="g_tr_2" style="display: none">
                                    <th>
                                        Street Address
                                    </th>
                                    <td>
                                        <input name="g_street_address" id="g_street_address" type="text" onchange="javascript:myischanged()"/>
                                    </td>
                                    <th>
                                        Zip code
                                    </th>
                                    <td>
                                        <input name="g_zip" id="g_zip" type="text" onkeyup="javascript:zipcode('#g_zip')" onblur="javascript:zipupformat('#g_zip');javascript:zip2citystate()" onchange="javascript:myischanged()"/>
                                    </td>
                                    <th>
                                        City
                                    </th>
                                    <td>
                                        <input name="g_city" id="g_city" type="text" onchange="javascript:myischanged()"/>
                                    </td>
                                    <th>
                                        State
                                    </th>
                                    <td>
                                        <input name="g_state" id="g_state" type="text" onchange="javascript:myischanged()"/>
                                    </td>
                                </tr>
                                <tr id="g_tr_3" style="display: none">
                                    <th>
                                        Phone Number
                                    </th>
                                    <td>
                                        <input name="g_phone_number" id="g_phone_number" type="text" onkeyup="javascript:phone('#g_phone_number')" onchange="javascript:myischanged()"/>
                                    </td>
                                    <th>
                                        Second Phone Number
                                    </th>
                                    <td>
                                        <input name="g_second_phone_number" id="g_second_phone_number" type="text" onkeyup="javascript:phone('#g_second_phone_number')" onchange="javascript:myischanged()"/>
                                    </td>
                                    <th>
                                        SSN
                                    </th>
                                    <td>
                                        <input name="g_ssn" id="g_ssn" type="text" onkeyup="javascript:ssn('#g_ssn')" onchange="javascript:myischanged()"/>
                                    </td>
                                    <th>
                                        Relationship To Patient
                                    </th>
                                    <td>
                                        <select name="g_relationship_to_patient" id="g_relationship_to_patient" type="text" onchange="javascript:myischanged()">
                                            <option value="" selected="selected">Select</option>
                                            <option value="patient">Patient</option>
                                            <option value="guardian">Guardian</option>
                                            <option value="spouse">Spouse</option>
                                            <option value="other">Other</option>
                                        </select>
                                    </td>
                                </tr>
                            </table>
                        </div>
                    </td>
                    </tr>
                     <tr>
                        <th colspan="7"  style="background:#eeeeee;text-align: center">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Interaction</th>
                         <td style="text-align:right;background:#eeeeee;"><input type="button"  value="ADD" id="add_log" onclick="javascript:addtable5()"/><!--<input type="button"  value="LESS" id=""   onclick="javascript:myischanged();deletetable5()"/>--></td>
                    </tr>


                    <input type ="text" style="display:none" id="count5" name="count5"></input>
                    <td id="interactionlogTd" colspan="8" style="display:none">
                        <div id="interactionlogDiv" style="display:none;overflow: scroll;overflow-x: hidden;height: 60px">
                            <table id="interactionlogTable">
                            </table>
                        </div>
                    </td> 
                    <tr>
                        <th colspan="8" >&nbsp</th>
                    </tr>


                    <tr>
                        <th>Notes</th><td colspan="7"><textarea rows="4" name="notes" id="notes" style= "width:100%" onchange="javascript:myischanged()"></textarea></td>
                    </tr>
                    <tr>
                        <td><input type="text" name="id"  id="id" style="display:none"/></td>
                        <td colspan="7"><input type="text" name="followup_id"  id="followup_id" style="display:none"/></td>
                    </tr>
<!--                        <td></td>

    <td ><input type="submit" name="submit" value="Back To Services" /></td>
    <td ><input type="submit" name="submit" value="Finish Claim" /></td>-->



<!--                    <table>-->
                    <!--
                    <tr id="document_access">
                        <td  align="center"><input type="button"  name="upload" id="upload" value="Document Input" onclick= "javascript:window.open( '<?php echo $this->baseUrl ?>/biller/claims/upload/pageno/4 ','upload',
                            'height=220,width=500,status=no,toolbar=no,menubar=no,location=no,scrollbars=no') "/></td>


                    </tr>
                    -->
                </table>
                <table>
                    <th></th><td style="display:none"><input type="text" name="insurance_name" id="insurance_name" /></td>
                    <th></th><td style="display:none"><input type="text" name="payer_type" id="payer_type" /></td>
                    <th></th><td style="display:none"><input type="text" name="last_status" id="last_status" /></td>
                    <th></th><td style="display:none"><input type="text" name="last_statement_status" id="last_statement_status" /></td>
                    <th></th><td style="display:none"><input type="text" name="last_bill_status" id="last_bill_status" /></td>
                    <th></th><td style="display:none"><input type="text" name="billername" id="billername" value="<?php echo $this->user_name; ?>" /></td>
                    <th></th><td style="display:none"><input type="text" name="new_claim_flag" id="new_claim_flag" value="<?php echo $this->new_claim_flag; ?>" /></td>
                    <th></th><td style="display:none"><input type="text" name="eobfileexist" id="eobfileexist" /></td>
                    <th></th><td style="display:none"><input type="text" name="last_other_insurance" id="last_other_insurance" /></td>  
                    <th></th><td style="display:none"><input type="text" name="last_total_charge" id="last_total_charge" /></td>
                    <th></th><td style="display:none"><input type="text" name="last_amount_paid" id="last_amount_paid" /></td>  
                    <th></th><td style="display:none"><input type="text" name="last_balance_due" id="last_balance_due" /></td>  
                    <th></th><td style="display:none"><input type="text" name="last_expected_payment" id="last_expected_payment" /></td>  
                    <th></th><td style="display:none"><input type="text" name="last_date_of_next_followup" id="last_date_of_next_followup" /></td>  
                    <th></th><td style="display:none"><input type="text" name="last_date_secondary_insurance_billed" id="last_date_secondary_insurance_billed" /></td>  
                    <th></th><td style="display:none"><input type="text" name="last_date_creation" id="last_date_creation" /></td>  
                    <th></th><td style="display:none"><input type="text" name="last_date_billed" id="last_date_billed" /></td>  
                    <th></th><td style="display:none"><input type="text" name="last_date_last_billed" id="last_date_last_billed" /></td>  
                    <th></th><td style="display:none"><input type="text" name="last_date_closed" id="last_date_closed" /></td>  
                    <th></th><td style="display:none"><input type="text" name="last_assigned_user_id" id="last_assigned_user_id" /></td>  
                    <th></th><td style="display:none"><input type="text" name="last_amount_initial_offer" id="last_amount_initial_offer" /></td>  
                    <th></th><td style="display:none"><input type="text" name="last_date_initial_offer" id="last_date_initial_offer" /></td>  
                    <th></th><td style="display:none"><input type="text" name="last_negotiated_payment_amount" id="last_negotiated_payment_amount" /></td>  
                    <th></th><td style="display:none"><input type="text" name="last_date_negotiated_amount_reached" id="last_date_negotiated_amount_reached" /></td>  
                    <th></th><td style="display:none"><input type="text" name="last_amount_insurance_payment_issued" id="last_amount_insurance_payment_issued" /></td>  
                    <th></th><td style="display:none"><input type="text" name="last_date_insurance_payment_issued" id="last_date_insurance_payment_issued" /></td>  
                    
                    <!--last for EOB-->
                    <th></th><td style="display:none"><input type="text" name="last_EOB_allowed_amount" id="last_EOB_allowed_amount" /></td>  
                    <th></th><td style="display:none"><input type="text" name="last_EOB_not_allowed_amount" id="last_EOB_not_allowed_amount" /></td>  
                    <th></th><td style="display:none"><input type="text" name="last_EOB_co_insurance" id="last_EOB_co_insurance" /></td>
                    <th></th><td style="display:none"><input type="text" name="last_EOB_deductable" id="last_EOB_deductable" /></td>
                    <th></th><td style="display:none"><input type="text" name="last_EOB_reduction" id="last_EOB_reduction" /></td>
                    <th></th><td style="display:none"><input type="text" name="last_EOB_other_reduction" id="last_EOB_other_reduction" /></td>
                    <th></th><td style="display:none"><input type="text" name="last_EOB_adjustment_reason" id="last_EOB_adjustment_reason" /></td>
                    
                    <!--last for benefits-->
                    <th></th><td style="display:none"><input type="text" name="last_benefit_OOP" id="last_benefit_OOP" /></td>
                    <th></th><td style="display:none"><input type="text" name="last_benefit_OOP_remaining" id="last_benefit_OOP_remaining" /></td>
                    <th></th><td style="display:none"><input type="text" name="last_benefit_deductible" id="last_benefit_deductible" /></td>
                    <th></th><td style="display:none"><input type="text" name="last_benefit_co_insurance" id="last_benefit_co_insurance" /></td>
                    <th></th><td style="display:none"><input type="text" name="last_benefit_date_taken" id="last_benefit_date_taken" /></td>
                    
                    <!-- for custom-->
                    <th></th><td style="display:none"><input type="text" name="last_custom_1" id="last_custom_1" /></td>
                    <th></th><td style="display:none"><input type="text" name="last_custom_label_1" id="last_custom_label_1" /></td>
                    <th></th><td style="display:none"><input type="text" name="last_custom_2" id="last_custom_2" /></td>
                    <th></th><td style="display:none"><input type="text" name="last_custom_label_2" id="last_custom_label_2" /></td>
                    <th></th><td style="display:none"><input type="text" name="last_custom_3" id="last_custom_3" /></td>
                    <th></th><td style="display:none"><input type="text" name="last_custom_label_3" id="last_custom_label_3" /></td>
                    <th></th><td style="display:none"><input type="text" name="last_custom_4" id="last_custom_4" /></td>
                    <th></th><td style="display:none"><input type="text" name="last_custom_label_4" id="last_custom_label_4" /></td>
                    <th></th><td style="display:none"><input type="text" name="paymentFrom" id="paymentFrom" value="<?php echo $this->paymentFrom; ?>"/></td>
                    <th></th><td style="display:none"><input type="text" name="insuranceFrom" id="insuranceFrom" value="<?php echo $this->insurance_list_save; ?>"/></td>
                    <th></th><td style="display:none"><input type="text" name="" id="" /></td>
                    <th></th><td style="display:none"><input type="text" name="" id="" /></td>
                    <!-- for payments-->
                    <th></th><td style="display:none"><input type="text" name="payment_option" id="payment_option" /></td>
                    <th></th><td style="display:none"><input type="text" name="last_amount" id="last_amount" /></td>
                    <th></th><td style="display:none"><input type="text" name="last_date_and_time" id="last_date_and_time" /></td>
                    <th></th><td style="display:none"><input type="text" name="last_from" id="last_from" /></td>
                    <th></th><td style="display:none"><input type="text" name="last_notes" id="last_notes" /></td>
                    <th></th><td style="display:none"><input type="text" name="last_internal_notes" id="last_internal_notes" /></td>
                    <th></th><td style="display:none"><input type="text" name="exclude_deductible" id="exclude_deductible" /></td>
                    <th></th><td style="display:none"><input type="text" name="exclude_coinsurance" id="exclude_coinsurance" /></td>
                    <th></th><td style="display:none"><input type="text" name="exclude_reduction" id="exclude_reduction" /></td>
                    <th></th><td style="display:none"><input type="text" name="exclude_otherreduction" id="exclude_otherreduction" /></td>
                    <!-- delete time-->
                    <th></th><td style="display:none"><input type="text" name="delete_time" id="delete_time" /></td>
                    <?php
                        echo '<th></th><td style="display:none"><input type="text" name="autoBiller" id="autoBiller" value="'.$this->autobiller.'"/></td>';
                    ?>
                    <!-- for bill_status change test-->
                    <th></th><td style="display:none"><input type="text" name="check_self" id="check_self" value="<?php echo $this->primary_check?>"/></td>
                    <th></th><td style="display:none"><input type="text" name="check_secondary" id="check_secondary" value="<?php echo $this->secondary_check?>"/></td>
                    <th></th><td style="display:none"><input type="text" name="check_other" id="check_other" value="<?php echo $this->other_check?>" /></td>
                    <th></th><td style="display:none"><input type="text" name="bill_status_bk" id="bill_status_bk" value="" /></td>
                    <!--service lins data-->
                    <th></th><td style="display:none"><input type="text" name="service_count" id="service_count" value="<?php $service_data = $this->service_data; echo count($service_data)?>"/></td>
                    <th></th><td style="display:none"><input type="text" name="services_1" id="service_1" value="<?php echo $service_data[0]?>"/></td>
                    <th></th><td style="display:none"><input type="text" name="services_2" id="service_2" value="<?php echo $service_data[1]?>"/></td>
                    <th></th><td style="display:none"><input type="text" name="services_3" id="service_3" value="<?php echo $service_data[2]?>"/></td>
                    <th></th><td style="display:none"><input type="text" name="services_4" id="service_4" value="<?php echo $service_data[3]?>"/></td>
                    <th></th><td style="display:none"><input type="text" name="services_5" id="service_5" value="<?php echo $service_data[4]?>"/></td>
                    <th></th><td style="display:none"><input type="text" name="services_6" id="service_6" value="<?php echo $service_data[5]?>"/></td>
                    
                    <th></th><td style="display:none"><input type="text" name="last_colorselector_1" id="last_colorselector_1" /></td>
                    <!--guarantor data-->
                    <th></th><td style="display:none"><input type="text" name="last_guarantor" id="last_guarantor" value="<?php echo $service_data[5]?>"/></td>
                </table>    
            </form>
        </div>

 <script type="text/javascript">
      jQuery(function(){       
            jQuery(".megamenu").megamenu();
      });
 </script>
    </body>
</html>
